<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">

<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1"/>
  <meta name="generator" content="distill" />

  <style type="text/css">
  /* Hide doc at startup (prevent jankiness while JS renders/transforms) */
  body {
    visibility: hidden;
  }
  </style>

 <!--radix_placeholder_import_source-->
 <!--/radix_placeholder_import_source-->

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ad0000; } /* Alert */
code span.an { color: #5e5e5e; } /* Annotation */
code span.at { color: #20794d; } /* Attribute */
code span.bn { color: #ad0000; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007ba5; } /* ControlFlow */
code span.ch { color: #20794d; } /* Char */
code span.cn { color: #8f5902; } /* Constant */
code span.co { color: #5e5e5e; } /* Comment */
code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
code span.dt { color: #ad0000; } /* DataType */
code span.dv { color: #ad0000; } /* DecVal */
code span.er { color: #ad0000; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #ad0000; } /* Float */
code span.fu { color: #4758ab; } /* Function */
code span.im { } /* Import */
code span.in { color: #5e5e5e; } /* Information */
code span.kw { color: #007ba5; } /* Keyword */
code span.op { color: #5e5e5e; } /* Operator */
code span.ot { color: #007ba5; } /* Other */
code span.pp { color: #ad0000; } /* Preprocessor */
code span.sc { color: #20794d; } /* SpecialChar */
code span.ss { color: #20794d; } /* SpecialString */
code span.st { color: #20794d; } /* String */
code span.va { color: #111111; } /* Variable */
code span.vs { color: #20794d; } /* VerbatimString */
code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
</style>

  <!--radix_placeholder_meta_tags-->
  <title>Home: Part 4: Tidymodels Workflowsets</title>

  <meta property="description" itemprop="description" content="On this Part 4 page we will analyse the same agroforestry data from ERA, as in Part 3, but we are going to make use of the relatively new tidymodels package called &quot;Workflowsets&quot;. We are going to skip the preliminary explorertive data analysis (EDA) and jump straight to the modelling setup.  &quot;Show code&quot; to view the R codes used to perform a given analysis or visualise a analysis output. As you have seen in Part 3, tidymodels builds on the integration of model specifications from the parsnip package and data pre-processing steps using the recipe package. These are integrated into a workflow using the workflows package, and finally tuned using the tune package. What is revolutionary about the latest member in the tidymodels family is the workflowsets package that can create a workflow set that holds multiple workflow objects (integrated model specifications and pre-processing steps). This object, or set, can then easily be tuned or fitted based on resamples by using a set of simple commands. Workflowsets is a powerful concept for modelling as researchers often are interested in test and compare the performance of multiple models specified under different pre-processing settings."/>

  <link rel="icon" type="image/png" href="./IMAGES/ERA_logo_circle.png"/>


  <!--  https://developers.facebook.com/docs/sharing/webmasters#markup -->
  <meta property="og:title" content="Home: Part 4: Tidymodels Workflowsets"/>
  <meta property="og:type" content="article"/>
  <meta property="og:description" content="On this Part 4 page we will analyse the same agroforestry data from ERA, as in Part 3, but we are going to make use of the relatively new tidymodels package called &quot;Workflowsets&quot;. We are going to skip the preliminary explorertive data analysis (EDA) and jump straight to the modelling setup.  &quot;Show code&quot; to view the R codes used to perform a given analysis or visualise a analysis output. As you have seen in Part 3, tidymodels builds on the integration of model specifications from the parsnip package and data pre-processing steps using the recipe package. These are integrated into a workflow using the workflows package, and finally tuned using the tune package. What is revolutionary about the latest member in the tidymodels family is the workflowsets package that can create a workflow set that holds multiple workflow objects (integrated model specifications and pre-processing steps). This object, or set, can then easily be tuned or fitted based on resamples by using a set of simple commands. Workflowsets is a powerful concept for modelling as researchers often are interested in test and compare the performance of multiple models specified under different pre-processing settings."/>
  <meta property="og:locale" content="en_US"/>
  <meta property="og:site_name" content="Home"/>

  <!--  https://dev.twitter.com/cards/types/summary -->
  <meta property="twitter:card" content="summary"/>
  <meta property="twitter:title" content="Home: Part 4: Tidymodels Workflowsets"/>
  <meta property="twitter:description" content="On this Part 4 page we will analyse the same agroforestry data from ERA, as in Part 3, but we are going to make use of the relatively new tidymodels package called &quot;Workflowsets&quot;. We are going to skip the preliminary explorertive data analysis (EDA) and jump straight to the modelling setup.  &quot;Show code&quot; to view the R codes used to perform a given analysis or visualise a analysis output. As you have seen in Part 3, tidymodels builds on the integration of model specifications from the parsnip package and data pre-processing steps using the recipe package. These are integrated into a workflow using the workflows package, and finally tuned using the tune package. What is revolutionary about the latest member in the tidymodels family is the workflowsets package that can create a workflow set that holds multiple workflow objects (integrated model specifications and pre-processing steps). This object, or set, can then easily be tuned or fitted based on resamples by using a set of simple commands. Workflowsets is a powerful concept for modelling as researchers often are interested in test and compare the performance of multiple models specified under different pre-processing settings."/>

  <!--/radix_placeholder_meta_tags-->
  
  <!--radix_placeholder_rmarkdown_metadata-->

  <script type="text/json" id="radix-rmarkdown-metadata">
  {"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["title","favicon","description","bibliography","csl","output"]}},"value":[{"type":"character","attributes":{},"value":["Part 4: Tidymodels Workflowsets"]},{"type":"character","attributes":{},"value":["./IMAGES/ERA_logo_circle.png"]},{"type":"character","attributes":{},"value":["On this Part 4 page we will analyse the same agroforestry data from ERA, as in Part 3, but we are going to make use of the relatively new tidymodels package called \"Workflowsets\". We are going to skip the preliminary explorertive data analysis (EDA) and jump straight to the modelling setup.  \"Show code\" to view the R codes used to perform a given analysis or visualise a analysis output. As you have seen in Part 3, tidymodels builds on the integration of model specifications from the parsnip package and data pre-processing steps using the recipe package. These are integrated into a workflow using the workflows package, and finally tuned using the tune package. What is revolutionary about the latest member in the tidymodels family is the workflowsets package that can create a workflow set that holds multiple workflow objects (integrated model specifications and pre-processing steps). This object, or set, can then easily be tuned or fitted based on resamples by using a set of simple commands. Workflowsets is a powerful concept for modelling as researchers often are interested in test and compare the performance of multiple models specified under different pre-processing settings. \n"]},{"type":"character","attributes":{},"value":["Mylibrary.bib"]},{"type":"character","attributes":{},"value":["frontiers-in-ecology-and-the-environment.csl"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["distill::distill_article"]}},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["toc","toc_float","toc_depth","number_sections","code_folding"]}},"value":[{"type":"logical","attributes":{},"value":[true]},{"type":"logical","attributes":{},"value":[true]},{"type":"integer","attributes":{},"value":[3]},{"type":"logical","attributes":{},"value":[true]},{"type":"logical","attributes":{},"value":[true]}]}]}]}
  </script>
  <!--/radix_placeholder_rmarkdown_metadata-->
  <!--radix_placeholder_navigation_in_header-->
  <meta name="distill:offset" content=""/>

  <script type="application/javascript">

    window.headroom_prevent_pin = false;

    window.document.addEventListener("DOMContentLoaded", function (event) {

      // initialize headroom for banner
      var header = $('header').get(0);
      var headerHeight = header.offsetHeight;
      var headroom = new Headroom(header, {
        tolerance: 5,
        onPin : function() {
          if (window.headroom_prevent_pin) {
            window.headroom_prevent_pin = false;
            headroom.unpin();
          }
        }
      });
      headroom.init();
      if(window.location.hash)
        headroom.unpin();
      $(header).addClass('headroom--transition');

      // offset scroll location for banner on hash change
      // (see: https://github.com/WickyNilliams/headroom.js/issues/38)
      window.addEventListener("hashchange", function(event) {
        window.scrollTo(0, window.pageYOffset - (headerHeight + 25));
      });

      // responsive menu
      $('.distill-site-header').each(function(i, val) {
        var topnav = $(this);
        var toggle = topnav.find('.nav-toggle');
        toggle.on('click', function() {
          topnav.toggleClass('responsive');
        });
      });

      // nav dropdowns
      $('.nav-dropbtn').click(function(e) {
        $(this).next('.nav-dropdown-content').toggleClass('nav-dropdown-active');
        $(this).parent().siblings('.nav-dropdown')
           .children('.nav-dropdown-content').removeClass('nav-dropdown-active');
      });
      $("body").click(function(e){
        $('.nav-dropdown-content').removeClass('nav-dropdown-active');
      });
      $(".nav-dropdown").click(function(e){
        e.stopPropagation();
      });
    });
  </script>

  <style type="text/css">

  /* Theme (user-documented overrideables for nav appearance) */

  .distill-site-nav {
    color: rgba(255, 255, 255, 0.8);
    background-color: #0F2E3D;
    font-size: 15px;
    font-weight: 300;
  }

  .distill-site-nav a {
    color: inherit;
    text-decoration: none;
  }

  .distill-site-nav a:hover {
    color: white;
  }

  @media print {
    .distill-site-nav {
      display: none;
    }
  }

  .distill-site-header {

  }

  .distill-site-footer {

  }


  /* Site Header */

  .distill-site-header {
    width: 100%;
    box-sizing: border-box;
    z-index: 3;
  }

  .distill-site-header .nav-left {
    display: inline-block;
    margin-left: 8px;
  }

  @media screen and (max-width: 768px) {
    .distill-site-header .nav-left {
      margin-left: 0;
    }
  }


  .distill-site-header .nav-right {
    float: right;
    margin-right: 8px;
  }

  .distill-site-header a,
  .distill-site-header .title {
    display: inline-block;
    text-align: center;
    padding: 14px 10px 14px 10px;
  }

  .distill-site-header .title {
    font-size: 18px;
    min-width: 150px;
  }

  .distill-site-header .logo {
    padding: 0;
  }

  .distill-site-header .logo img {
    display: none;
    max-height: 20px;
    width: auto;
    margin-bottom: -4px;
  }

  .distill-site-header .nav-image img {
    max-height: 18px;
    width: auto;
    display: inline-block;
    margin-bottom: -3px;
  }



  @media screen and (min-width: 1000px) {
    .distill-site-header .logo img {
      display: inline-block;
    }
    .distill-site-header .nav-left {
      margin-left: 20px;
    }
    .distill-site-header .nav-right {
      margin-right: 20px;
    }
    .distill-site-header .title {
      padding-left: 12px;
    }
  }


  .distill-site-header .nav-toggle {
    display: none;
  }

  .nav-dropdown {
    display: inline-block;
    position: relative;
  }

  .nav-dropdown .nav-dropbtn {
    border: none;
    outline: none;
    color: rgba(255, 255, 255, 0.8);
    padding: 16px 10px;
    background-color: transparent;
    font-family: inherit;
    font-size: inherit;
    font-weight: inherit;
    margin: 0;
    margin-top: 1px;
    z-index: 2;
  }

  .nav-dropdown-content {
    display: none;
    position: absolute;
    background-color: white;
    min-width: 200px;
    border: 1px solid rgba(0,0,0,0.15);
    border-radius: 4px;
    box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.1);
    z-index: 1;
    margin-top: 2px;
    white-space: nowrap;
    padding-top: 4px;
    padding-bottom: 4px;
  }

  .nav-dropdown-content hr {
    margin-top: 4px;
    margin-bottom: 4px;
    border: none;
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
  }

  .nav-dropdown-active {
    display: block;
  }

  .nav-dropdown-content a, .nav-dropdown-content .nav-dropdown-header {
    color: black;
    padding: 6px 24px;
    text-decoration: none;
    display: block;
    text-align: left;
  }

  .nav-dropdown-content .nav-dropdown-header {
    display: block;
    padding: 5px 24px;
    padding-bottom: 0;
    text-transform: uppercase;
    font-size: 14px;
    color: #999999;
    white-space: nowrap;
  }

  .nav-dropdown:hover .nav-dropbtn {
    color: white;
  }

  .nav-dropdown-content a:hover {
    background-color: #ddd;
    color: black;
  }

  .nav-right .nav-dropdown-content {
    margin-left: -45%;
    right: 0;
  }

  @media screen and (max-width: 768px) {
    .distill-site-header a, .distill-site-header .nav-dropdown  {display: none;}
    .distill-site-header a.nav-toggle {
      float: right;
      display: block;
    }
    .distill-site-header .title {
      margin-left: 0;
    }
    .distill-site-header .nav-right {
      margin-right: 0;
    }
    .distill-site-header {
      overflow: hidden;
    }
    .nav-right .nav-dropdown-content {
      margin-left: 0;
    }
  }


  @media screen and (max-width: 768px) {
    .distill-site-header.responsive {position: relative; min-height: 500px; }
    .distill-site-header.responsive a.nav-toggle {
      position: absolute;
      right: 0;
      top: 0;
    }
    .distill-site-header.responsive a,
    .distill-site-header.responsive .nav-dropdown {
      display: block;
      text-align: left;
    }
    .distill-site-header.responsive .nav-left,
    .distill-site-header.responsive .nav-right {
      width: 100%;
    }
    .distill-site-header.responsive .nav-dropdown {float: none;}
    .distill-site-header.responsive .nav-dropdown-content {position: relative;}
    .distill-site-header.responsive .nav-dropdown .nav-dropbtn {
      display: block;
      width: 100%;
      text-align: left;
    }
  }

  /* Site Footer */

  .distill-site-footer {
    width: 100%;
    overflow: hidden;
    box-sizing: border-box;
    z-index: 3;
    margin-top: 30px;
    padding-top: 30px;
    padding-bottom: 30px;
    text-align: center;
  }

  /* Headroom */

  d-title {
    padding-top: 6rem;
  }

  @media print {
    d-title {
      padding-top: 4rem;
    }
  }

  .headroom {
    z-index: 1000;
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
  }

  .headroom--transition {
    transition: all .4s ease-in-out;
  }

  .headroom--unpinned {
    top: -100px;
  }

  .headroom--pinned {
    top: 0;
  }

  /* adjust viewport for navbar height */
  /* helps vertically center bootstrap (non-distill) content */
  .min-vh-100 {
    min-height: calc(100vh - 100px) !important;
  }

  </style>

  <script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
  <link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet"/>
  <link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet"/>
  <script src="site_libs/headroom-0.9.4/headroom.min.js"></script>
  <script src="site_libs/autocomplete-0.37.1/autocomplete.min.js"></script>
  <script src="site_libs/fuse-6.4.1/fuse.min.js"></script>

  <script type="application/javascript">

  function getMeta(metaName) {
    var metas = document.getElementsByTagName('meta');
    for (let i = 0; i < metas.length; i++) {
      if (metas[i].getAttribute('name') === metaName) {
        return metas[i].getAttribute('content');
      }
    }
    return '';
  }

  function offsetURL(url) {
    var offset = getMeta('distill:offset');
    return offset ? offset + '/' + url : url;
  }

  function createFuseIndex() {

    // create fuse index
    var options = {
      keys: [
        { name: 'title', weight: 20 },
        { name: 'categories', weight: 15 },
        { name: 'description', weight: 10 },
        { name: 'contents', weight: 5 },
      ],
      ignoreLocation: true,
      threshold: 0
    };
    var fuse = new window.Fuse([], options);

    // fetch the main search.json
    return fetch(offsetURL('search.json'))
      .then(function(response) {
        if (response.status == 200) {
          return response.json().then(function(json) {
            // index main articles
            json.articles.forEach(function(article) {
              fuse.add(article);
            });
            // download collections and index their articles
            return Promise.all(json.collections.map(function(collection) {
              return fetch(offsetURL(collection)).then(function(response) {
                if (response.status === 200) {
                  return response.json().then(function(articles) {
                    articles.forEach(function(article) {
                      fuse.add(article);
                    });
                  })
                } else {
                  return Promise.reject(
                    new Error('Unexpected status from search index request: ' +
                              response.status)
                  );
                }
              });
            })).then(function() {
              return fuse;
            });
          });

        } else {
          return Promise.reject(
            new Error('Unexpected status from search index request: ' +
                        response.status)
          );
        }
      });
  }

  window.document.addEventListener("DOMContentLoaded", function (event) {

    // get search element (bail if we don't have one)
    var searchEl = window.document.getElementById('distill-search');
    if (!searchEl)
      return;

    createFuseIndex()
      .then(function(fuse) {

        // make search box visible
        searchEl.classList.remove('hidden');

        // initialize autocomplete
        var options = {
          autoselect: true,
          hint: false,
          minLength: 2,
        };
        window.autocomplete(searchEl, options, [{
          source: function(query, callback) {
            const searchOptions = {
              isCaseSensitive: false,
              shouldSort: true,
              minMatchCharLength: 2,
              limit: 10,
            };
            var results = fuse.search(query, searchOptions);
            callback(results
              .map(function(result) { return result.item; })
            );
          },
          templates: {
            suggestion: function(suggestion) {
              var img = suggestion.preview && Object.keys(suggestion.preview).length > 0
                ? `<img src="${offsetURL(suggestion.preview)}"</img>`
                : '';
              var html = `
                <div class="search-item">
                  <h3>${suggestion.title}</h3>
                  <div class="search-item-description">
                    ${suggestion.description || ''}
                  </div>
                  <div class="search-item-preview">
                    ${img}
                  </div>
                </div>
              `;
              return html;
            }
          }
        }]).on('autocomplete:selected', function(event, suggestion) {
          window.location.href = offsetURL(suggestion.path);
        });
        // remove inline display style on autocompleter (we want to
        // manage responsive display via css)
        $('.algolia-autocomplete').css("display", "");
      })
      .catch(function(error) {
        console.log(error);
      });

  });

  </script>

  <style type="text/css">

  .nav-search {
    font-size: x-small;
  }

  /* Algolioa Autocomplete */

  .algolia-autocomplete {
    display: inline-block;
    margin-left: 10px;
    vertical-align: sub;
    background-color: white;
    color: black;
    padding: 6px;
    padding-top: 8px;
    padding-bottom: 0;
    border-radius: 6px;
    border: 1px #0F2E3D solid;
    width: 180px;
  }


  @media screen and (max-width: 768px) {
    .distill-site-nav .algolia-autocomplete {
      display: none;
      visibility: hidden;
    }
    .distill-site-nav.responsive .algolia-autocomplete {
      display: inline-block;
      visibility: visible;
    }
    .distill-site-nav.responsive .algolia-autocomplete .aa-dropdown-menu {
      margin-left: 0;
      width: 400px;
      max-height: 400px;
    }
  }

  .algolia-autocomplete .aa-input, .algolia-autocomplete .aa-hint {
    width: 90%;
    outline: none;
    border: none;
  }

  .algolia-autocomplete .aa-hint {
    color: #999;
  }
  .algolia-autocomplete .aa-dropdown-menu {
    width: 550px;
    max-height: 70vh;
    overflow-x: visible;
    overflow-y: scroll;
    padding: 5px;
    margin-top: 3px;
    margin-left: -150px;
    background-color: #fff;
    border-radius: 5px;
    border: 1px solid #999;
    border-top: none;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion {
    cursor: pointer;
    padding: 5px 4px;
    border-bottom: 1px solid #eee;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion:last-of-type {
    border-bottom: none;
    margin-bottom: 2px;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item {
    overflow: hidden;
    font-size: 0.8em;
    line-height: 1.4em;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item h3 {
    font-size: 1rem;
    margin-block-start: 0;
    margin-block-end: 5px;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-description {
    display: inline-block;
    overflow: hidden;
    height: 2.8em;
    width: 80%;
    margin-right: 4%;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-preview {
    display: inline-block;
    width: 15%;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-preview img {
    height: 3em;
    width: auto;
    display: none;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-preview img[src] {
    display: initial;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion.aa-cursor {
    background-color: #eee;
  }
  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion em {
    font-weight: bold;
    font-style: normal;
  }

  </style>


  <!--/radix_placeholder_navigation_in_header-->
  <!--radix_placeholder_distill-->

  <style type="text/css">

  body {
    background-color: white;
  }

  .pandoc-table {
    width: 100%;
  }

  .pandoc-table>caption {
    margin-bottom: 10px;
  }

  .pandoc-table th:not([align]) {
    text-align: left;
  }

  .pagedtable-footer {
    font-size: 15px;
  }

  d-byline .byline {
    grid-template-columns: 2fr 2fr;
  }

  d-byline .byline h3 {
    margin-block-start: 1.5em;
  }

  d-byline .byline .authors-affiliations h3 {
    margin-block-start: 0.5em;
  }

  .authors-affiliations .orcid-id {
    width: 16px;
    height:16px;
    margin-left: 4px;
    margin-right: 4px;
    vertical-align: middle;
    padding-bottom: 2px;
  }

  d-title .dt-tags {
    margin-top: 1em;
    grid-column: text;
  }

  .dt-tags .dt-tag {
    text-decoration: none;
    display: inline-block;
    color: rgba(0,0,0,0.6);
    padding: 0em 0.4em;
    margin-right: 0.5em;
    margin-bottom: 0.4em;
    font-size: 70%;
    border: 1px solid rgba(0,0,0,0.2);
    border-radius: 3px;
    text-transform: uppercase;
    font-weight: 500;
  }

  d-article table.gt_table td,
  d-article table.gt_table th {
    border-bottom: none;
  }

  .html-widget {
    margin-bottom: 2.0em;
  }

  .l-screen-inset {
    padding-right: 16px;
  }

  .l-screen .caption {
    margin-left: 10px;
  }

  .shaded {
    background: rgb(247, 247, 247);
    padding-top: 20px;
    padding-bottom: 20px;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
  }

  .shaded .html-widget {
    margin-bottom: 0;
    border: 1px solid rgba(0, 0, 0, 0.1);
  }

  .shaded .shaded-content {
    background: white;
  }

  .text-output {
    margin-top: 0;
    line-height: 1.5em;
  }

  .hidden {
    display: none !important;
  }

  d-article {
    padding-top: 2.5rem;
    padding-bottom: 30px;
  }

  d-appendix {
    padding-top: 30px;
  }

  d-article>p>img {
    width: 100%;
  }

  d-article h2 {
    margin: 1rem 0 1.5rem 0;
  }

  d-article h3 {
    margin-top: 1.5rem;
  }

  d-article iframe {
    border: 1px solid rgba(0, 0, 0, 0.1);
    margin-bottom: 2.0em;
    width: 100%;
  }

  /* Tweak code blocks */

  d-article div.sourceCode code,
  d-article pre code {
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  }

  d-article pre,
  d-article div.sourceCode,
  d-article div.sourceCode pre {
    overflow: auto;
  }

  d-article div.sourceCode {
    background-color: white;
  }

  d-article div.sourceCode pre {
    padding-left: 10px;
    font-size: 12px;
    border-left: 2px solid rgba(0,0,0,0.1);
  }

  d-article pre {
    font-size: 12px;
    color: black;
    background: none;
    margin-top: 0;
    text-align: left;
    white-space: pre;
    word-spacing: normal;
    word-break: normal;
    word-wrap: normal;
    line-height: 1.5;

    -moz-tab-size: 4;
    -o-tab-size: 4;
    tab-size: 4;

    -webkit-hyphens: none;
    -moz-hyphens: none;
    -ms-hyphens: none;
    hyphens: none;
  }

  d-article pre a {
    border-bottom: none;
  }

  d-article pre a:hover {
    border-bottom: none;
    text-decoration: underline;
  }

  d-article details {
    grid-column: text;
    margin-bottom: 0.8em;
  }

  @media(min-width: 768px) {

  d-article pre,
  d-article div.sourceCode,
  d-article div.sourceCode pre {
    overflow: visible !important;
  }

  d-article div.sourceCode pre {
    padding-left: 18px;
    font-size: 14px;
  }

  d-article pre {
    font-size: 14px;
  }

  }

  figure img.external {
    background: white;
    border: 1px solid rgba(0, 0, 0, 0.1);
    box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
    padding: 18px;
    box-sizing: border-box;
  }

  /* CSS for d-contents */

  .d-contents {
    grid-column: text;
    color: rgba(0,0,0,0.8);
    font-size: 0.9em;
    padding-bottom: 1em;
    margin-bottom: 1em;
    padding-bottom: 0.5em;
    margin-bottom: 1em;
    padding-left: 0.25em;
    justify-self: start;
  }

  @media(min-width: 1000px) {
    .d-contents.d-contents-float {
      height: 0;
      grid-column-start: 1;
      grid-column-end: 4;
      justify-self: center;
      padding-right: 3em;
      padding-left: 2em;
    }
  }

  .d-contents nav h3 {
    font-size: 18px;
    margin-top: 0;
    margin-bottom: 1em;
  }

  .d-contents li {
    list-style-type: none
  }

  .d-contents nav > ul {
    padding-left: 0;
  }

  .d-contents ul {
    padding-left: 1em
  }

  .d-contents nav ul li {
    margin-top: 0.6em;
    margin-bottom: 0.2em;
  }

  .d-contents nav a {
    font-size: 13px;
    border-bottom: none;
    text-decoration: none
    color: rgba(0, 0, 0, 0.8);
  }

  .d-contents nav a:hover {
    text-decoration: underline solid rgba(0, 0, 0, 0.6)
  }

  .d-contents nav > ul > li > a {
    font-weight: 600;
  }

  .d-contents nav > ul > li > ul {
    font-weight: inherit;
  }

  .d-contents nav > ul > li > ul > li {
    margin-top: 0.2em;
  }


  .d-contents nav ul {
    margin-top: 0;
    margin-bottom: 0.25em;
  }

  .d-article-with-toc h2:nth-child(2) {
    margin-top: 0;
  }


  /* Figure */

  .figure {
    position: relative;
    margin-bottom: 2.5em;
    margin-top: 1.5em;
  }

  .figure img {
    width: 100%;
  }

  .figure .caption {
    color: rgba(0, 0, 0, 0.6);
    font-size: 12px;
    line-height: 1.5em;
  }

  .figure img.external {
    background: white;
    border: 1px solid rgba(0, 0, 0, 0.1);
    box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
    padding: 18px;
    box-sizing: border-box;
  }

  .figure .caption a {
    color: rgba(0, 0, 0, 0.6);
  }

  .figure .caption b,
  .figure .caption strong, {
    font-weight: 600;
    color: rgba(0, 0, 0, 1.0);
  }

  /* Citations */

  d-article .citation {
    color: inherit;
    cursor: inherit;
  }

  div.hanging-indent{
    margin-left: 1em; text-indent: -1em;
  }

  /* Citation hover box */

  .tippy-box[data-theme~=light-border] {
    background-color: rgba(250, 250, 250, 0.95);
  }

  .tippy-content > p {
    margin-bottom: 0;
    padding: 2px;
  }


  /* Tweak 1000px media break to show more text */

  @media(min-width: 1000px) {
    .base-grid,
    distill-header,
    d-title,
    d-abstract,
    d-article,
    d-appendix,
    distill-appendix,
    d-byline,
    d-footnote-list,
    d-citation-list,
    distill-footer {
      grid-template-columns: [screen-start] 1fr [page-start kicker-start] 80px [middle-start] 50px [text-start kicker-end] 65px 65px 65px 65px 65px 65px 65px 65px [text-end gutter-start] 65px [middle-end] 65px [page-end gutter-end] 1fr [screen-end];
      grid-column-gap: 16px;
    }

    .grid {
      grid-column-gap: 16px;
    }

    d-article {
      font-size: 1.06rem;
      line-height: 1.7em;
    }
    figure .caption, .figure .caption, figure figcaption {
      font-size: 13px;
    }
  }

  @media(min-width: 1180px) {
    .base-grid,
    distill-header,
    d-title,
    d-abstract,
    d-article,
    d-appendix,
    distill-appendix,
    d-byline,
    d-footnote-list,
    d-citation-list,
    distill-footer {
      grid-template-columns: [screen-start] 1fr [page-start kicker-start] 60px [middle-start] 60px [text-start kicker-end] 60px 60px 60px 60px 60px 60px 60px 60px [text-end gutter-start] 60px [middle-end] 60px [page-end gutter-end] 1fr [screen-end];
      grid-column-gap: 32px;
    }

    .grid {
      grid-column-gap: 32px;
    }
  }


  /* Get the citation styles for the appendix (not auto-injected on render since
     we do our own rendering of the citation appendix) */

  d-appendix .citation-appendix,
  .d-appendix .citation-appendix {
    font-size: 11px;
    line-height: 15px;
    border-left: 1px solid rgba(0, 0, 0, 0.1);
    padding-left: 18px;
    border: 1px solid rgba(0,0,0,0.1);
    background: rgba(0, 0, 0, 0.02);
    padding: 10px 18px;
    border-radius: 3px;
    color: rgba(150, 150, 150, 1);
    overflow: hidden;
    margin-top: -12px;
    white-space: pre-wrap;
    word-wrap: break-word;
  }

  /* Include appendix styles here so they can be overridden */

  d-appendix {
    contain: layout style;
    font-size: 0.8em;
    line-height: 1.7em;
    margin-top: 60px;
    margin-bottom: 0;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    color: rgba(0,0,0,0.5);
    padding-top: 60px;
    padding-bottom: 48px;
  }

  d-appendix h3 {
    grid-column: page-start / text-start;
    font-size: 15px;
    font-weight: 500;
    margin-top: 1em;
    margin-bottom: 0;
    color: rgba(0,0,0,0.65);
  }

  d-appendix h3 + * {
    margin-top: 1em;
  }

  d-appendix ol {
    padding: 0 0 0 15px;
  }

  @media (min-width: 768px) {
    d-appendix ol {
      padding: 0 0 0 30px;
      margin-left: -30px;
    }
  }

  d-appendix li {
    margin-bottom: 1em;
  }

  d-appendix a {
    color: rgba(0, 0, 0, 0.6);
  }

  d-appendix > * {
    grid-column: text;
  }

  d-appendix > d-footnote-list,
  d-appendix > d-citation-list,
  d-appendix > distill-appendix {
    grid-column: screen;
  }

  /* Include footnote styles here so they can be overridden */

  d-footnote-list {
    contain: layout style;
  }

  d-footnote-list > * {
    grid-column: text;
  }

  d-footnote-list a.footnote-backlink {
    color: rgba(0,0,0,0.3);
    padding-left: 0.5em;
  }



  /* Anchor.js */

  .anchorjs-link {
    /*transition: all .25s linear; */
    text-decoration: none;
    border-bottom: none;
  }
  *:hover > .anchorjs-link {
    margin-left: -1.125em !important;
    text-decoration: none;
    border-bottom: none;
  }

  /* Social footer */

  .social_footer {
    margin-top: 30px;
    margin-bottom: 0;
    color: rgba(0,0,0,0.67);
  }

  .disqus-comments {
    margin-right: 30px;
  }

  .disqus-comment-count {
    border-bottom: 1px solid rgba(0, 0, 0, 0.4);
    cursor: pointer;
  }

  #disqus_thread {
    margin-top: 30px;
  }

  .article-sharing a {
    border-bottom: none;
    margin-right: 8px;
  }

  .article-sharing a:hover {
    border-bottom: none;
  }

  .sidebar-section.subscribe {
    font-size: 12px;
    line-height: 1.6em;
  }

  .subscribe p {
    margin-bottom: 0.5em;
  }


  .article-footer .subscribe {
    font-size: 15px;
    margin-top: 45px;
  }


  .sidebar-section.custom {
    font-size: 12px;
    line-height: 1.6em;
  }

  .custom p {
    margin-bottom: 0.5em;
  }

  /* Styles for listing layout (hide title) */
  .layout-listing d-title, .layout-listing .d-title {
    display: none;
  }

  /* Styles for posts lists (not auto-injected) */


  .posts-with-sidebar {
    padding-left: 45px;
    padding-right: 45px;
  }

  .posts-list .description h2,
  .posts-list .description p {
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
  }

  .posts-list .description h2 {
    font-weight: 700;
    border-bottom: none;
    padding-bottom: 0;
  }

  .posts-list h2.post-tag {
    border-bottom: 1px solid rgba(0, 0, 0, 0.2);
    padding-bottom: 12px;
  }
  .posts-list {
    margin-top: 60px;
    margin-bottom: 24px;
  }

  .posts-list .post-preview {
    text-decoration: none;
    overflow: hidden;
    display: block;
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
    padding: 24px 0;
  }

  .post-preview-last {
    border-bottom: none !important;
  }

  .posts-list .posts-list-caption {
    grid-column: screen;
    font-weight: 400;
  }

  .posts-list .post-preview h2 {
    margin: 0 0 6px 0;
    line-height: 1.2em;
    font-style: normal;
    font-size: 24px;
  }

  .posts-list .post-preview p {
    margin: 0 0 12px 0;
    line-height: 1.4em;
    font-size: 16px;
  }

  .posts-list .post-preview .thumbnail {
    box-sizing: border-box;
    margin-bottom: 24px;
    position: relative;
    max-width: 500px;
  }
  .posts-list .post-preview img {
    width: 100%;
    display: block;
  }

  .posts-list .metadata {
    font-size: 12px;
    line-height: 1.4em;
    margin-bottom: 18px;
  }

  .posts-list .metadata > * {
    display: inline-block;
  }

  .posts-list .metadata .publishedDate {
    margin-right: 2em;
  }

  .posts-list .metadata .dt-authors {
    display: block;
    margin-top: 0.3em;
    margin-right: 2em;
  }

  .posts-list .dt-tags {
    display: block;
    line-height: 1em;
  }

  .posts-list .dt-tags .dt-tag {
    display: inline-block;
    color: rgba(0,0,0,0.6);
    padding: 0.3em 0.4em;
    margin-right: 0.2em;
    margin-bottom: 0.4em;
    font-size: 60%;
    border: 1px solid rgba(0,0,0,0.2);
    border-radius: 3px;
    text-transform: uppercase;
    font-weight: 500;
  }

  .posts-list img {
    opacity: 1;
  }

  .posts-list img[data-src] {
    opacity: 0;
  }

  .posts-more {
    clear: both;
  }


  .posts-sidebar {
    font-size: 16px;
  }

  .posts-sidebar h3 {
    font-size: 16px;
    margin-top: 0;
    margin-bottom: 0.5em;
    font-weight: 400;
    text-transform: uppercase;
  }

  .sidebar-section {
    margin-bottom: 30px;
  }

  .categories ul {
    list-style-type: none;
    margin: 0;
    padding: 0;
  }

  .categories li {
    color: rgba(0, 0, 0, 0.8);
    margin-bottom: 0;
  }

  .categories li>a {
    border-bottom: none;
  }

  .categories li>a:hover {
    border-bottom: 1px solid rgba(0, 0, 0, 0.4);
  }

  .categories .active {
    font-weight: 600;
  }

  .categories .category-count {
    color: rgba(0, 0, 0, 0.4);
  }


  @media(min-width: 768px) {
    .posts-list .post-preview h2 {
      font-size: 26px;
    }
    .posts-list .post-preview .thumbnail {
      float: right;
      width: 30%;
      margin-bottom: 0;
    }
    .posts-list .post-preview .description {
      float: left;
      width: 45%;
    }
    .posts-list .post-preview .metadata {
      float: left;
      width: 20%;
      margin-top: 8px;
    }
    .posts-list .post-preview p {
      margin: 0 0 12px 0;
      line-height: 1.5em;
      font-size: 16px;
    }
    .posts-with-sidebar .posts-list {
      float: left;
      width: 75%;
    }
    .posts-with-sidebar .posts-sidebar {
      float: right;
      width: 20%;
      margin-top: 60px;
      padding-top: 24px;
      padding-bottom: 24px;
    }
  }


  /* Improve display for browsers without grid (IE/Edge <= 15) */

  .downlevel {
    line-height: 1.6em;
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
    margin: 0;
  }

  .downlevel .d-title {
    padding-top: 6rem;
    padding-bottom: 1.5rem;
  }

  .downlevel .d-title h1 {
    font-size: 50px;
    font-weight: 700;
    line-height: 1.1em;
    margin: 0 0 0.5rem;
  }

  .downlevel .d-title p {
    font-weight: 300;
    font-size: 1.2rem;
    line-height: 1.55em;
    margin-top: 0;
  }

  .downlevel .d-byline {
    padding-top: 0.8em;
    padding-bottom: 0.8em;
    font-size: 0.8rem;
    line-height: 1.8em;
  }

  .downlevel .section-separator {
    border: none;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
  }

  .downlevel .d-article {
    font-size: 1.06rem;
    line-height: 1.7em;
    padding-top: 1rem;
    padding-bottom: 2rem;
  }


  .downlevel .d-appendix {
    padding-left: 0;
    padding-right: 0;
    max-width: none;
    font-size: 0.8em;
    line-height: 1.7em;
    margin-bottom: 0;
    color: rgba(0,0,0,0.5);
    padding-top: 40px;
    padding-bottom: 48px;
  }

  .downlevel .footnotes ol {
    padding-left: 13px;
  }

  .downlevel .base-grid,
  .downlevel .distill-header,
  .downlevel .d-title,
  .downlevel .d-abstract,
  .downlevel .d-article,
  .downlevel .d-appendix,
  .downlevel .distill-appendix,
  .downlevel .d-byline,
  .downlevel .d-footnote-list,
  .downlevel .d-citation-list,
  .downlevel .distill-footer,
  .downlevel .appendix-bottom,
  .downlevel .posts-container {
    padding-left: 40px;
    padding-right: 40px;
  }

  @media(min-width: 768px) {
    .downlevel .base-grid,
    .downlevel .distill-header,
    .downlevel .d-title,
    .downlevel .d-abstract,
    .downlevel .d-article,
    .downlevel .d-appendix,
    .downlevel .distill-appendix,
    .downlevel .d-byline,
    .downlevel .d-footnote-list,
    .downlevel .d-citation-list,
    .downlevel .distill-footer,
    .downlevel .appendix-bottom,
    .downlevel .posts-container {
    padding-left: 150px;
    padding-right: 150px;
    max-width: 900px;
  }
  }

  .downlevel pre code {
    display: block;
    border-left: 2px solid rgba(0, 0, 0, .1);
    padding: 0 0 0 20px;
    font-size: 14px;
  }

  .downlevel code, .downlevel pre {
    color: black;
    background: none;
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
    text-align: left;
    white-space: pre;
    word-spacing: normal;
    word-break: normal;
    word-wrap: normal;
    line-height: 1.5;

    -moz-tab-size: 4;
    -o-tab-size: 4;
    tab-size: 4;

    -webkit-hyphens: none;
    -moz-hyphens: none;
    -ms-hyphens: none;
    hyphens: none;
  }

  .downlevel .posts-list .post-preview {
    color: inherit;
  }



  </style>

  <script type="application/javascript">

  function is_downlevel_browser() {
    if (bowser.isUnsupportedBrowser({ msie: "12", msedge: "16"},
                                   window.navigator.userAgent)) {
      return true;
    } else {
      return window.load_distill_framework === undefined;
    }
  }

  // show body when load is complete
  function on_load_complete() {

    // add anchors
    if (window.anchors) {
      window.anchors.options.placement = 'left';
      window.anchors.add('d-article > h2, d-article > h3, d-article > h4, d-article > h5');
    }


    // set body to visible
    document.body.style.visibility = 'visible';

    // force redraw for leaflet widgets
    if (window.HTMLWidgets) {
      var maps = window.HTMLWidgets.findAll(".leaflet");
      $.each(maps, function(i, el) {
        var map = this.getMap();
        map.invalidateSize();
        map.eachLayer(function(layer) {
          if (layer instanceof L.TileLayer)
            layer.redraw();
        });
      });
    }

    // trigger 'shown' so htmlwidgets resize
    $('d-article').trigger('shown');
  }

  function init_distill() {

    init_common();

    // create front matter
    var front_matter = $('<d-front-matter></d-front-matter>');
    $('#distill-front-matter').wrap(front_matter);

    // create d-title
    $('.d-title').changeElementType('d-title');

    // create d-byline
    var byline = $('<d-byline></d-byline>');
    $('.d-byline').replaceWith(byline);

    // create d-article
    var article = $('<d-article></d-article>');
    $('.d-article').wrap(article).children().unwrap();

    // move posts container into article
    $('.posts-container').appendTo($('d-article'));

    // create d-appendix
    $('.d-appendix').changeElementType('d-appendix');

    // flag indicating that we have appendix items
    var appendix = $('.appendix-bottom').children('h3').length > 0;

    // replace footnotes with <d-footnote>
    $('.footnote-ref').each(function(i, val) {
      appendix = true;
      var href = $(this).attr('href');
      var id = href.replace('#', '');
      var fn = $('#' + id);
      var fn_p = $('#' + id + '>p');
      fn_p.find('.footnote-back').remove();
      var text = fn_p.html();
      var dtfn = $('<d-footnote></d-footnote>');
      dtfn.html(text);
      $(this).replaceWith(dtfn);
    });
    // remove footnotes
    $('.footnotes').remove();

    // move refs into #references-listing
    $('#references-listing').replaceWith($('#refs'));

    $('h1.appendix, h2.appendix').each(function(i, val) {
      $(this).changeElementType('h3');
    });
    $('h3.appendix').each(function(i, val) {
      var id = $(this).attr('id');
      $('.d-contents a[href="#' + id + '"]').parent().remove();
      appendix = true;
      $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('d-appendix'));
    });

    // show d-appendix if we have appendix content
    $("d-appendix").css('display', appendix ? 'grid' : 'none');

    // localize layout chunks to just output
    $('.layout-chunk').each(function(i, val) {

      // capture layout
      var layout = $(this).attr('data-layout');

      // apply layout to markdown level block elements
      var elements = $(this).children().not('details, div.sourceCode, pre, script');
      elements.each(function(i, el) {
        var layout_div = $('<div class="' + layout + '"></div>');
        if (layout_div.hasClass('shaded')) {
          var shaded_content = $('<div class="shaded-content"></div>');
          $(this).wrap(shaded_content);
          $(this).parent().wrap(layout_div);
        } else {
          $(this).wrap(layout_div);
        }
      });


      // unwrap the layout-chunk div
      $(this).children().unwrap();
    });

    // remove code block used to force  highlighting css
    $('.distill-force-highlighting-css').parent().remove();

    // remove empty line numbers inserted by pandoc when using a
    // custom syntax highlighting theme
    $('code.sourceCode a:empty').remove();

    // load distill framework
    load_distill_framework();

    // wait for window.distillRunlevel == 4 to do post processing
    function distill_post_process() {

      if (!window.distillRunlevel || window.distillRunlevel < 4)
        return;

      // hide author/affiliations entirely if we have no authors
      var front_matter = JSON.parse($("#distill-front-matter").html());
      var have_authors = front_matter.authors && front_matter.authors.length > 0;
      if (!have_authors)
        $('d-byline').addClass('hidden');

      // article with toc class
      $('.d-contents').parent().addClass('d-article-with-toc');

      // strip links that point to #
      $('.authors-affiliations').find('a[href="#"]').removeAttr('href');

      // add orcid ids
      $('.authors-affiliations').find('.author').each(function(i, el) {
        var orcid_id = front_matter.authors[i].orcidID;
        if (orcid_id) {
          var a = $('<a></a>');
          a.attr('href', 'https://orcid.org/' + orcid_id);
          var img = $('<img></img>');
          img.addClass('orcid-id');
          img.attr('alt', 'ORCID ID');
          img.attr('src','data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg==');
          a.append(img);
          $(this).append(a);
        }
      });

      // hide elements of author/affiliations grid that have no value
      function hide_byline_column(caption) {
        $('d-byline').find('h3:contains("' + caption + '")').parent().css('visibility', 'hidden');
      }

      // affiliations
      var have_affiliations = false;
      for (var i = 0; i<front_matter.authors.length; ++i) {
        var author = front_matter.authors[i];
        if (author.affiliation !== "&nbsp;") {
          have_affiliations = true;
          break;
        }
      }
      if (!have_affiliations)
        $('d-byline').find('h3:contains("Affiliations")').css('visibility', 'hidden');

      // published date
      if (!front_matter.publishedDate)
        hide_byline_column("Published");

      // document object identifier
      var doi = $('d-byline').find('h3:contains("DOI")');
      var doi_p = doi.next().empty();
      if (!front_matter.doi) {
        // if we have a citation and valid citationText then link to that
        if ($('#citation').length > 0 && front_matter.citationText) {
          doi.html('Citation');
          $('<a href="#citation"></a>')
            .text(front_matter.citationText)
            .appendTo(doi_p);
        } else {
          hide_byline_column("DOI");
        }
      } else {
        $('<a></a>')
           .attr('href', "https://doi.org/" + front_matter.doi)
           .html(front_matter.doi)
           .appendTo(doi_p);
      }

       // change plural form of authors/affiliations
      if (front_matter.authors.length === 1) {
        var grid = $('.authors-affiliations');
        grid.children('h3:contains("Authors")').text('Author');
        grid.children('h3:contains("Affiliations")').text('Affiliation');
      }

      // remove d-appendix and d-footnote-list local styles
      $('d-appendix > style:first-child').remove();
      $('d-footnote-list > style:first-child').remove();

      // move appendix-bottom entries to the bottom
      $('.appendix-bottom').appendTo('d-appendix').children().unwrap();
      $('.appendix-bottom').remove();

      // hoverable references
      $('span.citation[data-cites]').each(function() {
        var refHtml = $('#ref-' + $(this).attr('data-cites')).html();
        window.tippy(this, {
          allowHTML: true,
          content: refHtml,
          maxWidth: 500,
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start'
        });
      });

      // clear polling timer
      clearInterval(tid);

      // show body now that everything is ready
      on_load_complete();
    }

    var tid = setInterval(distill_post_process, 50);
    distill_post_process();

  }

  function init_downlevel() {

    init_common();

     // insert hr after d-title
    $('.d-title').after($('<hr class="section-separator"/>'));

    // check if we have authors
    var front_matter = JSON.parse($("#distill-front-matter").html());
    var have_authors = front_matter.authors && front_matter.authors.length > 0;

    // manage byline/border
    if (!have_authors)
      $('.d-byline').remove();
    $('.d-byline').after($('<hr class="section-separator"/>'));
    $('.d-byline a').remove();

    // remove toc
    $('.d-contents').remove();

    // move appendix elements
    $('h1.appendix, h2.appendix').each(function(i, val) {
      $(this).changeElementType('h3');
    });
    $('h3.appendix').each(function(i, val) {
      $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('.d-appendix'));
    });


    // inject headers into references and footnotes
    var refs_header = $('<h3></h3>');
    refs_header.text('References');
    $('#refs').prepend(refs_header);

    var footnotes_header = $('<h3></h3');
    footnotes_header.text('Footnotes');
    $('.footnotes').children('hr').first().replaceWith(footnotes_header);

    // move appendix-bottom entries to the bottom
    $('.appendix-bottom').appendTo('.d-appendix').children().unwrap();
    $('.appendix-bottom').remove();

    // remove appendix if it's empty
    if ($('.d-appendix').children().length === 0)
      $('.d-appendix').remove();

    // prepend separator above appendix
    $('.d-appendix').before($('<hr class="section-separator" style="clear: both"/>'));

    // trim code
    $('pre>code').each(function(i, val) {
      $(this).html($.trim($(this).html()));
    });

    // move posts-container right before article
    $('.posts-container').insertBefore($('.d-article'));

    $('body').addClass('downlevel');

    on_load_complete();
  }


  function init_common() {

    // jquery plugin to change element types
    (function($) {
      $.fn.changeElementType = function(newType) {
        var attrs = {};

        $.each(this[0].attributes, function(idx, attr) {
          attrs[attr.nodeName] = attr.nodeValue;
        });

        this.replaceWith(function() {
          return $("<" + newType + "/>", attrs).append($(this).contents());
        });
      };
    })(jQuery);

    // prevent underline for linked images
    $('a > img').parent().css({'border-bottom' : 'none'});

    // mark non-body figures created by knitr chunks as 100% width
    $('.layout-chunk').each(function(i, val) {
      var figures = $(this).find('img, .html-widget');
      if ($(this).attr('data-layout') !== "l-body") {
        figures.css('width', '100%');
      } else {
        figures.css('max-width', '100%');
        figures.filter("[width]").each(function(i, val) {
          var fig = $(this);
          fig.css('width', fig.attr('width') + 'px');
        });

      }
    });

    // auto-append index.html to post-preview links in file: protocol
    // and in rstudio ide preview
    $('.post-preview').each(function(i, val) {
      if (window.location.protocol === "file:")
        $(this).attr('href', $(this).attr('href') + "index.html");
    });

    // get rid of index.html references in header
    if (window.location.protocol !== "file:") {
      $('.distill-site-header a[href]').each(function(i,val) {
        $(this).attr('href', $(this).attr('href').replace("index.html", "./"));
      });
    }

    // add class to pandoc style tables
    $('tr.header').parent('thead').parent('table').addClass('pandoc-table');
    $('.kable-table').children('table').addClass('pandoc-table');

    // add figcaption style to table captions
    $('caption').parent('table').addClass("figcaption");

    // initialize posts list
    if (window.init_posts_list)
      window.init_posts_list();

    // implmement disqus comment link
    $('.disqus-comment-count').click(function() {
      window.headroom_prevent_pin = true;
      $('#disqus_thread').toggleClass('hidden');
      if (!$('#disqus_thread').hasClass('hidden')) {
        var offset = $(this).offset();
        $(window).resize();
        $('html, body').animate({
          scrollTop: offset.top - 35
        });
      }
    });
  }

  document.addEventListener('DOMContentLoaded', function() {
    if (is_downlevel_browser())
      init_downlevel();
    else
      window.addEventListener('WebComponentsReady', init_distill);
  });

  </script>

  <!--/radix_placeholder_distill-->
  <script src="site_libs/header-attrs-2.11/header-attrs.js"></script>
  <link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
  <script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>
  <script src="site_libs/popper-2.6.0/popper.min.js"></script>
  <link href="site_libs/tippy-6.2.7/tippy.css" rel="stylesheet" />
  <link href="site_libs/tippy-6.2.7/tippy-light-border.css" rel="stylesheet" />
  <script src="site_libs/tippy-6.2.7/tippy.umd.min.js"></script>
  <script src="site_libs/anchor-4.2.2/anchor.min.js"></script>
  <script src="site_libs/bowser-1.9.3/bowser.min.js"></script>
  <script src="site_libs/webcomponents-2.0.0/webcomponents.js"></script>
  <script src="site_libs/distill-2.2.21/template.v2.js"></script>
  <!--radix_placeholder_site_in_header-->
  <!--/radix_placeholder_site_in_header-->


</head>

<body>

<!--radix_placeholder_front_matter-->

<script id="distill-front-matter" type="text/json">
{"title":"Part 4: Tidymodels Workflowsets","description":"On this Part 4 page we will analyse the same agroforestry data from ERA, as in Part 3, but we are going to make use of the relatively new tidymodels package called \"Workflowsets\". We are going to skip the preliminary explorertive data analysis (EDA) and jump straight to the modelling setup.  \"Show code\" to view the R codes used to perform a given analysis or visualise a analysis output. As you have seen in Part 3, tidymodels builds on the integration of model specifications from the parsnip package and data pre-processing steps using the recipe package. These are integrated into a workflow using the workflows package, and finally tuned using the tune package. What is revolutionary about the latest member in the tidymodels family is the workflowsets package that can create a workflow set that holds multiple workflow objects (integrated model specifications and pre-processing steps). This object, or set, can then easily be tuned or fitted based on resamples by using a set of simple commands. Workflowsets is a powerful concept for modelling as researchers often are interested in test and compare the performance of multiple models specified under different pre-processing settings.","authors":[]}
</script>

<!--/radix_placeholder_front_matter-->
<!--radix_placeholder_navigation_before_body-->
<header class="header header--fixed" role="banner">
<nav class="distill-site-nav distill-site-header">
<div class="nav-left">
<a class="logo" href="https://era.ccafs.cgiar.org/about/">
<img src="IMAGES/ERA_logo_circle.png" alt="Logo"/>
</a>
<a href="index.html" class="title">Home</a>
</div>
<div class="nav-right">
<a href="ABOUT.html">About this site</a>
<a href="INTRO.html">PART 1: Introduction</a>
<a href="ERAANA.html">PART 2: with ERAAnalyze</a>
<a href="MLTIDYMODELS.html">PART 3:  with Tidymodels</a>
<a href="TIDYMODELSWFS.html">PART 4: with Tidymodels Workflowsets</a>
<a href="MLTIDYMODELSCLASS.html">PART 5: with Tidymodels Classification</a>
<a href="https://github.com/kamaulindhardt/ERA_Agroforestry_destill_website">
<i class="fab fa-github" aria-hidden="true"></i>
</a>
<a href="https://twitter.com/KamauLindhardt">
<i class="fa fa-twitter" aria-hidden="true"></i>
</a>
<a href="https://www.linkedin.com/in/magnus-kamau-lindhardt/">
<i class="fa fa-linkedin" aria-hidden="true"></i>
</a>
<a href="javascript:void(0);" class="nav-toggle">&#9776;</a>
</div>
</nav>
</header>
<!--/radix_placeholder_navigation_before_body-->
<!--radix_placeholder_site_before_body-->
<!--/radix_placeholder_site_before_body-->

<div class="d-title">
<h1>Part 4: Tidymodels Workflowsets</h1>
<!--radix_placeholder_categories-->
<!--/radix_placeholder_categories-->
<p><p>On this Part 4 page we will analyse the same agroforestry data from ERA, as in Part 3, but we are going to make use of the relatively new tidymodels package called “Workflowsets.” We are going to skip the preliminary explorertive data analysis (EDA) and jump straight to the modelling setup. “Show code” to view the R codes used to perform a given analysis or visualise a analysis output. As you have seen in Part 3, tidymodels builds on the integration of model specifications from the parsnip package and data pre-processing steps using the recipe package. These are integrated into a workflow using the workflows package, and finally tuned using the tune package. What is revolutionary about the latest member in the tidymodels family is the workflowsets package that can create a workflow set that holds multiple workflow objects (integrated model specifications and pre-processing steps). This object, or set, can then easily be tuned or fitted based on resamples by using a set of simple commands. Workflowsets is a powerful concept for modelling as researchers often are interested in test and compare the performance of multiple models specified under different pre-processing settings.</p></p>
</div>


<div class="d-article">
<div class="d-contents d-contents-float">
<nav class="l-text toc figcaption" id="TOC">
<h3>Contents</h3>
<ul>
<li><a href="#loading-necessary-r-packages-and-era-data">Loading necessary R packages and ERA data</a>
<ul>
<li><a href="#step-1-getting-the-data">STEP 1: Getting the data</a></li>
<li><a href="#step-2-splitting-data">STEP 2: Splitting data</a></li>
<li><a href="#step-3-define-resampling-techniques-on-training-data">STEP 3: Define resampling techniques on training data</a></li>
<li><a href="#step-4-define-model-metrics">STEP 4: Define model metrics</a></li>
<li><a href="#step-5-create-pre-processing-recipies">STEP 5: Create pre-processing recipies</a></li>
<li><a href="#step-6-defining-model-specifications">STEP 6: Defining model specifications</a></li>
<li><a href="#step-7-integrating-pre-processing-and-model-specification-into-a-workflowset">STEP 7: Integrating pre-processing and model specification into a workflowset</a></li>
<li><a href="#step-8-tuning-workflowsets-using-tune_grid-or-tune_race_anova">STEP 8: Tuning workflowsets using tune_grid() or tune_race_anova()</a>
<ul>
<li><a href="#using-tune_grid">Using tune_grid()</a></li>
<li><a href="#using-tune_race_anova">Using tune_race_anova()</a></li>
<li><a href="#saving-the-workflowset-tuning-results">SAVING THE WORKFLOWSET TUNING RESULTS</a></li>
</ul></li>
<li><a href="#step-9-assessing-results-of-the-tuned-workflowsets">STEP 9: Assessing results of the tuned workflowsets</a>
<ul>
<li><a href="#from-tune_grid">From tune_grid()</a></li>
<li><a href="#ranking-workflowsets-results-from-model-pre-processing-combinations">Ranking Workflowsets results from model-pre-processing combinations</a></li>
</ul></li>
<li><a href="#step-10-finalizing-models">STEP 10: Finalizing models</a>
<ul>
<li><a href="#extracting-best-performing-model-hyper-parameter-configurations">Extracting best performing model (hyper)-parameter configurations</a></li>
<li><a href="#saving-best-performing-models">Saving best performing models</a></li>
<li><a href="#performing-last-fitting-on-the-whole-dataset-traningset-testingset">Performing last fitting on the whole dataset (traningset + testingset)</a></li>
<li><a href="#saving-last-fitting-results-of-models">Saving last fitting results of models</a></li>
</ul></li>
<li><a href="#step-11-assessingevaluating-model-performance">STEP 11: Assessing/evaluating model performance</a>
<ul>
<li><a href="#viewing-the-performance-of-the-random-forest-model-for-rmse-and-rsq">Viewing the performance of the Random Forest model for RMSE and rsq</a></li>
<li><a href="#contructing-predicted-vs-observed-plot-for-the-random-forest">Contructing predicted vs observed plot for the Random Forest</a></li>
<li><a href="#listing-some-predicted-vs-observed-values-of-response-ratios">Listing some predicted vs observed values of response ratios</a></li>
</ul></li>
<li><a href="#step-12-explaining-models-and-predictions-model-agnostics-with-local-break-down-plots">STEP 12: Explaining models and predictions (model agnostics) with local break-down plots</a>
<ul>
<li><a href="#step-12a-creating-trained-workflows-for-each-of-the-four-models">STEP 12a: Creating trained workflows for each of the four models</a></li>
<li><a href="#saving-trained-workflows">Saving trained workflows</a></li>
</ul></li>
<li><a href="#step-12b-generating-explainers-for-each-of-the-four-models">#STEP 12b: Generating explainers for each of the four models</a>
<ul>
<li><a href="#local-model-agnostics">Local model agnostics</a></li>
</ul></li>
<li><a href="#step-12b-extracting-predicted-vs-observed-values-of-response-ratios-for-high-and-low-values">STEP 12b: Extracting predicted vs observed values of response ratios for high and low values</a>
<ul>
<li><a href="#exstracting-observation-for-low-and-high-response-ratio-value">Exstracting observation for <strong>low</strong> and <strong>high</strong> response ratio value</a></li>
</ul></li>
<li><a href="#step-12c-model-break-down-plots">STEP 12c: Model break-down plots</a>
<ul>
<li><a href="#generating-break-down-data-for-all-the-four-models">Generating break-down data for all the four models</a></li>
<li><a href="#break-down-of-individial-model-parts">Break-down of individial model parts</a></li>
<li><a href="#step-12d-visualising-break-down-of-individial-model-parts-for-the-case-of-obs_1-low-rr-value--1.82">STEP 12d: Visualising break-down of individial model parts for the case of obs_1 (low RR value = -1.82)</a></li>
<li><a href="#step-12e-visualising-break-down-of-individial-model-parts-for-the-case-of-obs_2-high-rr-value-3.04">STEP 12e: Visualising break-down of individial model parts for the case of obs_2 (high RR value = 3.04)</a></li>
</ul></li>
<li><a href="#step-13-explaining-models-and-predictions-model-agnostics-with-shap-plots">STEP 13: Explaining models and predictions (model agnostics) with SHAP plots</a>
<ul>
<li><a href="#creating-shap-plot-based-on-the-four-different-models-for-the-low-rr--1.82">Creating SHAP plot based on the four different models <strong>for the low RR = -1.82</strong></a></li>
<li><a href="#creating-shap-plot-based-on-the-four-different-models-for-the-high-rr-3.05">Creating SHAP plot based on the four different models <strong>for the high RR = 3.05</strong></a></li>
</ul></li>
<li><a href="#step-14-global-model-explorations-global-model-agnostics">STEP 14: Global model explorations (global model agnostics)</a>
<ul>
<li><a href="#generating-vip-datasets-for-each-of-the-four-models">Generating vip datasets for each of the four models</a></li>
<li><a href="#using-function-to-plot-the-vip-datasets-for-each-model">Using function to plot the vip datasets for each model</a></li>
</ul></li>
<li><a href="#step-15-model-exploration-and-agnosticcs-from-partial-dependencce-plots">STEP 15: Model exploration and agnosticcs from partial dependencce plots</a></li>
<li><a href="#step-16-global-model-partial-dependencce-plots">STEP 16: Global model partial dependencce plots</a></li>
<li><a href="#step-17-global-model-residual-evaluation">STEP 17: Global model residual evaluation</a></li>
<li><a href="#step-18-global-and-local-model-explorotive-analysis-agnostics-using-ceteris-paribus-profiles-cpp">STEP 18: Global and local model explorotive analysis (agnostics) using Ceteris Paribus Profiles (CPP)</a>
<ul>
<li><a href="#generating-new-observation-for-the-cpp-plot">Generating new observation for the CPP plot</a></li>
<li><a href="#creating-dataset-for-the-cpp-for-all-the-four-models-with-a-relatively-low-rr-observation">Creating dataset for the CPP for all the four models (with a relatively low RR observation)</a></li>
<li><a href="#visualising-the-cpp-for-the-random-forest-model-for-selected-environmental-predictor-features">Visualising the CPP for the Random Forest model for selected environmental predictor features</a></li>
</ul></li>
<li><a href="#step-19-using-the-models-to-predict-on-new-data">STEP 19: Using the models to predict on new data</a>
<ul>
<li><a href="#first-removing-na-from-the-predictor-feature-columns">First, removing NA from the predictor feature columns</a></li>
<li><a href="#using-expand_grid-to-generate-new-data-from-the-traning-data">Using expand_grid to generate new data from the traning data</a></li>
<li><a href="#predicting-with-the-random-forest-model-on-the-new-data">Predicting with the Random Forest model on the new data</a></li>
<li><a href="#creating-the-dataset-of-predicted-response-ratio-values-for-each-of-the-predictors">Creating the dataset of predicted response ratio values for each of the predictors</a></li>
</ul></li>
</ul></li>
</ul>
</nav>
</div>
<p>Here we are going to explore Machine Learning with Tidymodels on the ERA agroforestry data</p>
<p>These objects can be created by crossing all combinations of pre-processors (e.g., formula, recipe, etc) and model specifications. This different model toolkit in the arsenal of</p>
<h1 id="loading-necessary-r-packages-and-era-data">Loading necessary R packages and ERA data</h1>
<p><strong>Loading general R packages</strong></p>
<p>This part of the document is where we actually get to the nitty-gritty of the ERA agroforestry data and therefore it requires us to load a number of R packages for both general Explorortive Data Analysis and Machine Learning.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># Using the pacman functions to load required packages</span>

        <span class='kw'>if</span><span class='op'>(</span><span class='op'>!</span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>require</a></span><span class='op'>(</span><span class='st'><a href='https://github.com/trinker/pacman'>"pacman"</a></span>, character.only <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span><span class='op'>)</span><span class='op'>{</span>
          <span class='fu'><a href='https://rdrr.io/r/utils/install.packages.html'>install.packages</a></span><span class='op'>(</span><span class='st'>"pacman"</span>,dependencies <span class='op'>=</span> <span class='cn'>T</span><span class='op'>)</span>
          <span class='op'>}</span>

<span class='co'># ------------------------------------------------------------------------------------------</span>
<span class='co'># General packages</span>
<span class='co'># ------------------------------------------------------------------------------------------</span>
<span class='va'>required.packages</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"tidyverse"</span>, <span class='st'>"tidymodels"</span>, <span class='st'>"finetune"</span>, <span class='st'>"kernlab"</span>, <span class='st'>"here"</span>, <span class='st'>"hablar"</span>, <span class='st'>"spatialsample"</span>, <span class='st'>"cowplot"</span>, 
                       <span class='st'>"stacks"</span>, <span class='st'>"rules"</span>, <span class='st'>"baguette"</span>, <span class='st'>"viridis"</span>, <span class='st'>"yardstick"</span>, <span class='st'>"DALEXtra"</span>, <span class='st'>"see"</span>, <span class='st'>"ggridges"</span>,
<span class='co'># ------------------------------------------------------------------------------------------</span>
<span class='co'># Parallel computing packages</span>
<span class='co'># ------------------------------------------------------------------------------------------</span>
                      <span class='st'>"parallelMap"</span>, <span class='st'>"parallelly"</span>, <span class='st'>"parallel"</span>, <span class='st'>"doParallel"</span>
<span class='op'>)</span>

<span class='fu'>p_load</span><span class='op'>(</span>char<span class='op'>=</span><span class='va'>required.packages</span>, install <span class='op'>=</span> <span class='cn'>T</span>,character.only <span class='op'>=</span> <span class='cn'>T</span><span class='op'>)</span>
</code></pre>
</div>
</details>
</div>
<h2 id="step-1-getting-the-data">STEP 1: Getting the data</h2>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>agrofor.biophys.modelling.data.wf</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/readRDS.html'>readRDS</a></span><span class='op'>(</span>file <span class='op'>=</span> <span class='fu'>here</span><span class='fu'>::</span><span class='fu'><a href='https://here.r-lib.org//reference/here.html'>here</a></span><span class='op'>(</span><span class='st'>"agrofor.biophys.modelling.data.RDS"</span><span class='op'>)</span><span class='op'>)</span>

<span class='va'>ml.data.wf</span> <span class='op'>&lt;-</span>  <span class='va'>agrofor.biophys.modelling.data.wf</span> <span class='op'>%&gt;%</span>
  <span class='fu'>dplyr</span><span class='fu'>::</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='op'>-</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"RR"</span>, <span class='st'>"ID"</span>, <span class='st'>"AEZ16s"</span>, <span class='st'>"Country"</span>, <span class='st'>"MeanC"</span>, <span class='st'>"MeanT"</span>, <span class='st'>"PrName.Code"</span>, <span class='st'>"SubPrName"</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p>Removing outliers from logRR</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>is_outlier</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span> <span class='op'>{</span>
  <span class='kw'><a href='https://rdrr.io/r/base/function.html'>return</a></span><span class='op'>(</span><span class='va'>x</span> <span class='op'>&lt;</span> <span class='fu'><a href='https://rdrr.io/r/stats/quantile.html'>quantile</a></span><span class='op'>(</span><span class='va'>x</span>, <span class='fl'>0.25</span><span class='op'>)</span> <span class='op'>-</span> <span class='fl'>3</span> <span class='op'>*</span> <span class='fu'><a href='https://rdrr.io/r/stats/IQR.html'>IQR</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span> <span class='op'>|</span> <span class='va'>x</span> <span class='op'>&gt;</span> <span class='fu'><a href='https://rdrr.io/r/stats/quantile.html'>quantile</a></span><span class='op'>(</span><span class='va'>x</span>, <span class='fl'>0.75</span><span class='op'>)</span> <span class='op'>+</span> <span class='fl'>3</span> <span class='op'>*</span> <span class='fu'><a href='https://rdrr.io/r/stats/IQR.html'>IQR</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span><span class='op'>)</span>
<span class='op'>}</span>

<span class='va'>ml.data.outliers.wf</span> <span class='op'>&lt;-</span> <span class='va'>ml.data.wf</span> <span class='op'>%&gt;%</span>
  <span class='fu'>rationalize</span><span class='op'>(</span><span class='va'>logRR</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>drop_na</span><span class='op'>(</span><span class='va'>logRR</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>mutate</span><span class='op'>(</span>ERA_Agroforestry <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>group_by</span><span class='op'>(</span><span class='va'>ERA_Agroforestry</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>mutate</span><span class='op'>(</span>logRR.outlier <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='fu'>is_outlier</span><span class='op'>(</span><span class='va'>logRR</span><span class='op'>)</span>, <span class='va'>logRR</span>, <span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>as.numeric</a></span><span class='op'>(</span><span class='fl'>9999</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>ungroup</span><span class='op'>(</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p>Agroforestry data with no outliers</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>ml.data.no.outliers.wf</span> <span class='op'>&lt;-</span>  <span class='va'>ml.data.outliers.wf</span> <span class='op'>%&gt;%</span>
  <span class='fu'>dplyr</span><span class='fu'>::</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>logRR.outlier</span> <span class='op'>==</span> <span class='fl'>9999</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>dplyr</span><span class='fu'>::</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='op'>-</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>ERA_Agroforestry</span>, <span class='va'>logRR.outlier</span><span class='op'>)</span><span class='op'>)</span>

<span class='co'>#saveRDS(ml.data.no.outliers.wf, here::here("ERAAnalyze_OUTPUT", "ml.data.no.outliers.wf.RDS"))</span>
</code></pre>
</div>
</div>
<p>Notice we do not remove missing values</p>
<h2 id="step-2-splitting-data">STEP 2: Splitting data</h2>
<p>Split data in training and testing sets</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>456</span><span class='op'>)</span>

<span class='co'># Splitting data</span>
<span class='va'>af.split.wf</span> <span class='op'>&lt;-</span> <span class='fu'>initial_split</span><span class='op'>(</span><span class='va'>ml.data.no.outliers.wf</span>, prop <span class='op'>=</span> <span class='fl'>0.80</span>, strata <span class='op'>=</span> <span class='va'>logRR</span><span class='op'>)</span>

<span class='va'>af.train.wf</span> <span class='op'>&lt;-</span> <span class='fu'>training</span><span class='op'>(</span><span class='va'>af.split.wf</span><span class='op'>)</span>
<span class='va'>af.test.wf</span> <span class='op'>&lt;-</span> <span class='fu'>testing</span><span class='op'>(</span><span class='va'>af.split.wf</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<h2 id="step-3-define-resampling-techniques-on-training-data">STEP 3: Define resampling techniques on training data</h2>
<p>Notice here that we do not have any repeats defined as we did originally. Previously we used an argument: repeats = 10 to specify the number of times to repeat the V-fold partitioning. Instead we are increasing the number of partitions/folds (v) from 10 to 20, for the cv-folds, just as the spatial clustering cv-folds.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>345</span><span class='op'>)</span>

<span class='co'># Re-sample technique(s) </span>
<span class='va'>boostrap.wf</span> <span class='op'>&lt;-</span> <span class='fu'>bootstraps</span><span class='op'>(</span><span class='va'>af.train.wf</span>, times <span class='op'>=</span> <span class='fl'>20</span>, strata <span class='op'>=</span> <span class='va'>logRR</span><span class='op'>)</span>
<span class='va'>cv.fold.wf</span> <span class='op'>&lt;-</span> <span class='fu'>vfold_cv</span><span class='op'>(</span><span class='va'>af.train.wf</span>, v <span class='op'>=</span> <span class='fl'>10</span>, repeats <span class='op'>=</span> <span class='fl'>5</span><span class='op'>)</span>
<span class='va'>spatial.cv.fold.wf</span> <span class='op'>&lt;-</span> <span class='fu'>spatial_clustering_cv</span><span class='op'>(</span><span class='va'>af.train.wf</span>, coords <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Longitude"</span>, <span class='st'>"Latitude"</span><span class='op'>)</span>, v <span class='op'>=</span> <span class='fl'>10</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<h2 id="step-4-define-model-metrics">STEP 4: Define model metrics</h2>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># Metrics</span>
<span class='va'>multi.metric.wf</span> <span class='op'>&lt;-</span> <span class='fu'>metric_set</span><span class='op'>(</span><span class='fu'>yardstick</span><span class='fu'>::</span><span class='va'><a href='https://yardstick.tidymodels.org/reference/rmse.html'>rmse</a></span>, <span class='fu'>yardstick</span><span class='fu'>::</span><span class='va'><a href='https://yardstick.tidymodels.org/reference/rsq.html'>rsq</a></span>, <span class='fu'>yardstick</span><span class='fu'>::</span><span class='va'><a href='https://yardstick.tidymodels.org/reference/ccc.html'>ccc</a></span>, <span class='fu'>yardstick</span><span class='fu'>::</span><span class='va'><a href='https://yardstick.tidymodels.org/reference/mae.html'>mae</a></span><span class='op'>)</span>

<span class='va'>model.control.wf</span> <span class='op'>&lt;-</span> <span class='fu'>control_stack_grid</span><span class='op'>(</span><span class='op'>)</span> <span class='co'># save_pred = TRUE, save_workflow = TRUE.</span>
<span class='va'>model.control.linear.wf</span> <span class='op'>&lt;-</span> <span class='fu'>control_resamples</span><span class='op'>(</span>save_pred <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<h2 id="step-5-create-pre-processing-recipies">STEP 5: Create pre-processing recipies</h2>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>base_recipe</span> <span class='op'>&lt;-</span> 
  <span class='fu'>recipe</span><span class='op'>(</span>formula <span class='op'>=</span> <span class='va'>logRR</span> <span class='op'>~</span> <span class='va'>.</span>, data <span class='op'>=</span> <span class='va'>af.train.wf</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>update_role</span><span class='op'>(</span><span class='va'>Site.Type</span>, new_role <span class='op'>=</span> <span class='st'>"predictor"</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='co'># alters an existing role in the recipe to variables.</span>
  <span class='fu'>update_role</span><span class='op'>(</span><span class='va'>PrName</span>, <span class='co'># or assigns an initial role to variables that do not yet have a declared role.</span>
              <span class='va'>Out.SubInd</span>,
              <span class='va'>Out.SubInd.Code</span>,
              <span class='va'>Product</span>,
              <span class='va'>Latitude</span>,
              <span class='va'>Longitude</span>,
              <span class='va'>Tree</span>,
              new_role <span class='op'>=</span> <span class='st'>"sample ID"</span><span class='op'>)</span> 
<span class='co'># ------------------------------------------------------------------------------------------------------------------------------------------------</span>
   

<span class='va'>impute_mean_recipe</span> <span class='op'>&lt;-</span> 
  <span class='va'>base_recipe</span> <span class='op'>%&gt;%</span>
  <span class='fu'>step_impute_mean</span><span class='op'>(</span><span class='fu'>all_numeric_predictors</span><span class='op'>(</span><span class='op'>)</span>, skip <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>step_novel</span><span class='op'>(</span><span class='va'>Site.Type</span>, skip <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>step_dummy</span><span class='op'>(</span><span class='va'>Site.Type</span>, one_hot <span class='op'>=</span> <span class='cn'>TRUE</span>, naming <span class='op'>=</span> <span class='fu'>partial</span><span class='op'>(</span><span class='va'>dummy_names</span>,sep <span class='op'>=</span> <span class='st'>"_"</span><span class='op'>)</span>, skip <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>step_zv</span><span class='op'>(</span><span class='fu'>all_predictors</span><span class='op'>(</span><span class='op'>)</span>, skip <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='co'># remove any columns with a single unique value</span>
  <span class='fu'>step_nzv</span><span class='op'>(</span><span class='fu'>all_predictors</span><span class='op'>(</span><span class='op'>)</span>, skip <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>
  

<span class='va'>impute_knn_recipe</span> <span class='op'>&lt;-</span> 
  <span class='va'>base_recipe</span> <span class='op'>%&gt;%</span>
  <span class='fu'>step_impute_knn</span><span class='op'>(</span><span class='fu'>all_numeric_predictors</span><span class='op'>(</span><span class='op'>)</span>, skip <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>step_novel</span><span class='op'>(</span><span class='va'>Site.Type</span>, skip <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>step_dummy</span><span class='op'>(</span><span class='va'>Site.Type</span>, one_hot <span class='op'>=</span> <span class='cn'>TRUE</span>, naming <span class='op'>=</span> <span class='fu'>partial</span><span class='op'>(</span><span class='va'>dummy_names</span>,sep <span class='op'>=</span> <span class='st'>"_"</span><span class='op'>)</span>, skip <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>step_zv</span><span class='op'>(</span><span class='fu'>all_predictors</span><span class='op'>(</span><span class='op'>)</span>, skip <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='co'># remove any columns with a single unique value</span>
  <span class='fu'>step_nzv</span><span class='op'>(</span><span class='fu'>all_predictors</span><span class='op'>(</span><span class='op'>)</span>, skip <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span> 
   

<span class='va'>normalize_recipe</span> <span class='op'>&lt;-</span> 
  <span class='va'>base_recipe</span> <span class='op'>%&gt;%</span>
  <span class='fu'>step_impute_linear</span><span class='op'>(</span><span class='fu'>all_numeric_predictors</span><span class='op'>(</span><span class='op'>)</span>, impute_with <span class='op'>=</span> <span class='fu'>imp_vars</span><span class='op'>(</span><span class='va'>Longitude</span>, <span class='va'>Latitude</span><span class='op'>)</span>, skip <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='co'># create linear regression models to impute missing data.</span>
  <span class='fu'>step_novel</span><span class='op'>(</span><span class='va'>Site.Type</span>, skip <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>step_dummy</span><span class='op'>(</span><span class='va'>Site.Type</span>, one_hot <span class='op'>=</span> <span class='cn'>TRUE</span>, naming <span class='op'>=</span> <span class='fu'>partial</span><span class='op'>(</span><span class='va'>dummy_names</span>,sep <span class='op'>=</span> <span class='st'>"_"</span><span class='op'>)</span>, skip <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>step_zv</span><span class='op'>(</span><span class='fu'>all_predictors</span><span class='op'>(</span><span class='op'>)</span>, skip <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='co'># remove any columns with a single unique value</span>
  <span class='fu'>step_nzv</span><span class='op'>(</span><span class='fu'>all_predictors</span><span class='op'>(</span><span class='op'>)</span>, skip <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>step_normalize</span><span class='op'>(</span><span class='fu'>all_numeric_predictors</span><span class='op'>(</span><span class='op'>)</span>, skip <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span> <span class='co'># normalize numeric data: standard deviation of one and a mean of zero.</span>

<span class='va'>rm_corr_recipe</span> <span class='op'>&lt;-</span> 
  <span class='va'>base_recipe</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>step_impute_linear</span><span class='op'>(</span><span class='fu'>all_numeric_predictors</span><span class='op'>(</span><span class='op'>)</span>, impute_with <span class='op'>=</span> <span class='fu'>imp_vars</span><span class='op'>(</span><span class='va'>Longitude</span>, <span class='va'>Latitude</span><span class='op'>)</span>, skip <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='co'># create linear regression models to impute missing data.</span>
  <span class='fu'>step_novel</span><span class='op'>(</span><span class='va'>Site.Type</span>, skip <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>step_dummy</span><span class='op'>(</span><span class='va'>Site.Type</span>, one_hot <span class='op'>=</span> <span class='cn'>TRUE</span>, naming <span class='op'>=</span> <span class='fu'>partial</span><span class='op'>(</span><span class='va'>dummy_names</span>,sep <span class='op'>=</span> <span class='st'>"_"</span><span class='op'>)</span>, skip <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>step_zv</span><span class='op'>(</span><span class='fu'>all_predictors</span><span class='op'>(</span><span class='op'>)</span>, skip <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='co'># remove any columns with a single unique value</span>
  <span class='fu'>step_nzv</span><span class='op'>(</span><span class='fu'>all_predictors</span><span class='op'>(</span><span class='op'>)</span>, skip <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>step_corr</span><span class='op'>(</span><span class='fu'>all_numeric_predictors</span><span class='op'>(</span><span class='op'>)</span>, threshold <span class='op'>=</span> <span class='fl'>0.8</span>, method <span class='op'>=</span> <span class='st'>"pearson"</span>, skip <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>

<span class='va'>interact_recipe</span> <span class='op'>&lt;-</span> 
  <span class='va'>base_recipe</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>step_impute_linear</span><span class='op'>(</span><span class='fu'>all_numeric_predictors</span><span class='op'>(</span><span class='op'>)</span>, impute_with <span class='op'>=</span> <span class='fu'>imp_vars</span><span class='op'>(</span><span class='va'>Longitude</span>, <span class='va'>Latitude</span><span class='op'>)</span>, skip <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='co'># create linear regression models to impute missing data.</span>
  <span class='fu'>step_novel</span><span class='op'>(</span><span class='va'>Site.Type</span>, skip <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>step_dummy</span><span class='op'>(</span><span class='va'>Site.Type</span>, one_hot <span class='op'>=</span> <span class='cn'>TRUE</span>, naming <span class='op'>=</span> <span class='fu'>partial</span><span class='op'>(</span><span class='va'>dummy_names</span>,sep <span class='op'>=</span> <span class='st'>"_"</span><span class='op'>)</span>, skip <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>step_zv</span><span class='op'>(</span><span class='fu'>all_predictors</span><span class='op'>(</span><span class='op'>)</span>, skip <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='co'># remove any columns with a single unique value</span>
  <span class='fu'>step_nzv</span><span class='op'>(</span><span class='fu'>all_predictors</span><span class='op'>(</span><span class='op'>)</span>, skip <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>step_interact</span><span class='op'>(</span><span class='op'>~</span> <span class='fu'>all_numeric_predictors</span><span class='op'>(</span><span class='op'>)</span><span class='op'>:</span><span class='fu'>all_numeric_predictors</span><span class='op'>(</span><span class='op'>)</span>, skip <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p><strong>Note:</strong> To view how the recipe pre-process the data simply pipe it into a prep() function to prepare it, then a juice() function to extract it and then its a good idea to make use of the glimpse() function to easily see each variable.</p>
<h2 id="step-6-defining-model-specifications">STEP 6: Defining model specifications</h2>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>lm_spec</span> <span class='op'>&lt;-</span> <span class='fu'>linear_reg</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>set_mode</span><span class='op'>(</span><span class='st'>"regression"</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>set_engine</span><span class='op'>(</span><span class='st'>"lm"</span><span class='op'>)</span> 

<span class='va'>glm_spec</span> <span class='op'>&lt;-</span> <span class='fu'>linear_reg</span><span class='op'>(</span>
  penalty <span class='op'>=</span> <span class='fu'>tune</span><span class='op'>(</span><span class='op'>)</span>,
  mixture <span class='op'>=</span> <span class='fu'>tune</span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>set_engine</span><span class='op'>(</span><span class='st'>"glmnet"</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>set_mode</span><span class='op'>(</span><span class='st'>"regression"</span><span class='op'>)</span>

<span class='va'>cart_spec</span> <span class='op'>&lt;-</span> 
   <span class='fu'>decision_tree</span><span class='op'>(</span>cost_complexity <span class='op'>=</span> <span class='fu'>tune</span><span class='op'>(</span><span class='op'>)</span>, 
                 min_n <span class='op'>=</span> <span class='fu'>tune</span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
   <span class='fu'>set_engine</span><span class='op'>(</span><span class='st'>"rpart"</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
   <span class='fu'>set_mode</span><span class='op'>(</span><span class='st'>"regression"</span><span class='op'>)</span>

<span class='va'>mars_spec</span> <span class='op'>&lt;-</span> 
   <span class='fu'>mars</span><span class='op'>(</span>prod_degree <span class='op'>=</span> <span class='fu'>tune</span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>  <span class='co'>#&lt;- use GCV to choose terms</span>
   <span class='fu'>set_engine</span><span class='op'>(</span><span class='st'>"earth"</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
   <span class='fu'>set_mode</span><span class='op'>(</span><span class='st'>"regression"</span><span class='op'>)</span>

<span class='va'>knn_spec</span> <span class='op'>&lt;-</span> 
   <span class='fu'>nearest_neighbor</span><span class='op'>(</span>neighbors <span class='op'>=</span> <span class='fu'>tune</span><span class='op'>(</span><span class='op'>)</span>, 
                    weight_func <span class='op'>=</span> <span class='fu'>tune</span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
   <span class='fu'>set_engine</span><span class='op'>(</span><span class='st'>"kknn"</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
   <span class='fu'>set_mode</span><span class='op'>(</span><span class='st'>"regression"</span><span class='op'>)</span>

<span class='va'>svm_p_spec</span> <span class='op'>&lt;-</span> 
   <span class='fu'>svm_poly</span><span class='op'>(</span>cost <span class='op'>=</span> <span class='fu'>tune</span><span class='op'>(</span><span class='op'>)</span>, 
            degree <span class='op'>=</span> <span class='fu'>tune</span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
   <span class='fu'>set_engine</span><span class='op'>(</span><span class='st'>"kernlab"</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
   <span class='fu'>set_mode</span><span class='op'>(</span><span class='st'>"regression"</span><span class='op'>)</span>

<span class='va'>cubist_spec</span> <span class='op'>&lt;-</span> 
   <span class='fu'>cubist_rules</span><span class='op'>(</span>committees <span class='op'>=</span> <span class='fu'>tune</span><span class='op'>(</span><span class='op'>)</span>, 
                neighbors <span class='op'>=</span> <span class='fu'>tune</span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
   <span class='fu'>set_engine</span><span class='op'>(</span><span class='st'>"Cubist"</span><span class='op'>)</span> 

<span class='va'>nnet_spec</span> <span class='op'>&lt;-</span> 
   <span class='fu'>mlp</span><span class='op'>(</span>hidden_units <span class='op'>=</span> <span class='fu'>tune</span><span class='op'>(</span><span class='op'>)</span>, 
       penalty <span class='op'>=</span> <span class='fu'>tune</span><span class='op'>(</span><span class='op'>)</span>, 
       epochs <span class='op'>=</span> <span class='fu'>tune</span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
   <span class='fu'>set_engine</span><span class='op'>(</span><span class='st'>"nnet"</span>, MaxNWts <span class='op'>=</span> <span class='fl'>2600</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
   <span class='fu'>set_mode</span><span class='op'>(</span><span class='st'>"regression"</span><span class='op'>)</span>

<span class='va'>rf_spec</span> <span class='op'>&lt;-</span> 
   <span class='fu'>rand_forest</span><span class='op'>(</span>mtry <span class='op'>=</span> <span class='fu'>tune</span><span class='op'>(</span><span class='op'>)</span>, 
               min_n <span class='op'>=</span> <span class='fu'>tune</span><span class='op'>(</span><span class='op'>)</span>, 
               trees <span class='op'>=</span> <span class='fu'>tune</span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
   <span class='fu'>set_engine</span><span class='op'>(</span><span class='st'>"ranger"</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
   <span class='fu'>set_mode</span><span class='op'>(</span><span class='st'>"regression"</span><span class='op'>)</span>

<span class='va'>xgb_spec</span> <span class='op'>&lt;-</span> 
   <span class='fu'>boost_tree</span><span class='op'>(</span>tree_depth <span class='op'>=</span> <span class='fu'>tune</span><span class='op'>(</span><span class='op'>)</span>, 
              learn_rate <span class='op'>=</span> <span class='fu'>tune</span><span class='op'>(</span><span class='op'>)</span>, 
              loss_reduction <span class='op'>=</span> <span class='fu'>tune</span><span class='op'>(</span><span class='op'>)</span>, 
              min_n <span class='op'>=</span> <span class='fu'>tune</span><span class='op'>(</span><span class='op'>)</span>, 
              sample_size <span class='op'>=</span> <span class='fu'>tune</span><span class='op'>(</span><span class='op'>)</span>, 
              trees <span class='op'>=</span> <span class='fu'>tune</span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
   <span class='fu'>set_engine</span><span class='op'>(</span><span class='st'>"xgboost"</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
   <span class='fu'>set_mode</span><span class='op'>(</span><span class='st'>"regression"</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<h2 id="step-7-integrating-pre-processing-and-model-specification-into-a-workflowset">STEP 7: Integrating pre-processing and model specification into a workflowset</h2>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>wflwset_setup</span> <span class='op'>&lt;-</span> 
   <span class='fu'>workflow_set</span><span class='op'>(</span>
      preproc <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>impute_mean <span class='op'>=</span> <span class='va'>impute_mean_recipe</span>,
                     impute_knn <span class='op'>=</span> <span class='va'>impute_knn_recipe</span>,
                     normalized <span class='op'>=</span> <span class='va'>normalize_recipe</span>,
                     rm_corr <span class='op'>=</span> <span class='va'>rm_corr_recipe</span>,
                     interaction <span class='op'>=</span> <span class='va'>interact_recipe</span><span class='op'>)</span>,
      models <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>lm <span class='op'>=</span> <span class='va'>lm_spec</span>,
                    glm <span class='op'>=</span> <span class='va'>glm_spec</span>, 
                    cart <span class='op'>=</span> <span class='va'>cart_spec</span>, 
                    mars <span class='op'>=</span> <span class='va'>mars_spec</span>,
                    knn <span class='op'>=</span> <span class='va'>knn_spec</span>,
                    svm_p <span class='op'>=</span> <span class='va'>svm_p_spec</span>,
                    cubist <span class='op'>=</span> <span class='va'>cubist_spec</span>,
                    nnet <span class='op'>=</span> <span class='va'>nnet_spec</span>,
                    RF <span class='op'>=</span> <span class='va'>rf_spec</span>,
                    XGB <span class='op'>=</span> <span class='va'>xgb_spec</span><span class='op'>)</span>,
      cross <span class='op'>=</span> <span class='cn'>TRUE</span>
   <span class='op'>)</span>

<span class='fu'><a href='https://rdrr.io/r/base/readRDS.html'>saveRDS</a></span><span class='op'>(</span><span class='va'>wflwset_setup</span>, file <span class='op'>=</span> <span class='fu'>here</span><span class='fu'>::</span><span class='fu'><a href='https://here.r-lib.org//reference/here.html'>here</a></span><span class='op'>(</span><span class='st'>"TidyModWflSet_OUTPUT"</span>, <span class='st'>"wflwset_setup.RDS"</span><span class='op'>)</span><span class='op'>)</span> 
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>wflwset_setup</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/readRDS.html'>readRDS</a></span><span class='op'>(</span><span class='fu'>here</span><span class='fu'>::</span><span class='fu'><a href='https://here.r-lib.org//reference/here.html'>here</a></span><span class='op'>(</span><span class='st'>"TidyModWflSet_OUTPUT"</span>, <span class='st'>"wflwset_setup.RDS"</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>wflwset_setup</span>
</code></pre>
</div>
<pre><code># A workflow set/tibble: 50 × 4
   wflow_id           info             option    result    
   &lt;chr&gt;              &lt;list&gt;           &lt;list&gt;    &lt;list&gt;    
 1 impute_mean_lm     &lt;tibble [1 × 4]&gt; &lt;opts[0]&gt; &lt;list [0]&gt;
 2 impute_mean_glm    &lt;tibble [1 × 4]&gt; &lt;opts[0]&gt; &lt;list [0]&gt;
 3 impute_mean_cart   &lt;tibble [1 × 4]&gt; &lt;opts[0]&gt; &lt;list [0]&gt;
 4 impute_mean_mars   &lt;tibble [1 × 4]&gt; &lt;opts[0]&gt; &lt;list [0]&gt;
 5 impute_mean_knn    &lt;tibble [1 × 4]&gt; &lt;opts[0]&gt; &lt;list [0]&gt;
 6 impute_mean_svm_p  &lt;tibble [1 × 4]&gt; &lt;opts[0]&gt; &lt;list [0]&gt;
 7 impute_mean_cubist &lt;tibble [1 × 4]&gt; &lt;opts[0]&gt; &lt;list [0]&gt;
 8 impute_mean_nnet   &lt;tibble [1 × 4]&gt; &lt;opts[0]&gt; &lt;list [0]&gt;
 9 impute_mean_RF     &lt;tibble [1 × 4]&gt; &lt;opts[0]&gt; &lt;list [0]&gt;
10 impute_mean_XGB    &lt;tibble [1 × 4]&gt; &lt;opts[0]&gt; &lt;list [0]&gt;
# … with 40 more rows</code></pre>
</div>
<p>We see very clearly that a workflowset contains all possible combinations of model specifications and pre-processing steps. A powerful way to test several models on different forms of pre-processing specifications to scan and find the best setup.</p>
<h2 id="step-8-tuning-workflowsets-using-tune_grid-or-tune_race_anova">STEP 8: Tuning workflowsets using tune_grid() or tune_race_anova()</h2>
<p>There are different ways we can tune/fit our workflowsets. The more traditional one is using tune_grid() from the tune package, that is part of tidymodels. With tune_grid() we will compute a set of performance metrics (e.g. MAE or RMSE) for a pre-defined set of tuning parameters that correspond to a model or recipe across one or more resamples of the data. Hence all set combinations of (hyper)-parameters for the models are used to tune the models individually. This can sometimes cause really long and expensive model tuning.</p>
<p>A more effecient alternative to tune_grid() is the tune_race_anova() from the finetune package. Instead of tuning the individual models based on all possible combinations of (hyper)-parameters tune_race_anova() computes a set of performance metrics (e.g. MAE or RMSE) for a pre-defined set of tuning parameters that correspond to a model or recipe across one or more resamples of the data. After an initial number of resamples have been evaluated, the process eliminates tuning parameter combinations that are unlikely to be the best results using a repeated measure ANOVA model. This approach is significantly more efficient, as not all (hyper)-parameter combination will have to be used in the model tuning process, but only the ones that in a step-wise manner improve model performance.</p>
<h3 id="using-tune_grid">Using tune_grid()</h3>
<p><strong>Note:</strong> we are not going to do this because it takes too long</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'>#  # Initializing parallel processing </span>
<span class='co'>#  doParallel::registerDoParallel()</span>
<span class='co'># </span>
<span class='co'># set.seed(123)</span>
<span class='co'># </span>
<span class='co'># wflwset_setup_res &lt;- </span>
<span class='co'>#    wflwset_setup %&gt;% </span>
<span class='co'>#    # The first argument is a function name from the {{tune}} package such as `tune_grid()`, `fit_resamples()`, etc.</span>
<span class='co'>#    workflow_map(fn        = "tune_grid", </span>
<span class='co'>#                 resamples = cv.fold.wf, </span>
<span class='co'>#                 grid      = 5, </span>
<span class='co'>#                 metrics   = multi.metric.wf, </span>
<span class='co'>#                 verbose   = TRUE)</span>
<span class='co'># </span>
<span class='co'># # Terminating parallel session</span>
<span class='co'># parallelStop()</span>
</code></pre>
</div>
</div>
<h3 id="using-tune_race_anova">Using tune_race_anova()</h3>
<p><strong>Note:</strong> More than 50 model-pre-processing combinations have to be tuned. This tuning takes about 5 hours with a normal 8 CPU computer - even when running in parallel.</p>
<p>The tune_race_anove() uses an innovative method to speed up the tuning of machine learning models. tune_race_anova() computes a set of performance metrics (e.g. accuracy or RMSE) for a pre-defined set of tuning parameters that correspond to a model or recipe across one or more resamples of the data. After an initial number of resamples have been evaluated, the process eliminates tuning parameter combinations that are unlikely to be the best results using a repeated measure ANOVA model.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>race_ctrl</span> <span class='op'>&lt;-</span>
   <span class='fu'>control_race</span><span class='op'>(</span>
      save_pred <span class='op'>=</span> <span class='cn'>TRUE</span>,
      parallel_over <span class='op'>=</span> <span class='st'>"everything"</span>,
      save_workflow <span class='op'>=</span> <span class='cn'>TRUE</span>
   <span class='op'>)</span>

 <span class='co'># Initializing parallel processing </span>
 <span class='fu'>doParallel</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/doParallel/man/registerDoParallel.html'>registerDoParallel</a></span><span class='op'>(</span><span class='op'>)</span>

<span class='va'>wflwset_setup_race_results</span> <span class='op'>&lt;-</span>
   <span class='va'>wflwset_setup</span> <span class='op'>%&gt;%</span>
   <span class='fu'>workflow_map</span><span class='op'>(</span>fn        <span class='op'>=</span> <span class='st'>"tune_race_anova"</span>, 
                seed      <span class='op'>=</span> <span class='fl'>1503</span>,
                resamples <span class='op'>=</span> <span class='va'>cv.fold.wf</span>, 
                metrics   <span class='op'>=</span> <span class='va'>multi.metric.wf</span>, 
                verbose   <span class='op'>=</span> <span class='cn'>TRUE</span>, 
                grid      <span class='op'>=</span> <span class='fl'>5</span>,
                control   <span class='op'>=</span> <span class='va'>race_ctrl</span>
   <span class='op'>)</span>

<span class='co'># Terminating parallel session</span>
<span class='fu'>parallelStop</span><span class='op'>(</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p>There are some model - pre-processing combinations that do not successfully manage to get tuned:</p>
<p>i 46 of 50 tuning: interaction_svm_p Warning in mclapply(argsList, FUN, mc.preschedule = preschedule, mc.set.seed = set.seed, : scheduled core 2 did not deliver a result, all values of the job will be affected x 46 of 50 tuning: interaction_svm_p failed with: Error in <code>contrasts&lt;-</code>(<code>*tmp*</code>, value = contr.funs[1 + isOF[nn]]) : contrasts can be applied only to factors with 2 or more levels i 47 of 50 tuning: interaction_cubist ✓ 47 of 50 tuning: interaction_cubist (21m 26s) i 48 of 50 tuning: interaction_nnet x 48 of 50 tuning: interaction_nnet failed with: Error in <code>contrasts&lt;-</code>(<code>*tmp*</code>, value = contr.funs[1 + isOF[nn]]) : contrasts can be applied only to factors with 2 or more levels i 49 of 50 tuning: interaction_RF i Creating pre-processing data to finalize unknown parameter: mtry ✓ 49 of 50 tuning: interaction_RF (1h 33m 57.8s) i 50 of 50 tuning: interaction_XGB ✓ 50 of 50 tuning: interaction_XGB (31m 33.5s)</p>
<p>We will have to delete these from the output.</p>
<h3 id="saving-the-workflowset-tuning-results">SAVING THE WORKFLOWSET TUNING RESULTS</h3>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># SAVING MODEL TUNING RESULTS</span>
<span class='fu'><a href='https://rdrr.io/r/base/readRDS.html'>saveRDS</a></span><span class='op'>(</span><span class='va'>wflwset_setup_race_results</span>, <span class='fu'>here</span><span class='fu'>::</span><span class='fu'><a href='https://here.r-lib.org//reference/here.html'>here</a></span><span class='op'>(</span><span class='st'>"TidyModWflSet_OUTPUT"</span>,<span class='st'>"wflwset_setup_race_results.RDS"</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
</details>
</div>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># SAVING MODEL TUNING RESULTS</span>
<span class='fu'><a href='https://rdrr.io/r/base/readRDS.html'>saveRDS</a></span><span class='op'>(</span><span class='va'>wflwset_setup_race_results</span>, <span class='fu'>here</span><span class='fu'>::</span><span class='fu'><a href='https://here.r-lib.org//reference/here.html'>here</a></span><span class='op'>(</span><span class='st'>"TidyModWflSet_OUTPUT"</span>,<span class='st'>"wflwset_setup_race_results.RDS"</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
</details>
</div>
<h2 id="step-9-assessing-results-of-the-tuned-workflowsets">STEP 9: Assessing results of the tuned workflowsets</h2>
<h3 id="from-tune_grid">From tune_grid()</h3>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># -------------------------------------------------------------------</span>
<span class='co'># LOAD THE TUNED (tune_race_anova) WORKFLOWSET DATA</span>

<span class='va'>wflwset_setup_race_results</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/readRDS.html'>readRDS</a></span><span class='op'>(</span><span class='fu'>here</span><span class='fu'>::</span><span class='fu'><a href='https://here.r-lib.org//reference/here.html'>here</a></span><span class='op'>(</span><span class='st'>"TidyModWflSet_OUTPUT"</span>, <span class='st'>"wflwset_setup_race_results.RDS"</span><span class='op'>)</span><span class='op'>)</span>
<span class='co'>#Error: There were 1 workflows that had no results.</span>

<span class='co'># Removing the result that caused the error for not having a result</span>

<span class='va'>wflwset_setup_race_results_clean</span> <span class='op'>&lt;-</span> <span class='va'>wflwset_setup_race_results</span> <span class='op'>%&gt;%</span>
  <span class='fu'>dplyr</span><span class='fu'>::</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>wflow_id</span> <span class='op'>!=</span> <span class='st'>"interaction_svm_p"</span><span class='op'>)</span>  <span class='op'>%&gt;%</span>
  <span class='fu'>dplyr</span><span class='fu'>::</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>wflow_id</span> <span class='op'>!=</span> <span class='st'>"interaction_nnet"</span><span class='op'>)</span> 

<span class='fu'><a href='https://rdrr.io/r/base/readRDS.html'>saveRDS</a></span><span class='op'>(</span><span class='va'>wflwset_setup_race_results_clean</span>, <span class='fu'>here</span><span class='fu'>::</span><span class='fu'><a href='https://here.r-lib.org//reference/here.html'>here</a></span><span class='op'>(</span><span class='st'>"TidyModWflSet_OUTPUT"</span>,<span class='st'>"wflwset_setup_race_results_clean.RDS"</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
</details>
</div>
<div class="layout-chunk" data-layout="l-screen-inset shaded">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># -------------------------------------------------------------------</span>
<span class='va'>wflwset_setup_race_results_clean</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/readRDS.html'>readRDS</a></span><span class='op'>(</span><span class='fu'>here</span><span class='fu'>::</span><span class='fu'><a href='https://here.r-lib.org//reference/here.html'>here</a></span><span class='op'>(</span><span class='st'>"TidyModWflSet_OUTPUT"</span>, <span class='st'>"wflwset_setup_race_results_clean.RDS"</span><span class='op'>)</span><span class='op'>)</span>

<span class='fu'>autoplot</span><span class='op'>(</span><span class='va'>wflwset_setup_race_results_clean</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-1"></span>
<img src="TIDYMODELSWFS_files/figure-html5/unnamed-chunk-1-1.png" alt="Results of the tune race anova workflowset tuning" width="768" />
<p class="caption">
Figure 1: Results of the tune race anova workflowset tuning
</p>
</div>
</div>
<div class="layout-chunk" data-layout="l-screen-inset shaded">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>wflwset_setup_race_results_clean_no_linear</span> <span class='op'>&lt;-</span> <span class='va'>wflwset_setup_race_results_clean</span> <span class='op'>%&gt;%</span>
  <span class='fu'>dplyr</span><span class='fu'>::</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='op'>!</span><span class='fu'>str_detect</span><span class='op'>(</span><span class='va'>wflow_id</span>, <span class='st'>"_lm"</span><span class='op'>)</span><span class='op'>)</span>

<span class='fu'>autoplot</span><span class='op'>(</span><span class='va'>wflwset_setup_race_results_clean_no_linear</span><span class='op'>)</span> 
</code></pre>
</div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-2"></span>
<img src="TIDYMODELSWFS_files/figure-html5/unnamed-chunk-2-1.png" alt="Results of the tune race anova workflowset tuning after lm models have been excluded" width="768" />
<p class="caption">
Figure 2: Results of the tune race anova workflowset tuning after lm models have been excluded
</p>
</div>
</div>
<h3 id="ranking-workflowsets-results-from-model-pre-processing-combinations">Ranking Workflowsets results from model-pre-processing combinations</h3>
<p>First removing the linear models, that seems unrealistically poor in predicting the response ratios. The ranking is done for the two metrics; RMSE and CCC</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>rank_results</span><span class='op'>(</span><span class='va'>wflwset_setup_race_results_clean_no_linear</span>, 
             rank_metric <span class='op'>=</span> <span class='st'>"rmse"</span>, 
             select_best <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>select</span><span class='op'>(</span><span class='va'>rank</span>, <span class='va'>mean</span>, <span class='va'>model</span>, <span class='va'>wflow_id</span>, <span class='va'>.config</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>arrange</span><span class='op'>(</span><span class='fu'>desc</span><span class='op'>(</span><span class='op'>-</span><span class='va'>rank</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code># A tibble: 172 × 5
    rank  mean model       wflow_id       .config             
   &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;       &lt;chr&gt;          &lt;chr&gt;               
 1     1 0.539 rand_forest normalized_RF  Preprocessor1_Model5
 2     1 0.430 rand_forest normalized_RF  Preprocessor1_Model5
 3     1 0.588 rand_forest normalized_RF  Preprocessor1_Model5
 4     1 0.365 rand_forest normalized_RF  Preprocessor1_Model5
 5     2 0.539 rand_forest rm_corr_RF     Preprocessor1_Model5
 6     2 0.430 rand_forest rm_corr_RF     Preprocessor1_Model5
 7     2 0.588 rand_forest rm_corr_RF     Preprocessor1_Model5
 8     2 0.365 rand_forest rm_corr_RF     Preprocessor1_Model5
 9     3 0.537 rand_forest interaction_RF Preprocessor1_Model2
10     3 0.430 rand_forest interaction_RF Preprocessor1_Model2
# … with 162 more rows</code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>rank_results</span><span class='op'>(</span><span class='va'>wflwset_setup_race_results_clean_no_linear</span>, 
             rank_metric <span class='op'>=</span> <span class='st'>"ccc"</span>, 
             select_best <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>select</span><span class='op'>(</span><span class='va'>rank</span>, <span class='va'>mean</span>, <span class='va'>model</span>, <span class='va'>wflow_id</span>, <span class='va'>.config</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>arrange</span><span class='op'>(</span><span class='fu'>desc</span><span class='op'>(</span><span class='op'>-</span><span class='va'>rank</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code># A tibble: 172 × 5
    rank  mean model         wflow_id        .config             
   &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;         &lt;chr&gt;           &lt;chr&gt;               
 1     1 0.541 decision_tree normalized_cart Preprocessor1_Model2
 2     1 0.430 decision_tree normalized_cart Preprocessor1_Model2
 3     1 0.590 decision_tree normalized_cart Preprocessor1_Model2
 4     1 0.363 decision_tree normalized_cart Preprocessor1_Model2
 5     2 0.541 decision_tree rm_corr_cart    Preprocessor1_Model2
 6     2 0.430 decision_tree rm_corr_cart    Preprocessor1_Model2
 7     2 0.590 decision_tree rm_corr_cart    Preprocessor1_Model2
 8     2 0.362 decision_tree rm_corr_cart    Preprocessor1_Model2
 9     3 0.540 rand_forest   normalized_RF   Preprocessor1_Model4
10     3 0.430 rand_forest   normalized_RF   Preprocessor1_Model4
# … with 162 more rows</code></pre>
</div>
<h2 id="step-10-finalizing-models">STEP 10: Finalizing models</h2>
<p>Similar to what we went through in Part 3: Analysing with Tidymodels, we also have to finalize the models from the tuning results using the best performing (hyper)-parameter configurations. We are going to do this last fitting of the models using the training set. The first step is to pick a workflow to finalize. Since Random Forest models (RF), boosted tree models (XGB), decision tree models (cart) and generalized linear models (glm) worked well, we’ll extract the best configurations from the sets, update the parameters with the numerically best settings, and fit to the training set.</p>
<h3 id="extracting-best-performing-model-hyper-parameter-configurations">Extracting best performing model (hyper)-parameter configurations</h3>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>rf_wf_best_rmse_results_of_race</span> <span class='op'>&lt;-</span> 
   <span class='va'>wflwset_setup_race_results_clean</span> <span class='op'>%&gt;%</span> 
   <span class='fu'>extract_workflow_set_result</span><span class='op'>(</span><span class='st'>"normalized_RF"</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
   <span class='fu'>select_best</span><span class='op'>(</span>metric <span class='op'>=</span> <span class='st'>"rmse"</span><span class='op'>)</span>

<span class='va'>xgb_wf_best_rmse_results_of_race</span> <span class='op'>&lt;-</span> 
   <span class='va'>wflwset_setup_race_results_clean</span> <span class='op'>%&gt;%</span> 
   <span class='fu'>extract_workflow_set_result</span><span class='op'>(</span><span class='st'>"interaction_XGB"</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
   <span class='fu'>select_best</span><span class='op'>(</span>metric <span class='op'>=</span> <span class='st'>"rmse"</span><span class='op'>)</span>

<span class='va'>cart_wf_best_rmse_results_of_race</span> <span class='op'>&lt;-</span> 
   <span class='va'>wflwset_setup_race_results_clean</span> <span class='op'>%&gt;%</span> 
   <span class='fu'>extract_workflow_set_result</span><span class='op'>(</span><span class='st'>"rm_corr_cart"</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
   <span class='fu'>select_best</span><span class='op'>(</span>metric <span class='op'>=</span> <span class='st'>"rmse"</span><span class='op'>)</span>

<span class='va'>glm_wf_best_rmse_results_of_race</span> <span class='op'>&lt;-</span> 
   <span class='va'>wflwset_setup_race_results_clean</span> <span class='op'>%&gt;%</span> 
   <span class='fu'>extract_workflow_set_result</span><span class='op'>(</span><span class='st'>"interaction_glm"</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
   <span class='fu'>select_best</span><span class='op'>(</span>metric <span class='op'>=</span> <span class='st'>"rmse"</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<h3 id="saving-best-performing-models">Saving best performing models</h3>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># SAVING THE BEST PERFORMING MODEL CONFIGURATIONS</span>

<span class='fu'><a href='https://rdrr.io/r/base/readRDS.html'>saveRDS</a></span><span class='op'>(</span><span class='va'>rf_wf_best_rmse_results_of_race</span>, <span class='fu'>here</span><span class='fu'>::</span><span class='fu'><a href='https://here.r-lib.org//reference/here.html'>here</a></span><span class='op'>(</span><span class='st'>"TidyModWflSet_OUTPUT"</span>,<span class='st'>"rf_wf_best_rmse_results_of_race.RDS"</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/readRDS.html'>saveRDS</a></span><span class='op'>(</span><span class='va'>xgb_wf_best_rmse_results_of_race</span>, <span class='fu'>here</span><span class='fu'>::</span><span class='fu'><a href='https://here.r-lib.org//reference/here.html'>here</a></span><span class='op'>(</span><span class='st'>"TidyModWflSet_OUTPUT"</span>,<span class='st'>"xgb_wf_best_rmse_results_of_race.RDS"</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/readRDS.html'>saveRDS</a></span><span class='op'>(</span><span class='va'>cart_wf_best_rmse_results_of_race</span>, <span class='fu'>here</span><span class='fu'>::</span><span class='fu'><a href='https://here.r-lib.org//reference/here.html'>here</a></span><span class='op'>(</span><span class='st'>"TidyModWflSet_OUTPUT"</span>,<span class='st'>"cart_wf_best_rmse_results_of_race.RDS"</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/readRDS.html'>saveRDS</a></span><span class='op'>(</span><span class='va'>glm_wf_best_rmse_results_of_race</span>, <span class='fu'>here</span><span class='fu'>::</span><span class='fu'><a href='https://here.r-lib.org//reference/here.html'>here</a></span><span class='op'>(</span><span class='st'>"TidyModWflSet_OUTPUT"</span>,<span class='st'>"glm_wf_best_rmse_results_of_race.RDS"</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
</details>
</div>
<h3 id="performing-last-fitting-on-the-whole-dataset-traningset-testingset">Performing last fitting on the whole dataset (traningset + testingset)</h3>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>rf_best_race_last_fit</span> <span class='op'>&lt;-</span> 
   <span class='va'>wflwset_setup_race_results_clean</span> <span class='op'>%&gt;%</span> 
   <span class='fu'>extract_workflow</span><span class='op'>(</span><span class='st'>"normalized_RF"</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
   <span class='fu'>finalize_workflow</span><span class='op'>(</span><span class='va'>rf_wf_best_rmse_results_of_race</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
   <span class='fu'>last_fit</span><span class='op'>(</span>split <span class='op'>=</span> <span class='va'>af.split.wf</span><span class='op'>)</span>

<span class='va'>xgb_best_race_last_fit</span> <span class='op'>&lt;-</span> 
   <span class='va'>wflwset_setup_race_results_clean</span> <span class='op'>%&gt;%</span> 
   <span class='fu'>extract_workflow</span><span class='op'>(</span><span class='st'>"interaction_XGB"</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
   <span class='fu'>finalize_workflow</span><span class='op'>(</span><span class='va'>xgb_wf_best_rmse_results_of_race</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
   <span class='fu'>last_fit</span><span class='op'>(</span>split <span class='op'>=</span> <span class='va'>af.split.wf</span><span class='op'>)</span>

<span class='va'>cart_best_race_last_fit</span> <span class='op'>&lt;-</span> 
   <span class='va'>wflwset_setup_race_results_clean</span> <span class='op'>%&gt;%</span> 
   <span class='fu'>extract_workflow</span><span class='op'>(</span><span class='st'>"rm_corr_cart"</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
   <span class='fu'>finalize_workflow</span><span class='op'>(</span><span class='va'>cart_wf_best_rmse_results_of_race</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
   <span class='fu'>last_fit</span><span class='op'>(</span>split <span class='op'>=</span> <span class='va'>af.split.wf</span><span class='op'>)</span>

<span class='va'>glm_best_race_last_fit</span> <span class='op'>&lt;-</span> 
   <span class='va'>wflwset_setup_race_results_clean</span> <span class='op'>%&gt;%</span> 
   <span class='fu'>extract_workflow</span><span class='op'>(</span><span class='st'>"interaction_glm"</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
   <span class='fu'>finalize_workflow</span><span class='op'>(</span><span class='va'>glm_wf_best_rmse_results_of_race</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
   <span class='fu'>last_fit</span><span class='op'>(</span>split <span class='op'>=</span> <span class='va'>af.split.wf</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<h3 id="saving-last-fitting-results-of-models">Saving last fitting results of models</h3>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># SAVING THE BEST PERFORMING MODEL CONFIGURATIONS</span>

<span class='fu'><a href='https://rdrr.io/r/base/readRDS.html'>saveRDS</a></span><span class='op'>(</span><span class='va'>rf_best_race_last_fit</span>, <span class='fu'>here</span><span class='fu'>::</span><span class='fu'><a href='https://here.r-lib.org//reference/here.html'>here</a></span><span class='op'>(</span><span class='st'>"TidyModWflSet_OUTPUT"</span>,<span class='st'>"rf_best_race_last_fit.RDS"</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/readRDS.html'>saveRDS</a></span><span class='op'>(</span><span class='va'>xgb_best_race_last_fit</span>, <span class='fu'>here</span><span class='fu'>::</span><span class='fu'><a href='https://here.r-lib.org//reference/here.html'>here</a></span><span class='op'>(</span><span class='st'>"TidyModWflSet_OUTPUT"</span>,<span class='st'>"xgb_best_race_last_fit.RDS"</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/readRDS.html'>saveRDS</a></span><span class='op'>(</span><span class='va'>cart_best_race_last_fit</span>, <span class='fu'>here</span><span class='fu'>::</span><span class='fu'><a href='https://here.r-lib.org//reference/here.html'>here</a></span><span class='op'>(</span><span class='st'>"TidyModWflSet_OUTPUT"</span>,<span class='st'>"cart_best_race_last_fit.RDS"</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/readRDS.html'>saveRDS</a></span><span class='op'>(</span><span class='va'>glm_best_race_last_fit</span>, <span class='fu'>here</span><span class='fu'>::</span><span class='fu'><a href='https://here.r-lib.org//reference/here.html'>here</a></span><span class='op'>(</span><span class='st'>"TidyModWflSet_OUTPUT"</span>,<span class='st'>"glm_best_race_last_fit.RDS"</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
</details>
</div>
<h2 id="step-11-assessingevaluating-model-performance">STEP 11: Assessing/evaluating model performance</h2>
<h3 id="viewing-the-performance-of-the-random-forest-model-for-rmse-and-rsq">Viewing the performance of the Random Forest model for RMSE and rsq</h3>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>rf_best_race_last_fit</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/readRDS.html'>readRDS</a></span><span class='op'>(</span><span class='fu'>here</span><span class='fu'>::</span><span class='fu'><a href='https://here.r-lib.org//reference/here.html'>here</a></span><span class='op'>(</span><span class='st'>"TidyModWflSet_OUTPUT"</span>, <span class='st'>"rf_best_race_last_fit.RDS"</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'>collect_metrics</span><span class='op'>(</span><span class='va'>rf_best_race_last_fit</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<pre><code># A tibble: 2 × 4
  .metric .estimator .estimate .config             
  &lt;chr&gt;   &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt;               
1 rmse    standard       0.600 Preprocessor1_Model1
2 rsq     standard       0.393 Preprocessor1_Model1</code></pre>
</div>
<h3 id="contructing-predicted-vs-observed-plot-for-the-random-forest">Contructing predicted vs observed plot for the Random Forest</h3>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>rf_wflowset_last_fit_plot</span> <span class='op'>&lt;-</span> 
  <span class='va'>rf_best_race_last_fit</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>collect_predictions</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>ggplot</span><span class='op'>(</span><span class='fu'>aes</span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>logRR</span>, y <span class='op'>=</span> <span class='va'>.pred</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span> 
  <span class='fu'>geom_abline</span><span class='op'>(</span>col <span class='op'>=</span> <span class='st'>"red"</span>, lty <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span> <span class='op'>+</span> 
  <span class='co'>#geom_smooth(method = "gam", linetype = "dashed", col = "black", size = 1) +</span>
  <span class='fu'>geom_jitter</span><span class='op'>(</span>width <span class='op'>=</span> <span class='fl'>0.5</span>, height <span class='op'>=</span> <span class='fl'>0.2</span>, alpha <span class='op'>=</span> <span class='fl'>0.5</span><span class='op'>)</span> <span class='op'>+</span> 
  <span class='fu'>coord_obs_pred</span><span class='op'>(</span>ratio <span class='op'>=</span> <span class='fl'>1.2</span><span class='op'>)</span> <span class='op'>+</span> 
  <span class='fu'>labs</span><span class='op'>(</span>x <span class='op'>=</span> <span class='st'>"Observed RR (log scale)"</span>, y <span class='op'>=</span> <span class='st'>"Predicted RR (log scale)"</span><span class='op'>)</span>
</code></pre>
</div>
</details>
</div>
<div class="layout-chunk" data-layout="l-screen-inset shaded">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>rf_wflowset_last_fit_plot</span>
</code></pre>
</div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-3"></span>
<img src="TIDYMODELSWFS_files/figure-html5/unnamed-chunk-3-1.png" alt="Prediccted vs observed for the Random Forest model" width="960" />
<p class="caption">
Figure 3: Prediccted vs observed for the Random Forest model
</p>
</div>
</div>
<h3 id="listing-some-predicted-vs-observed-values-of-response-ratios">Listing some predicted vs observed values of response ratios</h3>
<div class="layout-chunk" data-layout="l-body-outset">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>rmarkdown</span><span class='fu'>::</span><span class='fu'><a href='https://pkgs.rstudio.com/rmarkdown/reference/paged_table.html'>paged_table</a></span><span class='op'>(</span>
  
<span class='va'>rf_best_race_last_fit</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>collect_predictions</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>arrange</span><span class='op'>(</span><span class='fu'>desc</span><span class='op'>(</span><span class='va'>.pred</span><span class='op'>)</span><span class='op'>)</span>

<span class='op'>)</span>
</code></pre>
</div>
</details>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["id"],"name":[1],"type":["chr"],"align":["left"]},{"label":[".pred"],"name":[2],"type":["dbl"],"align":["right"]},{"label":[".row"],"name":[3],"type":["int"],"align":["right"]},{"label":["logRR"],"name":[4],"type":["dbl"],"align":["right"]},{"label":[".config"],"name":[5],"type":["chr"],"align":["left"]}],"data":[{"1":"train/test split","2":"2.05677918","3":"1276","4":"2.2288376328","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"2.05677918","3":"1284","4":"2.2663820443","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"2.05677918","3":"1289","4":"1.7763151468","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"1.75510902","3":"1638","4":"2.0804531756","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"1.75510902","3":"1641","4":"2.0722291839","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"1.75510902","3":"1674","4":"1.5581446180","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"1.75124885","3":"301","4":"0.6986534655","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"1.75124885","3":"302","4":"2.1271845853","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"1.75124885","3":"305","4":"2.5581532148","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"1.75124885","3":"308","4":"1.9366207186","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"1.56598616","3":"1138","4":"1.4593194961","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"1.56598616","3":"1139","4":"1.2130226398","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"1.56598616","3":"1140","4":"1.1948403208","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"1.56598616","3":"1141","4":"1.3397743455","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"1.53372371","3":"1263","4":"1.9787980159","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"1.53372371","3":"1264","4":"2.0359564297","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"1.43029347","3":"1637","4":"0.7516906362","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"1.32647826","3":"3329","4":"0.7070255837","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"1.32647826","3":"3331","4":"0.7526751106","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"1.32647826","3":"3332","4":"0.9156694209","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"1.32647826","3":"3337","4":"1.7917594692","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"1.32647826","3":"3338","4":"2.0602182168","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"1.27832066","3":"1057","4":"1.3545456628","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"1.27832066","3":"1058","4":"1.5040773968","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"1.27832066","3":"1061","4":"1.1786549963","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"1.27832066","3":"1063","4":"1.2809338455","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"1.27832066","3":"1087","4":"2.0794415417","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"1.27832066","3":"1088","4":"1.7635885923","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"1.27547316","3":"1632","4":"1.0032566326","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"1.27547316","3":"1633","4":"0.9347638862","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"1.25414139","3":"447","4":"1.6671170240","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"1.25414139","3":"456","4":"1.4853852638","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"1.25414139","3":"459","4":"1.6045874583","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"1.25414139","3":"463","4":"0.8629797258","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"1.25414139","3":"466","4":"0.8283219589","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"1.25414139","3":"467","4":"1.6843392206","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"1.25414139","3":"470","4":"1.5518087996","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"1.25414139","3":"471","4":"1.7147984281","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"1.25414139","3":"472","4":"1.4328143768","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"1.17567593","3":"2382","4":"0.4595323294","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"1.05173969","3":"4341","4":"1.7917594692","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"1.05173969","3":"4344","4":"0.4924764851","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"1.02598645","3":"430","4":"0.2049097862","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"1.02598645","3":"434","4":"2.0200667771","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"1.02598645","3":"435","4":"0.8431181260","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"1.02598645","3":"444","4":"0.8329091229","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"1.01536553","3":"1163","4":"0.4855078158","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.92668407","3":"1268","4":"1.1786549963","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.92507599","3":"69","4":"-0.1851339331","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.92507599","3":"74","4":"1.1078961750","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.92507599","3":"85","4":"1.7208008805","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.92507599","3":"88","4":"1.7644608367","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.92507599","3":"107","4":"1.0043016092","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.92507599","3":"118","4":"0.4325670379","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.92507599","3":"128","4":"0.9230857750","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.92507599","3":"130","4":"0.7183939633","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.92507599","3":"135","4":"1.3147135574","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.92507599","3":"145","4":"1.4407542783","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.92507599","3":"159","4":"1.0543572797","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.92507599","3":"162","4":"1.2039728043","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.92507599","3":"167","4":"0.0882461991","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.92507599","3":"168","4":"0.2619984777","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.92507599","3":"171","4":"0.3464667673","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.92507599","3":"173","4":"0.1566861197","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.92507599","3":"181","4":"-0.1728428128","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.92507599","3":"194","4":"-0.4451815193","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.92507599","3":"197","4":"-0.0093897403","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.92507599","3":"200","4":"1.2459370034","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.92507599","3":"201","4":"1.3270328971","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.92507599","3":"207","4":"1.3437347467","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.92507599","3":"209","4":"1.2333250163","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.92507599","3":"210","4":"1.3665981111","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.92507599","3":"228","4":"1.2031850926","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.92507599","3":"234","4":"1.3839330849","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.92507599","3":"239","4":"0.6697998166","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.92507599","3":"248","4":"0.3323675618","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.92507599","3":"251","4":"1.4762775085","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.92507599","3":"259","4":"1.8942991085","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.92507599","3":"260","4":"1.9519282214","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.92507599","3":"261","4":"1.7947312396","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.92507599","3":"264","4":"0.2811673914","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.92507599","3":"267","4":"0.0611544232","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.92507599","3":"268","4":"0.3285040670","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.92507599","3":"269","4":"0.4146817632","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.92507599","3":"279","4":"2.1507045617","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.92507599","3":"280","4":"2.2384505307","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.92507599","3":"281","4":"2.0564520235","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.92507599","3":"293","4":"0.4081141163","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.92507599","3":"295","4":"0.0255165954","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.92507599","3":"297","4":"0.0058309203","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.92507599","3":"1536","4":"-0.5933967778","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.92507599","3":"1537","4":"0.8449531934","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.92507599","3":"1546","4":"0.9985288301","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.92507599","3":"1547","4":"0.5108256238","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.92507599","3":"1571","4":"0.2608540704","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.92507599","3":"1583","4":"1.4180430594","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.92507599","3":"1587","4":"0.4182485477","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.92507599","3":"1590","4":"0.3968257455","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.92507599","3":"1592","4":"0.9628107475","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.92507599","3":"1594","4":"1.0933072364","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.92507599","3":"1596","4":"0.4886154764","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.92507599","3":"1602","4":"1.4845446386","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.92507599","3":"1613","4":"0.5886769387","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.92507599","3":"1615","4":"0.4609237307","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.92507599","3":"1618","4":"1.1361661086","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.92507599","3":"2848","4":"-0.2533144289","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.92507599","3":"2865","4":"-0.2929871247","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.92507599","3":"2867","4":"0.3946541920","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.92507599","3":"2869","4":"0.2682639866","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.92507599","3":"2870","4":"0.4353180713","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.92507599","3":"2880","4":"0.6855885656","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.88773794","3":"4226","4":"2.9618307219","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.88773794","3":"4231","4":"2.4567357728","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.88773794","3":"4233","4":"1.0159205728","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.88773794","3":"4236","4":"0.7869659358","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.88773794","3":"4239","4":"1.6739764336","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.88773794","3":"4240","4":"1.8588987721","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.88773794","3":"4249","4":"0.1726127427","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.88773794","3":"4254","4":"0.6860800133","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.88773794","3":"4256","4":"0.7871761302","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.88773794","3":"4257","4":"0.7071334225","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.88773794","3":"4266","4":"0.1520162073","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.88773794","3":"4267","4":"0.4004775666","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.88773794","3":"4278","4":"0.0173917427","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.82378085","3":"2166","4":"-0.0727593543","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.82378085","3":"2170","4":"0.3391306343","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.82378085","3":"2177","4":"0.3908663087","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.81110983","3":"1097","4":"0.8873031950","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.81110983","3":"1099","4":"1.1451323043","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.81110983","3":"1108","4":"1.4271163556","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.81110983","3":"1110","4":"1.0414538748","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.81110983","3":"2517","4":"0.6931471806","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.81110983","3":"2518","4":"0.6931471806","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.81110983","3":"2526","4":"0.3908663087","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.81110983","3":"2532","4":"1.5040773968","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.81110983","3":"2533","4":"1.2762934659","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.81110983","3":"2538","4":"1.3173014896","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.80274838","3":"3345","4":"1.3913152922","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.80274838","3":"3348","4":"-0.0194460575","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.80274838","3":"3352","4":"0.4031267072","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.80274838","3":"3357","4":"1.2862636382","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.80274838","3":"3361","4":"0.3762232585","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.80274838","3":"3362","4":"1.0544333253","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.80274838","3":"3365","4":"0.2725935637","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.80274838","3":"3366","4":"1.2515617671","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.80274838","3":"3370","4":"1.8589247978","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.80274838","3":"3371","4":"0.5016032383","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.80274838","3":"3372","4":"1.1650883710","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.80274838","3":"3373","4":"-0.0274074122","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.80274838","3":"3377","4":"0.3120631284","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.77425105","3":"4115","4":"0.7221347174","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.77425105","3":"4130","4":"0.5972270587","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.77425105","3":"4131","4":"0.7164582594","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.77425105","3":"4133","4":"1.5074387445","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.74266019","3":"1560","4":"0.9409833445","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.72605594","3":"1715","4":"1.8215349242","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.71478739","3":"2059","4":"0.5358822036","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.71478739","3":"2069","4":"1.1472199877","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.71194298","3":"4357","4":"-0.0280244137","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.71194298","3":"4359","4":"0.6008740338","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.69581310","3":"4083","4":"0.4248831940","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.69581310","3":"4091","4":"0.3285040670","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.69581310","3":"4093","4":"0.0870113770","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.69581310","3":"4107","4":"0.6131044729","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.69581310","3":"4113","4":"0.6931471806","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.69089767","3":"2193","4":"0.7847738489","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.68543532","3":"4413","4":"0.9162907319","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.68543532","3":"4415","4":"0.9555114450","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.68543532","3":"4421","4":"0.9162907319","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.68543532","3":"4426","4":"0.4054651081","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.68543532","3":"4433","4":"0.5798184953","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.68543532","3":"4438","4":"0.5260930959","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.68543532","3":"4444","4":"0.5533852382","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.68543532","3":"4446","4":"0.5533852382","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.68543532","3":"4449","4":"0.6711682738","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.68543532","3":"4455","4":"0.8056251640","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.65485000","3":"4518","4":"0.4022498663","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.65485000","3":"4519","4":"0.5417038525","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.63193159","3":"2887","4":"0.2677843319","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.63193159","3":"2889","4":"1.1431786766","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.61154111","3":"4407","4":"0.8661663447","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.57646278","3":"3","4":"1.0600754978","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.57646278","3":"4","4":"1.2461927516","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.57646278","3":"9","4":"0.9738727032","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.57646278","3":"12","4":"0.2602830983","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.57646278","3":"13","4":"0.5923783424","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.56751982","3":"25","4":"0.5415797242","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.56751982","3":"30","4":"0.2483907721","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.56751982","3":"709","4":"1.8601433273","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.56751982","3":"710","4":"1.8298379778","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.56751982","3":"716","4":"0.6740585840","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.56751982","3":"719","4":"0.3966544784","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.56751982","3":"721","4":"0.2142546039","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.56751982","3":"723","4":"0.4316674805","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.56751982","3":"729","4":"0.3757893400","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.56751982","3":"739","4":"0.5872137631","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.56751982","3":"741","4":"0.5862840350","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.56751982","3":"742","4":"0.7457909140","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.56751982","3":"744","4":"0.2767530019","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.56751982","3":"745","4":"0.2966992661","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.56751982","3":"750","4":"0.5848300709","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.56751982","3":"753","4":"0.2835526791","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.56751982","3":"754","4":"0.3080770690","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.56751982","3":"759","4":"0.7417397358","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.56751982","3":"761","4":"0.8287511128","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.56751982","3":"766","4":"0.3881649399","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.56751982","3":"781","4":"0.2363887781","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.56751982","3":"783","4":"0.6835777295","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.56751982","3":"785","4":"0.7636204372","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.56751982","3":"787","4":"0.0313816007","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.56751982","3":"789","4":"0.0064308903","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.56751982","3":"792","4":"1.0694948901","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.56751982","3":"809","4":"1.7861884242","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.56751982","3":"810","4":"1.9387416596","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.56751982","3":"811","4":"0.2959029056","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.56751982","3":"813","4":"0.2695327539","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.56751982","3":"814","4":"0.4054651081","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.56751982","3":"1293","4":"-0.2812747279","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.56751982","3":"1294","4":"0.3400078915","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.56751982","3":"1295","4":"0.2422437227","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.56751982","3":"1302","4":"0.3081032025","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.56751982","3":"1314","4":"0.0957727145","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.56751982","3":"1318","4":"0.6135295526","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.56751982","3":"1332","4":"0.5576938894","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.56751982","3":"1336","4":"0.6144622463","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.56751982","3":"1339","4":"0.5401349253","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.56751982","3":"1341","4":"0.3433769840","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.56751982","3":"1345","4":"0.1993175414","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.56751982","3":"1352","4":"0.9880827125","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.56751982","3":"1356","4":"1.1847552331","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.56751982","3":"1362","4":"0.6354037026","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.56751982","3":"1375","4":"0.3310205829","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.56751982","3":"1380","4":"0.1674447012","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.56751982","3":"1391","4":"0.1332803571","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.56751982","3":"1393","4":"0.0632198810","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.56751982","3":"1395","4":"0.0296757681","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.56751982","3":"1397","4":"0.0131580846","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.56751982","3":"1407","4":"0.7038807362","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.56751982","3":"1414","4":"0.4823805922","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.56751982","3":"1416","4":"0.6362058042","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.56751982","3":"1426","4":"0.5484839476","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.56751982","3":"1443","4":"0.2672803800","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.56751982","3":"1447","4":"0.2227710425","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.56751982","3":"1457","4":"0.3160607992","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.56751982","3":"1460","4":"0.4797630318","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.56751982","3":"1461","4":"0.4236933497","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.56751982","3":"1534","4":"0.4906229164","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.56751982","3":"2215","4":"0.5253267145","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.56751982","3":"2217","4":"0.3040758822","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.56751982","3":"2260","4":"0.0372713948","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.56751982","3":"2545","4":"0.1892419996","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.56751982","3":"2548","4":"0.7221347174","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.56751982","3":"2552","4":"1.1180303745","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.56751982","3":"2557","4":"2.4510050981","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.56751982","3":"2558","4":"0.7282385004","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.56751982","3":"2581","4":"2.7725887222","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.56751982","3":"2609","4":"-0.3364722366","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.56751982","3":"2611","4":"0.3020867537","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.56751982","3":"2618","4":"0.9402992719","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.56751982","3":"2620","4":"0.7608931691","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.56751982","3":"2623","4":"1.1936392225","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.56751982","3":"2625","4":"1.0765641514","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.56751982","3":"2628","4":"-0.0524257973","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.56751982","3":"2632","4":"-0.2769867833","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.56751982","3":"2637","4":"0.3486022462","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.56751982","3":"2643","4":"0.3644460887","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.56751982","3":"2644","4":"0.4448676560","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.56751982","3":"2654","4":"1.7047480922","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.56751982","3":"2669","4":"0.3762354698","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.56751982","3":"2683","4":"2.9444389792","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.56751982","3":"2684","4":"2.9957322736","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.56751982","3":"2691","4":"0.1131148044","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.56751982","3":"2698","4":"0.2570451030","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.56751982","3":"2702","4":"0.4504164960","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.56751982","3":"2705","4":"0.8070914399","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.56751982","3":"2706","4":"0.4721564826","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.56751982","3":"2709","4":"1.9459101491","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.56751982","3":"2711","4":"2.0149030205","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.56751982","3":"2718","4":"-0.3289250310","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.56751982","3":"2722","4":"1.3328056762","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.56751982","3":"2729","4":"0.4432054361","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.56751982","3":"2740","4":"-0.1112256351","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.56751982","3":"2744","4":"0.1910552368","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.56751982","3":"2745","4":"-0.1112256351","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.56751982","3":"2747","4":"0.0000000000","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.56751982","3":"2748","4":"0.1625189295","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.56751982","3":"2752","4":"0.2513144283","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.56751982","3":"2764","4":"0.1929036661","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.56751982","3":"2766","4":"0.3545450177","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.56751982","3":"2768","4":"0.3087354816","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.56751982","3":"2769","4":"0.0816780310","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.56751982","3":"2816","4":"0.5863331763","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.56751982","3":"2824","4":"0.7985076962","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.56751982","3":"2825","4":"0.8584400369","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.56751982","3":"2830","4":"0.4799981600","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.56751982","3":"2832","4":"0.4772319065","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.56751982","3":"3415","4":"-0.1315763578","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.56751982","3":"3418","4":"0.1388364449","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.56751982","3":"3424","4":"0.7657863642","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.56751982","3":"3429","4":"0.4206399061","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.56751982","3":"3431","4":"0.3070250353","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.56751982","3":"3444","4":"0.8292793549","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.56751982","3":"3449","4":"0.8472978604","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.56751982","3":"3457","4":"0.8139836537","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.56751982","3":"3470","4":"1.3299414246","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.56751982","3":"3471","4":"0.3839589029","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.56751982","3":"3478","4":"1.1583840320","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.56751982","3":"3485","4":"1.1722241060","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.56751982","3":"3489","4":"1.1964981299","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.56751982","3":"3494","4":"0.5224598110","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.56751982","3":"3497","4":"0.7153350955","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.56751982","3":"3499","4":"0.7184649885","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.56751982","3":"3500","4":"1.2039728043","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.56751982","3":"3504","4":"0.7084614155","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.56751982","3":"3505","4":"0.2050707703","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.56751982","3":"3515","4":"0.4069324598","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.56751982","3":"3519","4":"0.8023464725","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.56751982","3":"3531","4":"0.1916290425","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.56751982","3":"3540","4":"0.1545485314","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.56751982","3":"3541","4":"-0.0047619138","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.54104441","3":"645","4":"0.2588200402","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.54104441","3":"655","4":"1.1631508098","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.54104441","3":"657","4":"1.0986122887","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.54104441","3":"659","4":"0.3894647668","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.54104441","3":"662","4":"0.3629054937","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.54104441","3":"667","4":"0.4054651081","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.54104441","3":"674","4":"0.9628107475","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.54104441","3":"675","4":"1.0906441190","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.54104441","3":"676","4":"0.7537718024","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.54104441","3":"677","4":"1.1786549963","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.54104441","3":"685","4":"0.2243361573","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.54104441","3":"687","4":"-0.0225851076","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.54104441","3":"692","4":"0.0562909639","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.54104441","3":"695","4":"0.9180039945","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.54104441","3":"699","4":"-0.0774317401","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.54104441","3":"705","4":"-0.0373359385","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.54104441","3":"736","4":"0.8362480242","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.54104441","3":"2395","4":"2.0840604875","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.53389104","3":"917","4":"0.9162907319","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.53389104","3":"918","4":"1.3862943611","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.53389104","3":"919","4":"0.9162907319","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.53389104","3":"921","4":"0.5991182309","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.53389104","3":"924","4":"-0.6505875661","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.53389104","3":"2422","4":"-0.4678082387","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.53389104","3":"2425","4":"0.6451379614","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.53389104","3":"2431","4":"0.7492366472","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.53389104","3":"2434","4":"0.7672551527","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.53389104","3":"2436","4":"0.8876801978","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.53389104","3":"2438","4":"-0.3958956571","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.53389104","3":"2439","4":"0.5573456394","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.53389104","3":"2441","4":"0.5633879539","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.53389104","3":"2442","4":"0.5753641449","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.53389104","3":"2454","4":"0.8406533177","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.53389104","3":"2455","4":"0.9488669023","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.53389104","3":"3551","4":"0.2712433461","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.53389104","3":"3552","4":"0.6295743765","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.50401066","3":"476","4":"0.8911004830","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.50401066","3":"479","4":"0.4744899535","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.50401066","3":"483","4":"0.7407752295","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.50401066","3":"488","4":"0.4417511163","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.50401066","3":"489","4":"0.2387919033","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.50248337","3":"4336","4":"0.0645385211","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.50248337","3":"4356","4":"0.3117796240","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.49353443","3":"2075","4":"0.2720758518","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.49353443","3":"2081","4":"0.6534147086","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.49353443","3":"2082","4":"0.6870238198","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.47424258","3":"817","4":"0.4006689358","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.45864353","3":"2952","4":"0.6449450787","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.45864353","3":"2954","4":"0.3005655282","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.45864353","3":"3154","4":"0.8754687374","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.45864353","3":"3156","4":"0.8754687374","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.45864353","3":"3158","4":"-0.3184537311","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.45864353","3":"3160","4":"0.5108256238","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.44398777","3":"1270","4":"0.1845712765","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.44398777","3":"1273","4":"0.2384110234","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.43929904","3":"4383","4":"0.7339691751","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.43929904","3":"4390","4":"-0.2513144283","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.43172753","3":"2189","4":"0.2540927826","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.42725878","3":"4287","4":"0.1696363973","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.42725878","3":"4306","4":"-0.1495317340","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.42725878","3":"4313","4":"0.5889473841","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.42725878","3":"4321","4":"0.3863709999","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.42725878","3":"4322","4":"0.2912939994","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.42725878","3":"4324","4":"0.9654758148","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.42725878","3":"4328","4":"0.4613173387","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.42725878","3":"4366","4":"0.2181129981","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.42725878","3":"4367","4":"0.4462871026","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.42725878","3":"4370","4":"0.3321338350","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.40678979","3":"4380","4":"0.4060591087","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.40678979","3":"4381","4":"0.4821404758","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.40486400","3":"1478","4":"0.3397271589","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.40486400","3":"1479","4":"1.1272441013","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.40486400","3":"1481","4":"0.2717959991","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.40486400","3":"1495","4":"-0.0008227068","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.40486400","3":"1496","4":"0.8050650968","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.40486400","3":"1504","4":"0.1946718772","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.40486400","3":"1510","4":"0.3158126520","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.40486400","3":"1517","4":"0.2600800409","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.40486400","3":"1520","4":"0.2275406496","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.40486400","3":"1524","4":"-0.1838391357","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.39844862","3":"1","4":"0.3027848406","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.38665285","3":"937","4":"0.6513777677","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.36782985","3":"627","4":"-0.1718502569","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.36782985","3":"633","4":"0.9343092374","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.35831509","3":"2541","4":"0.3821540292","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.35803458","3":"958","4":"0.2513144283","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.35803458","3":"962","4":"0.5972270587","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.35803458","3":"973","4":"0.7264044023","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.35803458","3":"982","4":"1.1730105787","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.35803458","3":"993","4":"0.3378064596","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.35803458","3":"994","4":"0.3311174715","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.35803458","3":"998","4":"0.3811160791","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.35803458","3":"1007","4":"-0.3490510188","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.35803458","3":"1008","4":"-0.0741079722","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.35803458","3":"1018","4":"0.9586785102","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.35803458","3":"1021","4":"0.5877866649","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.35803458","3":"1024","4":"0.2220379680","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.35803458","3":"1025","4":"0.0762273654","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.35803458","3":"1026","4":"0.2329958478","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.35803458","3":"1027","4":"-0.5441116014","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.35402148","3":"1860","4":"0.6286086594","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.35092592","3":"2024","4":"-0.2230863621","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.32781061","3":"318","4":"0.6269714236","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.32781061","3":"323","4":"0.5813783904","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.32781061","3":"329","4":"1.1901046291","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.32781061","3":"331","4":"0.9890290753","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.32781061","3":"334","4":"1.0154042306","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.32781061","3":"335","4":"0.7050520831","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.32781061","3":"338","4":"0.6780639383","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.32781061","3":"1670","4":"0.7339691751","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.32781061","3":"1676","4":"0.0425596144","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.32781061","3":"1680","4":"-0.6048545734","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.32781061","3":"1683","4":"0.0000000000","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.32781061","3":"1684","4":"0.0000000000","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.32781061","3":"1691","4":"1.6894806201","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.32781061","3":"1698","4":"0.4353180713","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.32781061","3":"1699","4":"-0.8292793549","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.32781061","3":"1703","4":"0.0666913745","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.32781061","3":"2227","4":"0.0604951412","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.32781061","3":"3098","4":"-0.6286086594","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.32781061","3":"3100","4":"-0.1670540847","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.32781061","3":"3104","4":"0.1310282624","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.32781061","3":"3107","4":"0.6418538862","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.32781061","3":"3114","4":"0.5108256238","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.32781061","3":"3129","4":"0.1712934813","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.32781061","3":"3130","4":"-0.7022720883","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.32781061","3":"3132","4":"-0.1814961337","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.32781061","3":"3136","4":"0.3954147723","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.32781061","3":"3143","4":"0.8542365172","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.32781061","3":"3145","4":"-0.6998586151","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.32781061","3":"3564","4":"-0.1527524041","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.32781061","3":"3569","4":"0.0491454671","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.32781061","3":"3570","4":"0.0713532676","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.32781061","3":"3572","4":"0.0566030002","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.32781061","3":"3573","4":"0.0341902449","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.32781061","3":"3574","4":"-0.1124335637","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.32781061","3":"3584","4":"0.1337293002","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.32781061","3":"3597","4":"0.0309970543","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.32781061","3":"3604","4":"0.0343442297","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.32781061","3":"3611","4":"0.1968866712","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.32781061","3":"3618","4":"0.2814891999","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.32781061","3":"3620","4":"0.5557067714","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.32781061","3":"3624","4":"-0.4818461185","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.32781061","3":"3626","4":"-0.2248738381","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.32781061","3":"3627","4":"0.0000000000","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.32781061","3":"3631","4":"-1.3703984353","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.32781061","3":"3633","4":"0.0264640558","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.32781061","3":"3641","4":"0.1558250209","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.32781061","3":"3642","4":"0.2908296064","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.32781061","3":"3646","4":"0.3157307523","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.32781061","3":"3647","4":"-0.3440448147","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.32781061","3":"3650","4":"-0.2220024570","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.32781061","3":"3658","4":"-0.2345411400","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.32781061","3":"3660","4":"0.0574816723","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.32781061","3":"3677","4":"0.0283596444","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.32781061","3":"3681","4":"0.1582741183","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.32781061","3":"3684","4":"0.0483095105","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.32781061","3":"3685","4":"-0.4360828562","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.32781061","3":"3687","4":"0.3235518924","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.32781061","3":"3690","4":"0.4937171056","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.32781061","3":"3693","4":"0.5771045805","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.32781061","3":"3695","4":"-0.0968062348","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.32781061","3":"3702","4":"0.0917821680","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.32781061","3":"3717","4":"0.8240527511","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.32781061","3":"3725","4":"0.1210104367","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.32781061","3":"3726","4":"-0.4154935858","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.32781061","3":"3730","4":"-0.2100267394","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.32781061","3":"3734","4":"0.5659920051","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.32781061","3":"3746","4":"0.1041058103","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.32781061","3":"3747","4":"-0.1459056862","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.32781061","3":"3753","4":"-0.1026541541","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.32781061","3":"3754","4":"-0.0650107018","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.32781061","3":"3757","4":"0.9326781450","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.32781061","3":"3762","4":"1.0819518478","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.32781061","3":"3768","4":"0.0846965335","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.32781061","3":"3773","4":"-1.0726368023","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.32781061","3":"3774","4":"0.0701363822","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.32781061","3":"3783","4":"0.4059669902","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.32781061","3":"3796","4":"-0.1502822030","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.32781061","3":"3801","4":"2.0874737134","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.32781061","3":"3802","4":"1.3338685638","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.32781061","3":"3826","4":"2.6439156388","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.32781061","3":"3830","4":"-0.5600204005","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.32781061","3":"3833","4":"0.7975363508","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.32781061","3":"3838","4":"0.9156432731","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.32781061","3":"3850","4":"1.9812662783","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.32781061","3":"3851","4":"2.0088427072","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.32781061","3":"3853","4":"0.1975842733","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.32781061","3":"3855","4":"-1.2843294345","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.32781061","3":"3858","4":"0.1053605157","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.32781061","3":"3860","4":"0.1304664368","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.32781061","3":"3861","4":"-0.6925196311","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.32781061","3":"3863","4":"1.1139780395","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.32781061","3":"3865","4":"1.1412391051","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.32781061","3":"3876","4":"1.7997916409","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.32781061","3":"3887","4":"1.1171217076","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.32781061","3":"3895","4":"1.4683202127","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.32781061","3":"3898","4":"1.8613256530","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.32781061","3":"3901","4":"1.0262790768","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.32781061","3":"3904","4":"1.4185253415","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.32781061","3":"3909","4":"-1.1001194480","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.32781061","3":"3910","4":"2.0159065329","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.32781061","3":"3916","4":"1.2927422631","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.32781061","3":"3928","4":"1.4903190335","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.32781061","3":"3935","4":"1.8602847737","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.32781061","3":"3936","4":"1.3305626846","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.32781061","3":"3942","4":"-0.0267475084","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.32781061","3":"3947","4":"1.8570308596","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.32781061","3":"3958","4":"2.5721196194","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.32781061","3":"3961","4":"0.5842664199","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.32781061","3":"3974","4":"0.9387076108","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.32781061","3":"3975","4":"0.1051085948","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.32781061","3":"3976","4":"1.8661672645","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.32781061","3":"3978","4":"0.5143458688","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.32781061","3":"4135","4":"-0.1425630647","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.32781061","3":"4149","4":"-0.5503230004","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.32781061","3":"4150","4":"-0.1431008436","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.32781061","3":"4153","4":"-0.5332984796","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.32781061","3":"4155","4":"0.7063924073","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.32781061","3":"4164","4":"-0.2695327539","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.32781061","3":"4166","4":"-0.1982397363","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.32781061","3":"4167","4":"0.4695896363","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.32781061","3":"4172","4":"-0.0076193767","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.32781061","3":"4178","4":"-0.1901096102","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.32781061","3":"4182","4":"0.4519851237","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.32781061","3":"4184","4":"-0.0470060424","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.32781061","3":"4191","4":"-0.2645596550","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.32781061","3":"4194","4":"-0.2930729211","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.32781061","3":"4196","4":"0.1376213779","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.32781061","3":"4199","4":"0.1232326404","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.32781061","3":"4209","4":"-0.2125614420","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.32781061","3":"4211","4":"-0.1112256351","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.32781061","3":"4214","4":"-0.1112256351","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.32781061","3":"4215","4":"0.2155963457","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.32781061","3":"4218","4":"-0.1541506798","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.32781061","3":"4220","4":"0.3132153745","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.29550915","3":"62","4":"0.6229854019","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.29550915","3":"65","4":"-0.0197725073","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.29254968","3":"2030","4":"-0.0629430699","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.29254968","3":"2037","4":"-0.4707485666","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.29254968","3":"2038","4":"0.2719337155","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.28657207","3":"3250","4":"0.2909878606","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.28159323","3":"3222","4":"-0.1697613621","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.28159323","3":"3223","4":"-0.0495339351","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.28070901","3":"2595","4":"0.3313571360","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.28070901","3":"2604","4":"0.2623642645","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.28070901","3":"2605","4":"0.6190392084","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.28070901","3":"2607","4":"0.1431008436","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.24335218","3":"2350","4":"0.6931471806","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.24335218","3":"2359","4":"0.2942394730","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.24335218","3":"2360","4":"0.7174398731","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.24335218","3":"2361","4":"0.4430030274","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.24335218","3":"2369","4":"0.4626235219","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.24335218","3":"2379","4":"0.0000000000","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.24335218","3":"2381","4":"-0.3101549283","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.24335218","3":"3389","4":"0.3809586979","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.24335218","3":"3392","4":"0.0721032939","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.24335218","3":"3396","4":"-0.2050161667","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.24335218","3":"3399","4":"0.0827722863","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.24335218","3":"3404","4":"0.3184537311","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.24335218","3":"3410","4":"0.7282385004","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.23142567","3":"1988","4":"0.3661387370","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.23142567","3":"1989","4":"0.5993414153","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.23142567","3":"1991","4":"0.1308239037","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.23142567","3":"1994","4":"0.4148991403","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.22427047","3":"37","4":"0.3126833747","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.22427047","3":"40","4":"-0.0457222493","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.22427047","3":"45","4":"0.1127954941","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.21909566","3":"2248","4":"0.4129056663","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.21909566","3":"2250","4":"0.1910214809","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.21514324","3":"1765","4":"0.1725335504","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.21514324","3":"1767","4":"-0.2606814706","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.21514324","3":"1773","4":"0.4205029855","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.21514324","3":"1777","4":"-0.4895482253","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.21514324","3":"1779","4":"-0.0399482505","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.21514324","3":"1781","4":"-0.3404602778","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.21514324","3":"1793","4":"0.2012132891","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.21514324","3":"1803","4":"0.9552353672","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.21514324","3":"1822","4":"0.0944908434","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.21514324","3":"1830","4":"0.6641867260","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.21514324","3":"1844","4":"0.4870204891","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.20376502","3":"1923","4":"1.1138797608","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.20376502","3":"1924","4":"1.1845547185","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.20376502","3":"1926","4":"1.3124822032","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.20376502","3":"1927","4":"1.2589549387","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.20376502","3":"1935","4":"1.4271163556","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.20376502","3":"1937","4":"1.5508304855","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.20376502","3":"1950","4":"-1.6403827163","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.20376502","3":"1952","4":"-2.1522465821","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.20376502","3":"1968","4":"1.0272356258","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.20376502","3":"1981","4":"-0.8068064990","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.20376502","3":"1985","4":"0.2471664036","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.19660834","3":"2894","4":"0.1197735617","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.19660834","3":"2895","4":"0.2402985865","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.19660834","3":"2897","4":"0.0144583766","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.19660834","3":"2898","4":"0.1199008223","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.19660834","3":"2899","4":"0.3230104180","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.19660834","3":"2912","4":"0.7987986388","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.19660834","3":"2913","4":"0.5550157848","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.19660834","3":"2914","4":"0.0640874095","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.19660834","3":"2918","4":"0.1531075767","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.19660834","3":"2920","4":"0.0067207803","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.19660834","3":"2921","4":"0.1352216489","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.19660834","3":"2930","4":"0.0458301225","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.19660834","3":"2941","4":"-0.1031842362","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.17028067","3":"2856","4":"0.1844290391","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.17028067","3":"2858","4":"0.9034425894","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.17028067","3":"2872","4":"0.1769307082","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.17028067","3":"2873","4":"0.3920420878","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.13575147","3":"1659","4":"0.2323200680","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.13575147","3":"1664","4":"0.1436802233","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.07373251","3":"2007","4":"-0.0152674721","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.07373251","3":"2008","4":"0.1840036430","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.07373251","3":"2009","4":"0.3357504755","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.07373251","3":"2010","4":"0.3884867716","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.06761879","3":"1848","4":"-0.1450155051","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.06761879","3":"1850","4":"0.0980514538","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.06761879","3":"1851","4":"0.0464070319","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.06761879","3":"1852","4":"0.1693033748","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.06424098","3":"2122","4":"-0.3677247801","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.06424098","3":"2128","4":"0.4924764851","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.06424098","3":"2132","4":"0.0487901642","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.06424098","3":"2133","4":"0.1541506798","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.06424098","3":"2136","4":"-0.0741079722","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.06424098","3":"2141","4":"0.6567795364","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.06424098","3":"2142","4":"0.1603426501","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.06424098","3":"2150","4":"-0.5925036548","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.06424098","3":"2152","4":"-0.5570150062","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.06424098","3":"3288","4":"0.2343481503","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.06424098","3":"3293","4":"0.3324399731","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.06424098","3":"3296","4":"0.0409015142","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.06424098","3":"3297","4":"-0.0099900931","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.06424098","3":"3298","4":"-0.0385052634","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.06424098","3":"3304","4":"0.0235767306","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.06424098","3":"3310","4":"0.1977673338","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.06424098","3":"3312","4":"0.2308585884","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.06424098","3":"3319","4":"-0.3459237144","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.06424098","3":"3321","4":"-0.0720650705","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.06424098","3":"3324","4":"-0.1053605157","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.06424098","3":"3326","4":"0.2876820725","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.05954546","3":"2230","4":"-0.1348492357","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.05954546","3":"2232","4":"-0.0639058970","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.02220065","3":"2778","4":"0.0269376557","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.02220065","3":"2781","4":"-0.0587713174","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.02220065","3":"2784","4":"0.0522039193","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.02220065","3":"2786","4":"-0.2555537955","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.02065611","3":"2944","4":"1.2139792299","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.02065611","3":"2947","4":"1.1112795939","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.02065611","3":"2956","4":"0.2399506696","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.02065611","3":"2958","4":"-0.4139757978","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.02065611","3":"2960","4":"0.6328549503","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.02065611","3":"2962","4":"0.5661474898","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.02065611","3":"2963","4":"0.1914540404","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.02065611","3":"2964","4":"-0.0469569831","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.02065611","3":"2969","4":"0.2916113506","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.02065611","3":"2975","4":"0.5389965007","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.02065611","3":"2977","4":"0.2818511521","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.02065611","3":"2978","4":"-0.0235304974","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.02065611","3":"2997","4":"-0.2387080679","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.02065611","3":"2998","4":"0.0100503359","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.02065611","3":"3005","4":"0.1554368536","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.02065611","3":"3006","4":"-0.0812947424","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.02065611","3":"3020","4":"-0.2751032902","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.02065611","3":"3025","4":"0.3583975973","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.02065611","3":"3031","4":"0.2113090937","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.02065611","3":"3033","4":"1.3862943611","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.02065611","3":"3036","4":"0.2806149052","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.02065611","3":"3040","4":"-0.3422862065","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.02065611","3":"3041","4":"-0.3698741630","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.02065611","3":"3042","4":"-0.3982448601","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.02065611","3":"3043","4":"-0.3756121450","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.02065611","3":"3045","4":"-0.0412429585","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.02065611","3":"3049","4":"-0.2341933875","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.02065611","3":"3055","4":"-0.2054439742","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.02065611","3":"3056","4":"-0.1376213779","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.02065611","3":"3058","4":"-0.4989911661","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.02065611","3":"3061","4":"0.0964602662","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.02065611","3":"3066","4":"-0.1978257433","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.02065611","3":"3067","4":"0.0000000000","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.02065611","3":"3084","4":"-0.2630447681","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.02065611","3":"3088","4":"-0.2685296402","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.01620613","3":"2270","4":"-0.4918891998","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.01620613","3":"2275","4":"0.0505344731","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.01620613","3":"2276","4":"0.1290967956","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.01620613","3":"2287","4":"-0.2213218728","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.01620613","3":"2293","4":"0.5082924580","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.01620613","3":"2302","4":"-0.2454103521","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.01620613","3":"2303","4":"-0.3723410607","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.01620613","3":"2307","4":"-0.2138959024","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.01620613","3":"2316","4":"-0.4062346349","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.01620613","3":"2322","4":"0.3333702566","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.01620613","3":"2323","4":"1.3190421341","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.01620613","3":"2337","4":"0.3411960198","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.01620613","3":"2339","4":"-0.1755784429","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.01620613","3":"2341","4":"0.3775648305","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.01620613","3":"2344","4":"0.1779243567","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.01537848","3":"2084","4":"-0.1050033090","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.01537848","3":"2091","4":"-0.0346397820","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.01537848","3":"2102","4":"-0.1577777852","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.01537848","3":"2104","4":"-0.0808937642","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.01537848","3":"2107","4":"0.0121615650","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.01537848","3":"2108","4":"0.0212773984","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.01537848","3":"2110","4":"-0.0529843661","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"0.01537848","3":"2115","4":"-0.0072520390","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"-0.02271271","3":"4462","4":"-0.0051581958","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"-0.02271271","3":"4463","4":"-0.0443582230","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"-0.02271271","3":"4467","4":"-0.0458468416","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"-0.02271271","3":"4470","4":"0.0051067418","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"-0.02271271","3":"4473","4":"0.0040088671","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"-0.02271271","3":"4480","4":"0.1404340607","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"-0.02271271","3":"4483","4":"-0.1168177468","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"-0.02271271","3":"4502","4":"0.0341548674","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"-0.02271271","3":"4508","4":"-0.7442508095","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"-0.03350308","3":"1885","4":"-1.6894806201","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"-0.03350308","3":"1892","4":"0.4348397168","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"-0.03350308","3":"1893","4":"-0.2241686667","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"-0.04511841","3":"1117","4":"-0.0425596144","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"-0.04511841","3":"1125","4":"-0.0480092192","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"-0.04511841","3":"1130","4":"-0.1133286853","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"-0.05156828","3":"3256","4":"-0.4595323294","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"-0.05156828","3":"3260","4":"-0.3083013597","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"-0.05156828","3":"3263","4":"-0.3364722366","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"-0.05156828","3":"3266","4":"0.0903840615","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"-0.05156828","3":"3275","4":"0.1859645481","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"-0.07026499","3":"1730","4":"-0.1135971777","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"-0.07026499","3":"1740","4":"-0.0979375350","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"-0.07026499","3":"1743","4":"-0.0573222811","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"-0.07026499","3":"3169","4":"-1.0431331363","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"-0.07026499","3":"3171","4":"-0.9521613581","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"-0.07026499","3":"3172","4":"-0.0992549581","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"-0.07026499","3":"3183","4":"0.1664482076","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"-0.07026499","3":"3187","4":"-0.2130932155","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"-0.07026499","3":"3193","4":"-0.2254937287","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"-0.07026499","3":"3196","4":"-0.5177324100","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"-0.07026499","3":"3203","4":"0.8338145100","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"-0.07026499","3":"3211","4":"-0.3420588433","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"-0.07026499","3":"3212","4":"0.2379586371","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"-0.07026499","3":"3213","4":"-0.4269441398","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"-0.07026499","3":"3215","4":"-0.1688208696","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"-0.07026499","3":"3221","4":"0.2290086708","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"-0.08336707","3":"1901","4":"-0.6171202824","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"-0.08336707","3":"1903","4":"-0.2345916306","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"-0.08336707","3":"1908","4":"-0.7161754377","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"-0.08336707","3":"1909","4":"-0.1868849795","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"-0.08336707","3":"1912","4":"0.2657950902","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"-0.09656829","3":"867","4":"-0.0446863052","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"-0.09805515","3":"2254","4":"-0.0090180972","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"-0.09805515","3":"2255","4":"-0.1058987288","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"-0.10461478","3":"3235","4":"-0.1027632279","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"-0.11450432","3":"2788","4":"-0.5624688569","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"-0.11450432","3":"2790","4":"-0.4020924236","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"-0.11450432","3":"2792","4":"0.0060913894","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"-0.11450432","3":"2796","4":"0.3584622545","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"-0.11450432","3":"2798","4":"0.2571906982","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"-0.11450432","3":"2802","4":"0.2855812313","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"-0.12288775","3":"1122","4":"-0.5007752879","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"-0.13394832","3":"2509","4":"0.2744368457","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"-0.13394832","3":"2512","4":"-0.3654597735","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"-0.18226839","3":"2048","4":"0.5990498572","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"-0.19305136","3":"2487","4":"-0.6518014027","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"-0.19305136","3":"2491","4":"-0.6715725814","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"-0.19305136","3":"2497","4":"-0.7347709556","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"-0.19305136","3":"2498","4":"-0.6423691637","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"-0.21746163","3":"516","4":"0.0300774552","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"-0.21746163","3":"520","4":"-0.9049054096","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"-0.21746163","3":"521","4":"-1.6563214983","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"-0.21746163","3":"522","4":"-1.8794650496","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"-0.21746163","3":"536","4":"-1.1343303713","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"-0.21746163","3":"537","4":"-1.8094590463","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"-0.21746163","3":"584","4":"0.0073801073","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"-0.21746163","3":"590","4":"-2.4203681287","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"-0.21746163","3":"598","4":"0.0112150708","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"-0.21746163","3":"603","4":"-1.4091090389","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"-0.22729735","3":"1874","4":"0.2006706955","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"-0.32840319","3":"341","4":"-0.0005331272","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"-0.32840319","3":"343","4":"0.3813674785","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"-0.32840319","3":"345","4":"0.0596250274","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"-0.32840319","3":"347","4":"0.0764278697","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"-0.32840319","3":"350","4":"-0.1895178903","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"-0.32840319","3":"368","4":"-0.4231324222","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"-0.32840319","3":"371","4":"0.1246299894","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"-0.32840319","3":"373","4":"-0.7672553989","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"-0.32840319","3":"389","4":"0.2213673661","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"-0.32840319","3":"394","4":"-0.0278065250","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"-0.32840319","3":"404","4":"-2.4221446281","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"-0.32840319","3":"405","4":"-0.3640455549","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"-0.32840319","3":"406","4":"-0.2727013342","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"-0.32840319","3":"414","4":"-1.6063919233","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"-0.32840319","3":"418","4":"-0.6839227680","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"-0.32840319","3":"420","4":"-0.7403568855","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"-0.32840319","3":"425","4":"0.0917963430","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"-0.33063415","3":"822","4":"-0.9808292530","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"-0.33063415","3":"824","4":"-0.4700036292","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"-0.33063415","3":"827","4":"-0.6632942174","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"-0.33063415","3":"835","4":"-0.9162907319","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"-0.33063415","3":"839","4":"-0.5965203449","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"-0.33063415","3":"841","4":"-0.6505875661","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"-0.33063415","3":"844","4":"-0.5452270505","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"-0.33063415","3":"850","4":"-1.2390641241","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"-0.33063415","3":"859","4":"-0.5089006954","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"-0.33063415","3":"864","4":"0.0000000000","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"-0.33063415","3":"880","4":"-0.1406488604","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"-0.33063415","3":"881","4":"0.0000000000","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"-0.33063415","3":"895","4":"-0.3622929362","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"-0.33063415","3":"900","4":"-0.5266989729","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"-0.33063415","3":"903","4":"0.1325466560","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"-0.33063415","3":"904","4":"0.1256262131","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"-0.33063415","3":"905","4":"0.1796934344","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"-0.33063415","3":"910","4":"0.1118281053","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"-0.33063415","3":"1036","4":"-0.1177830357","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"-0.33063415","3":"1048","4":"-0.9731781063","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"-0.33063415","3":"1169","4":"0.0293658948","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"-0.33063415","3":"1175","4":"0.2211075818","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"-0.33063415","3":"1177","4":"-0.2768711563","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"-0.33063415","3":"1187","4":"0.3896545021","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"-0.33063415","3":"1188","4":"0.2041406042","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"-0.33063415","3":"1190","4":"-0.0593542426","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"-0.33063415","3":"1196","4":"0.6295214847","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"-0.33063415","3":"1200","4":"0.1970928741","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"-0.33063415","3":"1210","4":"-0.1150693298","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"-0.33063415","3":"1211","4":"0.0631789016","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"-0.33063415","3":"1212","4":"-0.3241517522","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"-0.33063415","3":"1215","4":"-0.2584829178","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"-0.33063415","3":"1217","4":"-0.4757343040","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"-0.33063415","3":"1227","4":"-0.3980301296","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"-0.33063415","3":"1233","4":"0.1088028598","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"-0.33063415","3":"1236","4":"0.0072727593","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"-0.33063415","3":"1239","4":"-0.4307829161","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"-0.33063415","3":"1243","4":"-0.6197646346","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"-0.33063415","3":"1256","4":"0.9210413346","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"-0.33063415","3":"1257","4":"-1.9029851043","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"-0.33063415","3":"1259","4":"-1.9033505346","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"-0.33063415","3":"1260","4":"-0.7988673438","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"-0.33063415","3":"2262","4":"-0.9382696386","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"-0.33063415","3":"2463","4":"0.0556608471","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"-0.33063415","3":"2468","4":"-0.0041928783","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"-0.33063415","3":"2474","4":"0.1302146400","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"-0.33063415","3":"2475","4":"-0.0544352066","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"-0.33063415","3":"2476","4":"0.0196727656","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"-0.33063415","3":"2482","4":"0.5226951993","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"-0.33063415","3":"2499","4":"-0.6645283753","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"-0.33063415","3":"2501","4":"-0.5432975826","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"-0.34997730","3":"2403","4":"-1.3196796120","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"-0.34997730","3":"2407","4":"-1.2121361150","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"-0.34997730","3":"2413","4":"0.9555114450","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"-0.35152084","3":"4074","4":"-0.3285040670","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"-0.35152084","3":"4081","4":"-0.5068176024","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"-0.35377735","3":"1898","4":"-1.0699570329","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"-0.35377735","3":"1899","4":"-0.8570350357","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"-0.35377735","3":"3240","4":"-0.5408064560","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"-0.35377735","3":"3244","4":"-0.2263131261","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"-0.39364828","3":"638","4":"-0.4756268868","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"-0.39364828","3":"641","4":"-0.0327898228","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"-0.46019278","3":"551","4":"0.1335313926","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"-0.46019278","3":"553","4":"-1.1657515915","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"-0.46019278","3":"554","4":"-1.2527629685","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"-0.46019278","3":"555","4":"0.0186340795","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"-0.46019278","3":"559","4":"-0.5947071077","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"-0.46019278","3":"560","4":"-1.2434025257","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"-0.46019278","3":"607","4":"-0.0849932128","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"-0.46019278","3":"611","4":"-2.4203681287","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"-0.46019278","3":"613","4":"0.6894366012","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"-0.46019278","3":"616","4":"-0.0074349785","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"-0.46019278","3":"623","4":"-0.2222381642","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"-0.46593826","3":"510","4":"-0.1749906343","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"-0.46593826","3":"514","4":"-1.8718021769","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"-0.46593826","3":"566","4":"-0.2513144283","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"-0.46593826","3":"572","4":"0.6081539677","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"-0.48742522","3":"873","4":"-0.1466034742","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"-0.48742522","3":"1040","4":"0.4818380869","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"-0.48742522","3":"1043","4":"-2.2881963555","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"-0.48742522","3":"1044","4":"-0.1736634941","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"-0.64862976","3":"1858","4":"-1.0736109865","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"-0.64862976","3":"1871","4":"-0.3934022357","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"-0.81965165","3":"3997","4":"-1.2992829841","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"-0.81965165","3":"4009","4":"-0.9162907319","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"-0.81965165","3":"4014","4":"-1.2527629685","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"-0.81965165","3":"4018","4":"-2.2772672850","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"-0.81965165","3":"4024","4":"-2.2772672850","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"-0.81965165","3":"4039","4":"-0.9295359586","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"-0.81965165","3":"4041","4":"-1.4403615824","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"-0.81965165","3":"4053","4":"0.2411620568","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"-0.92189595","3":"4512","4":"-1.2313182582","5":"Preprocessor1_Model1"},{"1":"train/test split","2":"-0.92189595","3":"4513","4":"-0.5632350463","5":"Preprocessor1_Model1"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<h2 id="step-12-explaining-models-and-predictions-model-agnostics-with-local-break-down-plots">STEP 12: Explaining models and predictions (model agnostics) with local break-down plots</h2>
<p>We suggested that model performance, as measured by appropriate metrics (like RMSE for regression or area under the ROC curve for classification), can be important for all applications of modelling. Similarly, model explanations, answering why a model makes the predictions it does, can be important whether the purpose of your model is largely descriptive, to test a hypothesis, or to make a prediction. Answering the question “why?” allows modelling practitioners to understand which features were important in predictions and even how model predictions would change under different values for the features.</p>
<p>For some models, like linear regression, it is usually clear how to explain why the model makes the predictions it does. The structure of a linear model contains coefficients for each predictor that are typically straightforward to interpret. For other models, like random forests that can capture non-linear behaviour by design, it is less transparent how to explain the model’s predictions from only the structure of the model itself. Instead, we can apply model explainer algorithms to generate understanding of predictions.</p>
<p><strong>Notes:</strong> There are two types of model explanations, global and local. Global model explanations provide an overall understanding aggregated over a whole set of observations; local model explanations provide information about a prediction for a single observation.</p>
<p>The tidymodels framework does not itself contain software for model explanations. Instead, models trained and evaluated with tidymodels can be explained with other, supplementary software in R packages such as lime, vip, and DALEX. We ourselves often choose:</p>
<p>vip functions when we want to use model-based methods that take advantage of model structure (and are often faster), and DALEX functions when we want to use model-agnostic methods that can be applied to any model.</p>
<p>Let’s build model-agnostic explainers for both of these models to find out why they make the predictions they do. We can use the DALEXtra add-on package for DALEX (<a href="https://www.tmwr.org/explain.html" class="uri">https://www.tmwr.org/explain.html</a>), which provides support for tidymodels. Biecek and Burzykowski (2021) provide a thorough exploration of how to use DALEX for model explanations; this chapter only summarizes some important approaches, specific to tidymodels. To compute any kind of model explanation, global or local, using DALEX (<a href="https://www.tmwr.org/explain.html" class="uri">https://www.tmwr.org/explain.html</a>), we first create an explainer for each model.</p>
<h3 id="step-12a-creating-trained-workflows-for-each-of-the-four-models">STEP 12a: Creating trained workflows for each of the four models</h3>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>rf_best_race_trained_wf</span> <span class='op'>&lt;-</span> 
   <span class='va'>wflwset_setup_race_results_clean</span> <span class='op'>%&gt;%</span> 
   <span class='fu'>extract_workflow</span><span class='op'>(</span><span class='st'>"normalized_RF"</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
   <span class='fu'>finalize_workflow</span><span class='op'>(</span><span class='va'>rf_wf_best_rmse_results_of_race</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
   <span class='fu'>fit</span><span class='op'>(</span>data <span class='op'>=</span> <span class='va'>af.train.wf</span><span class='op'>)</span>

<span class='va'>xgb_best_race_trained_wf</span> <span class='op'>&lt;-</span> 
   <span class='va'>wflwset_setup_race_results_clean</span> <span class='op'>%&gt;%</span> 
   <span class='fu'>extract_workflow</span><span class='op'>(</span><span class='st'>"interaction_XGB"</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
   <span class='fu'>finalize_workflow</span><span class='op'>(</span><span class='va'>xgb_wf_best_rmse_results_of_race</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
   <span class='fu'>fit</span><span class='op'>(</span>data <span class='op'>=</span> <span class='va'>af.train.wf</span><span class='op'>)</span>

<span class='va'>cart_best_race_trained_wf</span> <span class='op'>&lt;-</span> 
   <span class='va'>wflwset_setup_race_results_clean</span> <span class='op'>%&gt;%</span> 
   <span class='fu'>extract_workflow</span><span class='op'>(</span><span class='st'>"rm_corr_cart"</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
   <span class='fu'>finalize_workflow</span><span class='op'>(</span><span class='va'>cart_wf_best_rmse_results_of_race</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
   <span class='fu'>fit</span><span class='op'>(</span>data <span class='op'>=</span> <span class='va'>af.train.wf</span><span class='op'>)</span>

<span class='va'>glm_best_race_trained_wf</span> <span class='op'>&lt;-</span> 
   <span class='va'>wflwset_setup_race_results_clean</span> <span class='op'>%&gt;%</span> 
   <span class='fu'>extract_workflow</span><span class='op'>(</span><span class='st'>"interaction_glm"</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
   <span class='fu'>finalize_workflow</span><span class='op'>(</span><span class='va'>glm_wf_best_rmse_results_of_race</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
   <span class='fu'>fit</span><span class='op'>(</span>data <span class='op'>=</span> <span class='va'>af.train.wf</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<h3 id="saving-trained-workflows">Saving trained workflows</h3>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># SAVING THE BEST PERFORMING MODEL CONFIGURATIONS</span>

<span class='fu'><a href='https://rdrr.io/r/base/readRDS.html'>saveRDS</a></span><span class='op'>(</span><span class='va'>rf_best_race_trained_wf</span>, <span class='fu'>here</span><span class='fu'>::</span><span class='fu'><a href='https://here.r-lib.org//reference/here.html'>here</a></span><span class='op'>(</span><span class='st'>"TidyModWflSet_OUTPUT"</span>,<span class='st'>"rf_best_race_trained_wf.RDS"</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/readRDS.html'>saveRDS</a></span><span class='op'>(</span><span class='va'>xgb_best_race_trained_wf</span>, <span class='fu'>here</span><span class='fu'>::</span><span class='fu'><a href='https://here.r-lib.org//reference/here.html'>here</a></span><span class='op'>(</span><span class='st'>"TidyModWflSet_OUTPUT"</span>,<span class='st'>"xgb_best_race_trained_wf.RDS"</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/readRDS.html'>saveRDS</a></span><span class='op'>(</span><span class='va'>cart_best_race_trained_wf</span>, <span class='fu'>here</span><span class='fu'>::</span><span class='fu'><a href='https://here.r-lib.org//reference/here.html'>here</a></span><span class='op'>(</span><span class='st'>"TidyModWflSet_OUTPUT"</span>,<span class='st'>"cart_best_race_trained_wf.RDS"</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/readRDS.html'>saveRDS</a></span><span class='op'>(</span><span class='va'>glm_best_race_trained_wf</span>, <span class='fu'>here</span><span class='fu'>::</span><span class='fu'><a href='https://here.r-lib.org//reference/here.html'>here</a></span><span class='op'>(</span><span class='st'>"TidyModWflSet_OUTPUT"</span>,<span class='st'>"glm_best_race_trained_wf.RDS"</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
</details>
</div>
<h2 id="step-12b-generating-explainers-for-each-of-the-four-models">#STEP 12b: Generating explainers for each of the four models</h2>
<p>General explainers</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># Creating the VIP features to be included. It is important here that these features are exactly the same as the one in the dataset</span>
<span class='va'>vip_features</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"PrName"</span>, <span class='st'>"Out.SubInd"</span>, <span class='st'>"Product"</span>, <span class='st'>"Tree"</span>, <span class='st'>"Out.SubInd.Code"</span>,<span class='st'>"Site.Type"</span>, <span class='st'>"Latitude"</span>, <span class='st'>"Longitude"</span>, 
                  <span class='st'>"Bio01_MT_Annu"</span>, <span class='st'>"Bio02_MDR"</span>, <span class='st'>"Bio03_Iso"</span>, <span class='st'>"Bio04_TS"</span>, <span class='st'>"Bio05_TWM"</span>, <span class='st'>"Bio06_MinTCM"</span>, <span class='st'>"Bio07_TAR"</span>, <span class='st'>"Bio08_MT_WetQ"</span>,
                  <span class='st'>"Bio09_MT_DryQ"</span>, <span class='st'>"Bio10_MT_WarQ"</span>, <span class='st'>"Bio11_MT_ColQ"</span>,  <span class='st'>"Bio12_Pecip_Annu"</span>, <span class='st'>"Bio13_Precip_WetM"</span>, <span class='st'>"Bio14_Precip_DryM"</span>,
                  <span class='st'>"Bio15_Precip_S"</span>, <span class='st'>"Bio16_Precip_WetQ"</span>, <span class='st'>"Bio17_Precip_DryQ"</span>, <span class='st'>"iSDA_Depth_to_bedrock"</span>, <span class='st'>"iSDA_SAND_conc"</span>, <span class='st'>"iSDA_CLAY_conc"</span>,
                  <span class='st'>"iSDA_SILT_conc"</span>, <span class='st'>"iSDA_log_C_tot"</span>, <span class='st'>"iSDA_FE_Bulk_dens"</span>, <span class='st'>"iSDA_log_Ca"</span>, <span class='st'>"iSDA_log_eCEC"</span>, <span class='st'>"iSDA_log_Fe"</span>, <span class='st'>"iSDA_log_K"</span>,
                  <span class='st'>"iSDA_log_Mg"</span>, <span class='st'>"iSDA_log_N"</span>, <span class='st'>"iSDA_log_SOC"</span>, <span class='st'>"iSDA_log_P"</span>, <span class='st'>"iSDA_log_S"</span>, <span class='st'>"iSDA_pH"</span>, <span class='st'>"ASTER_Altitude"</span>, <span class='st'>"ASTER_Slope"</span><span class='op'>)</span>

<span class='co'># Generating the trainer VIP</span>
<span class='va'>vip_train</span> <span class='op'>&lt;-</span> 
  <span class='va'>af.train.wf</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>select</span><span class='op'>(</span><span class='fu'>all_of</span><span class='op'>(</span><span class='va'>vip_features</span><span class='op'>)</span><span class='op'>)</span>

<span class='co'># Finally we can create the vip explainer for the individual models (Random Forest, XGBoost, cart and glm)</span>

<span class='va'>explainer_rf</span> <span class='op'>&lt;-</span>              
  <span class='fu'>explain_tidymodels</span><span class='op'>(</span>
    <span class='va'>rf_best_race_trained_wf</span>, 
    data <span class='op'>=</span> <span class='va'>vip_train</span>, 
    y <span class='op'>=</span> <span class='va'>af.train.wf</span><span class='op'>$</span><span class='va'>logRR</span>,
    label <span class='op'>=</span> <span class='st'>"Random Forest with normalized data"</span>,
    verbose <span class='op'>=</span> <span class='cn'>FALSE</span>
  <span class='op'>)</span>

<span class='va'>explainer_xgb</span> <span class='op'>&lt;-</span> 
  <span class='fu'>explain_tidymodels</span><span class='op'>(</span>
    <span class='va'>xgb_best_race_trained_wf</span>, 
    data <span class='op'>=</span> <span class='va'>vip_train</span>, 
    y <span class='op'>=</span> <span class='va'>af.train.wf</span><span class='op'>$</span><span class='va'>logRR</span>,
    label <span class='op'>=</span> <span class='st'>"XGBoost with interactions"</span>,
    verbose <span class='op'>=</span> <span class='cn'>FALSE</span>
  <span class='op'>)</span>

<span class='va'>explainer_cart</span> <span class='op'>&lt;-</span> 
    <span class='fu'>explain_tidymodels</span><span class='op'>(</span>
    <span class='va'>cart_best_race_trained_wf</span>, 
    data <span class='op'>=</span> <span class='va'>vip_train</span>, 
    y <span class='op'>=</span> <span class='va'>af.train.wf</span><span class='op'>$</span><span class='va'>logRR</span>,
    label <span class='op'>=</span> <span class='st'>"Cart with removed correlations"</span>,
    verbose <span class='op'>=</span> <span class='cn'>FALSE</span>
  <span class='op'>)</span>

<span class='va'>explainer_glm</span> <span class='op'>&lt;-</span> 
  <span class='fu'>explain_tidymodels</span><span class='op'>(</span>
    <span class='va'>glm_best_race_trained_wf</span>, 
    data <span class='op'>=</span> <span class='va'>vip_train</span>, 
    y <span class='op'>=</span> <span class='va'>af.train.wf</span><span class='op'>$</span><span class='va'>logRR</span>,
    label <span class='op'>=</span> <span class='st'>"glm with interactions"</span>,
    verbose <span class='op'>=</span> <span class='cn'>FALSE</span>
  <span class='op'>)</span>

<span class='co'># SAVING THE EXPLAINERS</span>
<span class='fu'><a href='https://rdrr.io/r/base/readRDS.html'>saveRDS</a></span><span class='op'>(</span><span class='va'>explainer_rf</span>, <span class='fu'>here</span><span class='fu'>::</span><span class='fu'><a href='https://here.r-lib.org//reference/here.html'>here</a></span><span class='op'>(</span><span class='st'>"TidyModWflSet_OUTPUT"</span>,<span class='st'>"explainer_rf.RDS"</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/readRDS.html'>saveRDS</a></span><span class='op'>(</span><span class='va'>explainer_xgb</span>, <span class='fu'>here</span><span class='fu'>::</span><span class='fu'><a href='https://here.r-lib.org//reference/here.html'>here</a></span><span class='op'>(</span><span class='st'>"TidyModWflSet_OUTPUT"</span>,<span class='st'>"explainer_xgb.RDS"</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/readRDS.html'>saveRDS</a></span><span class='op'>(</span><span class='va'>explainer_cart</span>, <span class='fu'>here</span><span class='fu'>::</span><span class='fu'><a href='https://here.r-lib.org//reference/here.html'>here</a></span><span class='op'>(</span><span class='st'>"TidyModWflSet_OUTPUT"</span>,<span class='st'>"explainer_cart.RDS"</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/readRDS.html'>saveRDS</a></span><span class='op'>(</span><span class='va'>explainer_glm</span>, <span class='fu'>here</span><span class='fu'>::</span><span class='fu'><a href='https://here.r-lib.org//reference/here.html'>here</a></span><span class='op'>(</span><span class='st'>"TidyModWflSet_OUTPUT"</span>,<span class='st'>"explainer_glm.RDS"</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p>Continuous explainers</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># Reading/loading best trained model workflows</span>

<span class='va'>rf_best_race_trained_wf</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/readRDS.html'>readRDS</a></span><span class='op'>(</span><span class='fu'>here</span><span class='fu'>::</span><span class='fu'><a href='https://here.r-lib.org//reference/here.html'>here</a></span><span class='op'>(</span><span class='st'>"TidyModWflSet_OUTPUT"</span>,<span class='st'>"rf_best_race_trained_wf.RDS"</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>xgb_best_race_trained_wf</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/readRDS.html'>readRDS</a></span><span class='op'>(</span><span class='fu'>here</span><span class='fu'>::</span><span class='fu'><a href='https://here.r-lib.org//reference/here.html'>here</a></span><span class='op'>(</span><span class='st'>"TidyModWflSet_OUTPUT"</span>,<span class='st'>"xgb_best_race_trained_wf.RDS"</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>cart_best_race_trained_wf</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/readRDS.html'>readRDS</a></span><span class='op'>(</span><span class='fu'>here</span><span class='fu'>::</span><span class='fu'><a href='https://here.r-lib.org//reference/here.html'>here</a></span><span class='op'>(</span><span class='st'>"TidyModWflSet_OUTPUT"</span>,<span class='st'>"cart_best_race_trained_wf.RDS"</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>glm_best_race_trained_wf</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/readRDS.html'>readRDS</a></span><span class='op'>(</span><span class='fu'>here</span><span class='fu'>::</span><span class='fu'><a href='https://here.r-lib.org//reference/here.html'>here</a></span><span class='op'>(</span><span class='st'>"TidyModWflSet_OUTPUT"</span>,<span class='st'>"glm_best_race_trained_wf.RDS"</span><span class='op'>)</span><span class='op'>)</span>



<span class='co'># Random Forest model</span>
<span class='va'>explainer_rf_continous</span> <span class='op'>&lt;-</span> <span class='fu'>DALEX</span><span class='fu'>::</span><span class='fu'><a href='https://dalex.drwhy.ai/reference/explain.html'>explain</a></span><span class='op'>(</span><span class='va'>rf_best_race_trained_wf</span>,
                        data <span class='op'>=</span> <span class='va'>af.train.wf</span>,
                        y <span class='op'>=</span> <span class='va'>af.train.wf</span><span class='op'>$</span><span class='va'>logRR</span>, 
                        label <span class='op'>=</span> <span class='st'>"Random Forest"</span><span class='op'>)</span>

<span class='co'># XGB model</span>

<span class='va'>explainer_xgb_continous</span> <span class='op'>&lt;-</span> 
  <span class='fu'>DALEX</span><span class='fu'>::</span><span class='fu'><a href='https://dalex.drwhy.ai/reference/explain.html'>explain</a></span><span class='op'>(</span><span class='va'>xgb_best_race_trained_wf</span>,
                        data <span class='op'>=</span> <span class='va'>af.train.wf</span>,
                        y <span class='op'>=</span> <span class='va'>af.train.wf</span><span class='op'>$</span><span class='va'>logRR</span>, 
                        label <span class='op'>=</span> <span class='st'>"XGBoost"</span><span class='op'>)</span>
  
<span class='co'># Cart model </span>
<span class='va'>explainer_cart_continous</span> <span class='op'>&lt;-</span> 
    <span class='fu'>DALEX</span><span class='fu'>::</span><span class='fu'><a href='https://dalex.drwhy.ai/reference/explain.html'>explain</a></span><span class='op'>(</span><span class='va'>cart_best_race_trained_wf</span>,
                        data <span class='op'>=</span> <span class='va'>af.train.wf</span>,
                        y <span class='op'>=</span> <span class='va'>af.train.wf</span><span class='op'>$</span><span class='va'>logRR</span>, 
                        label <span class='op'>=</span> <span class='st'>"Cart"</span><span class='op'>)</span>

<span class='co'># glm model </span>
<span class='va'>explainer_glm_continous</span> <span class='op'>&lt;-</span> 
    <span class='fu'>DALEX</span><span class='fu'>::</span><span class='fu'><a href='https://dalex.drwhy.ai/reference/explain.html'>explain</a></span><span class='op'>(</span><span class='va'>glm_best_race_trained_wf</span>,
                        data <span class='op'>=</span> <span class='va'>af.train.wf</span>,
                        y <span class='op'>=</span> <span class='va'>af.train.wf</span><span class='op'>$</span><span class='va'>logRR</span>, 
                        label <span class='op'>=</span> <span class='st'>"Glm"</span><span class='op'>)</span>
  
<span class='co'># SAVING THE EXPLAINERS</span>
<span class='fu'><a href='https://rdrr.io/r/base/readRDS.html'>saveRDS</a></span><span class='op'>(</span><span class='va'>explainer_rf_continous</span>, <span class='fu'>here</span><span class='fu'>::</span><span class='fu'><a href='https://here.r-lib.org//reference/here.html'>here</a></span><span class='op'>(</span><span class='st'>"TidyModWflSet_OUTPUT"</span>,<span class='st'>"explainer_rf_continous.RDS"</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/readRDS.html'>saveRDS</a></span><span class='op'>(</span><span class='va'>explainer_xgb_continous</span>, <span class='fu'>here</span><span class='fu'>::</span><span class='fu'><a href='https://here.r-lib.org//reference/here.html'>here</a></span><span class='op'>(</span><span class='st'>"TidyModWflSet_OUTPUT"</span>,<span class='st'>"explainer_xgb_continous.RDS"</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/readRDS.html'>saveRDS</a></span><span class='op'>(</span><span class='va'>explainer_cart_continous</span>, <span class='fu'>here</span><span class='fu'>::</span><span class='fu'><a href='https://here.r-lib.org//reference/here.html'>here</a></span><span class='op'>(</span><span class='st'>"TidyModWflSet_OUTPUT"</span>,<span class='st'>"explainer_cart_continous.RDS"</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/readRDS.html'>saveRDS</a></span><span class='op'>(</span><span class='va'>explainer_glm_continous</span>, <span class='fu'>here</span><span class='fu'>::</span><span class='fu'><a href='https://here.r-lib.org//reference/here.html'>here</a></span><span class='op'>(</span><span class='st'>"TidyModWflSet_OUTPUT"</span>,<span class='st'>"explainer_glm_continous.RDS"</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p>Preparation of a new explainer is initiated -&gt; model label : Random Forest -&gt; data : 3615 rows 44 cols -&gt; data : tibble converted into a data.frame -&gt; target variable : 3615 values -&gt; predict function : yhat.workflow will be used ( default ) -&gt; predicted values : No value for predict function target column. ( default ) -&gt; model_info : package tidymodels , ver. 0.1.3 , task regression ( default ) -&gt; predicted values : numerical, min = -1.018302 , mean = 0.3349902 , max = 2.071988<br />
-&gt; residual function : difference between y and yhat ( default ) -&gt; residuals : numerical, min = -2.327018 , mean = -4.570718e-05 , max = 2.509018<br />
A new explainer has been created!<br />
Preparation of a new explainer is initiated -&gt; model label : XGBoost -&gt; data : 3615 rows 44 cols -&gt; data : tibble converted into a data.frame -&gt; target variable : 3615 values -&gt; predict function : yhat.workflow will be used ( default ) -&gt; predicted values : No value for predict function target column. ( default ) -&gt; model_info : package tidymodels , ver. 0.1.3 , task regression ( default ) -&gt; predicted values : numerical, min = -0.9338058 , mean = 0.3374097 , max = 2.034106<br />
-&gt; residual function : difference between y and yhat ( default ) -&gt; residuals : numerical, min = -2.327787 , mean = -0.002465183 , max = 2.511293<br />
A new explainer has been created!<br />
Preparation of a new explainer is initiated -&gt; model label : Cart -&gt; data : 3615 rows 44 cols -&gt; data : tibble converted into a data.frame -&gt; target variable : 3615 values -&gt; predict function : yhat.workflow will be used ( default ) -&gt; predicted values : No value for predict function target column. ( default ) -&gt; model_info : package tidymodels , ver. 0.1.3 , task regression ( default ) -&gt; predicted values : numerical, min = -1.229517 , mean = 0.3349445 , max = 2.11079<br />
-&gt; residual function : difference between y and yhat ( default ) -&gt; residuals : numerical, min = -2.325893 , mean = -9.650476e-17 , max = 2.508948<br />
A new explainer has been created!<br />
Preparation of a new explainer is initiated -&gt; model label : Glm -&gt; data : 3615 rows 44 cols -&gt; data : tibble converted into a data.frame -&gt; target variable : 3615 values -&gt; predict function : yhat.workflow will be used ( default ) -&gt; predicted values : No value for predict function target column. ( default ) -&gt; model_info : package tidymodels , ver. 0.1.3 , task regression ( default ) -&gt; predicted values : numerical, min = -0.9418886 , mean = 0.3349445 , max = 2.01311<br />
-&gt; residual function : difference between y and yhat ( default ) -&gt; residuals : numerical, min = -2.325638 , mean = 6.247271e-14 , max = 2.509203<br />
A new explainer has been created!</p>
<h3 id="local-model-agnostics">Local model agnostics</h3>
<p>The model agnostic tools and functions in the DALEX and DALEXtsra packages can roughly be divided in “local model explanations” and “global model explanations.” The difference between the two is that for local model explanations they provide information about a prediction for a single observation. Global model explanations provide an overall understanding aggregated over a whole set of observations.</p>
<h2 id="step-12b-extracting-predicted-vs-observed-values-of-response-ratios-for-high-and-low-values">STEP 12b: Extracting predicted vs observed values of response ratios for high and low values</h2>
<p>We would need to first extract the values of each feature in a given observation to perform a local model agnostic/model explanation. Because we are interested in understanding the difference in feature importance between a predicted high response ratio value and a predicted low response ratio value, we need to identify two points in our dataset that has a hig RR value and a low RR value. This is done by identifying what feature combinations are associated with high and low RR values and then extracting those feature values.</p>
<p>We do this below by first searching across the training dataset for low RR values and then we isolate an observation with low RR based on the feature values combinations.</p>
<h3 id="exstracting-observation-for-low-and-high-response-ratio-value">Exstracting observation for <strong>low</strong> and <strong>high</strong> response ratio value</h3>
<p>Local model explanations provide information about a prediction for a single observation. For example, let’s consider an observation of Agroforestry Pruning-Alleycropping for the outcome Maize Crop Yield conducted at a Station with the agroforestry tree being Melia azedarach.</p>
<p>This observation has a relatively low response ratio value:</p>
<ul>
<li><strong>logRR = -1.812378756</strong></li>
</ul>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># Identifying value that has a low observed RR value</span>
<span class='va'>af.train.wf</span> <span class='op'>%&gt;%</span>
  <span class='fu'>relocate</span><span class='op'>(</span><span class='va'>logRR</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>arrange</span><span class='op'>(</span><span class='fu'>desc</span><span class='op'>(</span><span class='op'>-</span><span class='va'>logRR</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>dplyr</span><span class='fu'>::</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>PrName</span> <span class='op'>==</span> <span class='st'>"Agroforestry Pruning-Alleycropping"</span><span class='op'>)</span>
  
<span class='co'># Extracting the feature combinations (values) that the low RR value is associated with</span>
<span class='va'>vip_train_1</span> <span class='op'>&lt;-</span> <span class='va'>vip_train</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>dplyr</span><span class='fu'>::</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>PrName</span> <span class='op'>==</span> <span class='st'>"Agroforestry Pruning-Alleycropping"</span> <span class='op'>&amp;</span> 
                  <span class='va'>Out.SubInd</span> <span class='op'>==</span> <span class='st'>"Crop Yield"</span> <span class='op'>&amp;</span> 
                  <span class='va'>Product</span> <span class='op'>==</span> <span class='st'>"Maize"</span> <span class='op'>&amp;</span> 
                  <span class='va'>Tree</span> <span class='op'>==</span> <span class='st'>"Senna siamea"</span> <span class='op'>&amp;</span> 
                  <span class='va'>Site.Type</span> <span class='op'>==</span> <span class='st'>"Station"</span> <span class='op'>&amp;</span> 
                  <span class='va'>Latitude</span> <span class='op'>==</span> <span class='op'>-</span><span class='fl'>1.58240</span> <span class='op'>&amp;</span> 
                  <span class='va'>Longitude</span> <span class='op'>==</span> <span class='fl'>37.24320</span><span class='op'>)</span>

<span class='co'># Lastly, identifying an observation based on the extracted values. </span>
<span class='va'>obs_1</span> <span class='op'>&lt;-</span> <span class='va'>vip_train_1</span><span class='op'>[</span><span class='fl'>1</span>,<span class='op'>]</span>

<span class='co'># SAVING THE OBSERVATION</span>
<span class='fu'><a href='https://rdrr.io/r/base/readRDS.html'>saveRDS</a></span><span class='op'>(</span><span class='va'>obs_1</span>, <span class='fu'>here</span><span class='fu'>::</span><span class='fu'><a href='https://here.r-lib.org//reference/here.html'>here</a></span><span class='op'>(</span><span class='st'>"TidyModWflSet_OUTPUT"</span>,<span class='st'>"obs_1.RDS"</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body-outset">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>obs_1</span> <span class='op'>&lt;-</span>  <span class='fu'><a href='https://rdrr.io/r/base/readRDS.html'>readRDS</a></span><span class='op'>(</span><span class='fu'>here</span><span class='fu'>::</span><span class='fu'><a href='https://here.r-lib.org//reference/here.html'>here</a></span><span class='op'>(</span><span class='st'>"TidyModWflSet_OUTPUT"</span>,<span class='st'>"obs_1.RDS"</span><span class='op'>)</span><span class='op'>)</span>

<span class='fu'>rmarkdown</span><span class='fu'>::</span><span class='fu'><a href='https://pkgs.rstudio.com/rmarkdown/reference/paged_table.html'>paged_table</a></span><span class='op'>(</span><span class='va'>obs_1</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["PrName"],"name":[1],"type":["fct"],"align":["left"]},{"label":["Out.SubInd"],"name":[2],"type":["fct"],"align":["left"]},{"label":["Product"],"name":[3],"type":["fct"],"align":["left"]},{"label":["Tree"],"name":[4],"type":["fct"],"align":["left"]},{"label":["Out.SubInd.Code"],"name":[5],"type":["fct"],"align":["left"]},{"label":["Site.Type"],"name":[6],"type":["fct"],"align":["left"]},{"label":["Latitude"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["Longitude"],"name":[8],"type":["dbl"],"align":["right"]},{"label":["Bio01_MT_Annu"],"name":[9],"type":["dbl"],"align":["right"]},{"label":["Bio02_MDR"],"name":[10],"type":["dbl"],"align":["right"]},{"label":["Bio03_Iso"],"name":[11],"type":["dbl"],"align":["right"]},{"label":["Bio04_TS"],"name":[12],"type":["dbl"],"align":["right"]},{"label":["Bio05_TWM"],"name":[13],"type":["dbl"],"align":["right"]},{"label":["Bio06_MinTCM"],"name":[14],"type":["dbl"],"align":["right"]},{"label":["Bio07_TAR"],"name":[15],"type":["dbl"],"align":["right"]},{"label":["Bio08_MT_WetQ"],"name":[16],"type":["dbl"],"align":["right"]},{"label":["Bio09_MT_DryQ"],"name":[17],"type":["dbl"],"align":["right"]},{"label":["Bio10_MT_WarQ"],"name":[18],"type":["dbl"],"align":["right"]},{"label":["Bio11_MT_ColQ"],"name":[19],"type":["dbl"],"align":["right"]},{"label":["Bio12_Pecip_Annu"],"name":[20],"type":["dbl"],"align":["right"]},{"label":["Bio13_Precip_WetM"],"name":[21],"type":["dbl"],"align":["right"]},{"label":["Bio14_Precip_DryM"],"name":[22],"type":["dbl"],"align":["right"]},{"label":["Bio15_Precip_S"],"name":[23],"type":["dbl"],"align":["right"]},{"label":["Bio16_Precip_WetQ"],"name":[24],"type":["dbl"],"align":["right"]},{"label":["Bio17_Precip_DryQ"],"name":[25],"type":["dbl"],"align":["right"]},{"label":["iSDA_Depth_to_bedrock"],"name":[26],"type":["dbl"],"align":["right"]},{"label":["iSDA_SAND_conc"],"name":[27],"type":["dbl"],"align":["right"]},{"label":["iSDA_CLAY_conc"],"name":[28],"type":["dbl"],"align":["right"]},{"label":["iSDA_SILT_conc"],"name":[29],"type":["dbl"],"align":["right"]},{"label":["iSDA_log_C_tot"],"name":[30],"type":["dbl"],"align":["right"]},{"label":["iSDA_FE_Bulk_dens"],"name":[31],"type":["dbl"],"align":["right"]},{"label":["iSDA_log_Ca"],"name":[32],"type":["dbl"],"align":["right"]},{"label":["iSDA_log_eCEC"],"name":[33],"type":["dbl"],"align":["right"]},{"label":["iSDA_log_Fe"],"name":[34],"type":["dbl"],"align":["right"]},{"label":["iSDA_log_K"],"name":[35],"type":["dbl"],"align":["right"]},{"label":["iSDA_log_Mg"],"name":[36],"type":["dbl"],"align":["right"]},{"label":["iSDA_log_N"],"name":[37],"type":["dbl"],"align":["right"]},{"label":["iSDA_log_SOC"],"name":[38],"type":["dbl"],"align":["right"]},{"label":["iSDA_log_P"],"name":[39],"type":["dbl"],"align":["right"]},{"label":["iSDA_log_S"],"name":[40],"type":["dbl"],"align":["right"]},{"label":["iSDA_pH"],"name":[41],"type":["dbl"],"align":["right"]},{"label":["ASTER_Altitude"],"name":[42],"type":["dbl"],"align":["right"]},{"label":["ASTER_Slope"],"name":[43],"type":["dbl"],"align":["right"]}],"data":[{"1":"Agroforestry Pruning-Alleycropping","2":"Crop Yield","3":"Maize","4":"Senna siamea","5":"CrY","6":"Station","7":"-1.5824","8":"37.2432","9":"21.61667","10":"9.716667","11":"83.04844","12":"52.88638","13":"27.5","14":"15.8","15":"11.7","16":"21.8","17":"20.91667","18":"22.28333","19":"20.91667","20":"1316","21":"227","22":"42","23":"53.04502","24":"585","25":"168","26":"199.99","27":"48.582","28":"33.402","29":"16.748","30":"27.514","31":"132.154","32":"67.774","33":"27.786","34":"35.182","35":"53.296","36":"55.09","37":"60.844","38":"22.29","39":"24.798","40":"17.79","41":"59.784","42":"1578.35","43":"4.2"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<p>Let’s consider another observation of Agroforestry Pruning-Alleycropping with the outcome Maize Crop Yield conducted at a Station with the agroforestry tree being Senna siamea.</p>
<p>This observation has a relatively high response ratio value:</p>
<ul>
<li><strong>logRR = 3.047025568</strong></li>
</ul>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># Identifying value that has a high observed RR value</span>
<span class='va'>af.train.wf</span> <span class='op'>%&gt;%</span>
  <span class='fu'>relocate</span><span class='op'>(</span><span class='va'>logRR</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>arrange</span><span class='op'>(</span><span class='fu'>desc</span><span class='op'>(</span><span class='va'>logRR</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>dplyr</span><span class='fu'>::</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>PrName</span> <span class='op'>==</span> <span class='st'>"Agroforestry Pruning-Alleycropping"</span><span class='op'>)</span>

<span class='co'># Extracting the feature combinations (values) that the high RR value is associated with</span>
<span class='va'>vip_train_2</span> <span class='op'>&lt;-</span> <span class='va'>vip_train</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>dplyr</span><span class='fu'>::</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>PrName</span> <span class='op'>==</span> <span class='st'>"Agroforestry Pruning-Alleycropping"</span> <span class='op'>&amp;</span> 
                  <span class='va'>Out.SubInd</span> <span class='op'>==</span> <span class='st'>"Crop Yield"</span> <span class='op'>&amp;</span> 
                  <span class='va'>Product</span> <span class='op'>==</span> <span class='st'>"Maize"</span> <span class='op'>&amp;</span> 
                  <span class='va'>Tree</span> <span class='op'>==</span> <span class='st'>"Senna siamea"</span> <span class='op'>&amp;</span> 
                  <span class='va'>Site.Type</span> <span class='op'>==</span> <span class='st'>"Station"</span> <span class='op'>&amp;</span> 
                  <span class='va'>Latitude</span> <span class='op'>==</span> <span class='fl'>7.49800</span> <span class='op'>&amp;</span> 
                  <span class='va'>Longitude</span> <span class='op'>==</span> <span class='fl'>3.90300</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>mutate</span><span class='op'>(</span><span class='fu'>across</span><span class='op'>(</span><span class='fu'>where</span><span class='op'>(</span><span class='va'>is.numeric</span><span class='op'>)</span>, <span class='op'>~</span> <span class='fu'><a href='https://rdrr.io/r/base/Round.html'>round</a></span><span class='op'>(</span><span class='va'>.</span>, <span class='fl'>8</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>

<span class='co'># Lastly, identifying an observation based on the extracted values. </span>
<span class='va'>obs_2</span> <span class='op'>&lt;-</span> <span class='va'>vip_train_2</span><span class='op'>[</span><span class='fl'>1</span>,<span class='op'>]</span>

<span class='co'># SAVING THE OBSERVATION</span>
<span class='fu'><a href='https://rdrr.io/r/base/readRDS.html'>saveRDS</a></span><span class='op'>(</span><span class='va'>obs_2</span>, <span class='fu'>here</span><span class='fu'>::</span><span class='fu'><a href='https://here.r-lib.org//reference/here.html'>here</a></span><span class='op'>(</span><span class='st'>"TidyModWflSet_OUTPUT"</span>,<span class='st'>"obs_2.RDS"</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body-outset">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>obs_2</span> <span class='op'>&lt;-</span>  <span class='fu'><a href='https://rdrr.io/r/base/readRDS.html'>readRDS</a></span><span class='op'>(</span><span class='fu'>here</span><span class='fu'>::</span><span class='fu'><a href='https://here.r-lib.org//reference/here.html'>here</a></span><span class='op'>(</span><span class='st'>"TidyModWflSet_OUTPUT"</span>,<span class='st'>"obs_2.RDS"</span><span class='op'>)</span><span class='op'>)</span>

<span class='fu'>rmarkdown</span><span class='fu'>::</span><span class='fu'><a href='https://pkgs.rstudio.com/rmarkdown/reference/paged_table.html'>paged_table</a></span><span class='op'>(</span><span class='va'>obs_2</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["PrName"],"name":[1],"type":["fct"],"align":["left"]},{"label":["Out.SubInd"],"name":[2],"type":["fct"],"align":["left"]},{"label":["Product"],"name":[3],"type":["fct"],"align":["left"]},{"label":["Tree"],"name":[4],"type":["fct"],"align":["left"]},{"label":["Out.SubInd.Code"],"name":[5],"type":["fct"],"align":["left"]},{"label":["Site.Type"],"name":[6],"type":["fct"],"align":["left"]},{"label":["Latitude"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["Longitude"],"name":[8],"type":["dbl"],"align":["right"]},{"label":["Bio01_MT_Annu"],"name":[9],"type":["dbl"],"align":["right"]},{"label":["Bio02_MDR"],"name":[10],"type":["dbl"],"align":["right"]},{"label":["Bio03_Iso"],"name":[11],"type":["dbl"],"align":["right"]},{"label":["Bio04_TS"],"name":[12],"type":["dbl"],"align":["right"]},{"label":["Bio05_TWM"],"name":[13],"type":["dbl"],"align":["right"]},{"label":["Bio06_MinTCM"],"name":[14],"type":["dbl"],"align":["right"]},{"label":["Bio07_TAR"],"name":[15],"type":["dbl"],"align":["right"]},{"label":["Bio08_MT_WetQ"],"name":[16],"type":["dbl"],"align":["right"]},{"label":["Bio09_MT_DryQ"],"name":[17],"type":["dbl"],"align":["right"]},{"label":["Bio10_MT_WarQ"],"name":[18],"type":["dbl"],"align":["right"]},{"label":["Bio11_MT_ColQ"],"name":[19],"type":["dbl"],"align":["right"]},{"label":["Bio12_Pecip_Annu"],"name":[20],"type":["dbl"],"align":["right"]},{"label":["Bio13_Precip_WetM"],"name":[21],"type":["dbl"],"align":["right"]},{"label":["Bio14_Precip_DryM"],"name":[22],"type":["dbl"],"align":["right"]},{"label":["Bio15_Precip_S"],"name":[23],"type":["dbl"],"align":["right"]},{"label":["Bio16_Precip_WetQ"],"name":[24],"type":["dbl"],"align":["right"]},{"label":["Bio17_Precip_DryQ"],"name":[25],"type":["dbl"],"align":["right"]},{"label":["iSDA_Depth_to_bedrock"],"name":[26],"type":["dbl"],"align":["right"]},{"label":["iSDA_SAND_conc"],"name":[27],"type":["dbl"],"align":["right"]},{"label":["iSDA_CLAY_conc"],"name":[28],"type":["dbl"],"align":["right"]},{"label":["iSDA_SILT_conc"],"name":[29],"type":["dbl"],"align":["right"]},{"label":["iSDA_log_C_tot"],"name":[30],"type":["dbl"],"align":["right"]},{"label":["iSDA_FE_Bulk_dens"],"name":[31],"type":["dbl"],"align":["right"]},{"label":["iSDA_log_Ca"],"name":[32],"type":["dbl"],"align":["right"]},{"label":["iSDA_log_eCEC"],"name":[33],"type":["dbl"],"align":["right"]},{"label":["iSDA_log_Fe"],"name":[34],"type":["dbl"],"align":["right"]},{"label":["iSDA_log_K"],"name":[35],"type":["dbl"],"align":["right"]},{"label":["iSDA_log_Mg"],"name":[36],"type":["dbl"],"align":["right"]},{"label":["iSDA_log_N"],"name":[37],"type":["dbl"],"align":["right"]},{"label":["iSDA_log_SOC"],"name":[38],"type":["dbl"],"align":["right"]},{"label":["iSDA_log_P"],"name":[39],"type":["dbl"],"align":["right"]},{"label":["iSDA_log_S"],"name":[40],"type":["dbl"],"align":["right"]},{"label":["iSDA_pH"],"name":[41],"type":["dbl"],"align":["right"]},{"label":["ASTER_Altitude"],"name":[42],"type":["dbl"],"align":["right"]},{"label":["ASTER_Slope"],"name":[43],"type":["dbl"],"align":["right"]}],"data":[{"1":"Agroforestry Pruning-Alleycropping","2":"Crop Yield","3":"Maize","4":"Senna siamea","5":"CrY","6":"Station","7":"7.498","8":"3.903","9":"16.975","10":"11.21667","11":"51.92901","12":"377.2056","13":"28.4","14":"6.8","15":"21.6","16":"12.31667","17":"21.45","18":"21.45","19":"12.31667","20":"737","21":"120","22":"20","23":"62.46448","24":"341","25":"67","26":"199.95","27":"63.186","28":"19.604","29":"13.486","30":"29.264","31":"141.138","32":"61.956","33":"20.284","34":"38.788","35":"41.31","36":"45.69","37":"55.754","38":"17.986","39":"20.144","40":"19.34","41":"60.588","42":"218.75","43":"2.39"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<h2 id="step-12c-model-break-down-plots">STEP 12c: Model break-down plots</h2>
<p>Probably the most commonly asked question when trying to understand a model’s prediction for a single observation is: which variables contribute to this result the most? There is no single best approach that can be used to answer this question, but the break-down plots come pretty close. They offer a possible solution to present “variable attributions,” e.g., the decomposition of the model’s prediction into contributions that can be attributed to different explanatory variables/features. Break-down plots are very intuitive. The green and red bars indicate, respectively, positive and negative changes in the mean predictions (contributions attributed to explanatory variables).</p>
<h3 id="generating-break-down-data-for-all-the-four-models">Generating break-down data for all the four models</h3>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>rf_breakdown</span> <span class='op'>&lt;-</span> 
  <span class='fu'>predict_parts</span><span class='op'>(</span>explainer <span class='op'>=</span> <span class='va'>explainer_rf</span>, new_observation <span class='op'>=</span> <span class='va'>obs_1</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>arrange</span><span class='op'>(</span><span class='fu'>desc</span><span class='op'>(</span><span class='op'>-</span><span class='va'>contribution</span><span class='op'>)</span><span class='op'>)</span>

<span class='co'># SAVING THE BREAK-DOWN DATA</span>
<span class='fu'><a href='https://rdrr.io/r/base/readRDS.html'>saveRDS</a></span><span class='op'>(</span><span class='va'>rf_breakdown</span>, <span class='fu'>here</span><span class='fu'>::</span><span class='fu'><a href='https://here.r-lib.org//reference/here.html'>here</a></span><span class='op'>(</span><span class='st'>"TidyModWflSet_OUTPUT"</span>,<span class='st'>"rf_breakdown.RDS"</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>xgb_breakdown</span> <span class='op'>&lt;-</span> 
  <span class='fu'>predict_parts</span><span class='op'>(</span>explainer <span class='op'>=</span> <span class='va'>explainer_xgb</span>, new_observation <span class='op'>=</span> <span class='va'>obs_1</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>arrange</span><span class='op'>(</span><span class='fu'>desc</span><span class='op'>(</span><span class='op'>-</span><span class='va'>contribution</span><span class='op'>)</span><span class='op'>)</span>

<span class='co'># SAVING THE BREAK-DOWN DATA</span>
<span class='fu'><a href='https://rdrr.io/r/base/readRDS.html'>saveRDS</a></span><span class='op'>(</span><span class='va'>xgb_breakdown</span>, <span class='fu'>here</span><span class='fu'>::</span><span class='fu'><a href='https://here.r-lib.org//reference/here.html'>here</a></span><span class='op'>(</span><span class='st'>"TidyModWflSet_OUTPUT"</span>,<span class='st'>"xgb_breakdown.RDS"</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>cart_breakdown</span> <span class='op'>&lt;-</span> 
  <span class='fu'>predict_parts</span><span class='op'>(</span>explainer <span class='op'>=</span> <span class='va'>explainer_cart</span>, new_observation <span class='op'>=</span> <span class='va'>obs_1</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>arrange</span><span class='op'>(</span><span class='fu'>desc</span><span class='op'>(</span><span class='op'>-</span><span class='va'>contribution</span><span class='op'>)</span><span class='op'>)</span>

<span class='co'># SAVING THE BREAK-DOWN DATA</span>
<span class='fu'><a href='https://rdrr.io/r/base/readRDS.html'>saveRDS</a></span><span class='op'>(</span><span class='va'>cart_breakdown</span>, <span class='fu'>here</span><span class='fu'>::</span><span class='fu'><a href='https://here.r-lib.org//reference/here.html'>here</a></span><span class='op'>(</span><span class='st'>"TidyModWflSet_OUTPUT"</span>,<span class='st'>"cart_breakdown.RDS"</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>glm_breakdown</span> <span class='op'>&lt;-</span> 
  <span class='fu'>predict_parts</span><span class='op'>(</span>explainer <span class='op'>=</span> <span class='va'>explainer_glm</span>, new_observation <span class='op'>=</span> <span class='va'>obs_1</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>arrange</span><span class='op'>(</span><span class='fu'>desc</span><span class='op'>(</span><span class='op'>-</span><span class='va'>contribution</span><span class='op'>)</span><span class='op'>)</span>

<span class='co'># SAVING THE BREAK-DOWN DATA</span>
<span class='fu'><a href='https://rdrr.io/r/base/readRDS.html'>saveRDS</a></span><span class='op'>(</span><span class='va'>glm_breakdown</span>, <span class='fu'>here</span><span class='fu'>::</span><span class='fu'><a href='https://here.r-lib.org//reference/here.html'>here</a></span><span class='op'>(</span><span class='st'>"TidyModWflSet_OUTPUT"</span>,<span class='st'>"glm_breakdown.RDS"</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<h3 id="break-down-of-individial-model-parts">Break-down of individial model parts</h3>
<p>Model break-down explanations like these depend on the order of the features. We can use the predict_parts function from the DALEX package again but this time with an ordering argument based on the variable names. We also add the explainer we created in STEP 12b. This will generate a column with information on how much each feature, as dependent on its value, contribute to the actual prediction:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>predict_parts_rf</span> <span class='op'>&lt;-</span> <span class='fu'>predict_parts</span><span class='op'>(</span>explainer <span class='op'>=</span> <span class='va'>explainer_rf</span>, 
                                  new_observation <span class='op'>=</span> <span class='va'>obs_1</span>,
                                  order <span class='op'>=</span> <span class='va'>rf_breakdown</span><span class='op'>$</span><span class='va'>variable_name</span><span class='op'>)</span>

<span class='co'># SAVING THE BREAK-DOWN PREDICT PARTS</span>
<span class='fu'><a href='https://rdrr.io/r/base/readRDS.html'>saveRDS</a></span><span class='op'>(</span><span class='va'>predict_parts_rf</span>, <span class='fu'>here</span><span class='fu'>::</span><span class='fu'><a href='https://here.r-lib.org//reference/here.html'>here</a></span><span class='op'>(</span><span class='st'>"TidyModWflSet_OUTPUT"</span>,<span class='st'>"predict_parts_rf.RDS"</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body-outset">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>predict_parts_rf</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/readRDS.html'>readRDS</a></span><span class='op'>(</span><span class='fu'>here</span><span class='fu'>::</span><span class='fu'><a href='https://here.r-lib.org//reference/here.html'>here</a></span><span class='op'>(</span><span class='st'>"TidyModWflSet_OUTPUT"</span>,<span class='st'>"predict_parts_rf.RDS"</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'>rmarkdown</span><span class='fu'>::</span><span class='fu'><a href='https://pkgs.rstudio.com/rmarkdown/reference/paged_table.html'>paged_table</a></span><span class='op'>(</span><span class='va'>predict_parts_rf</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["variable"],"name":[1],"type":["chr"],"align":["left"]},{"label":["contribution"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["variable_name"],"name":[3],"type":["chr"],"align":["left"]},{"label":["variable_value"],"name":[4],"type":["chr"],"align":["left"]},{"label":["cumulative"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["sign"],"name":[6],"type":["fct"],"align":["left"]},{"label":["position"],"name":[7],"type":["int"],"align":["right"]},{"label":["label"],"name":[8],"type":["chr"],"align":["left"]}],"data":[{"1":"intercept","2":"3.349902e-01","3":"intercept","4":"1","5":"0.33499022","6":"1","7":"45","8":"Random Forest with normalized data"},{"1":"iSDA_SILT_conc = 16.748","2":"-1.834877e-01","3":"iSDA_SILT_conc","4":"16.748","5":"0.15150256","6":"-1","7":"44","8":"Random Forest with normalized data"},{"1":"Bio14_Precip_DryM = 42","2":"-5.679067e-02","3":"Bio14_Precip_DryM","4":"42","5":"0.09471190","6":"-1","7":"43","8":"Random Forest with normalized data"},{"1":"iSDA_log_K = 53.296","2":"-5.798749e-02","3":"iSDA_log_K","4":"53.296","5":"0.03672441","6":"-1","7":"42","8":"Random Forest with normalized data"},{"1":"iSDA_log_Ca = 67.774","2":"-5.686927e-02","3":"iSDA_log_Ca","4":"67.774","5":"-0.02014487","6":"-1","7":"41","8":"Random Forest with normalized data"},{"1":"iSDA_CLAY_conc = 33.402","2":"-2.975090e-02","3":"iSDA_CLAY_conc","4":"33.402","5":"-0.04989577","6":"-1","7":"40","8":"Random Forest with normalized data"},{"1":"Bio05_TWM = 27.5","2":"-1.366905e-02","3":"Bio05_TWM","4":"27.5","5":"-0.06356482","6":"-1","7":"39","8":"Random Forest with normalized data"},{"1":"Bio16_Precip_WetQ = 585","2":"-2.982717e-02","3":"Bio16_Precip_WetQ","4":"585","5":"-0.09339199","6":"-1","7":"38","8":"Random Forest with normalized data"},{"1":"iSDA_SAND_conc = 48.582","2":"-4.757496e-02","3":"iSDA_SAND_conc","4":"48.582","5":"-0.14096695","6":"-1","7":"37","8":"Random Forest with normalized data"},{"1":"Bio13_Precip_WetM = 227","2":"-1.111164e-02","3":"Bio13_Precip_WetM","4":"227","5":"-0.15207860","6":"-1","7":"36","8":"Random Forest with normalized data"},{"1":"Bio12_Pecip_Annu = 1316","2":"-7.682421e-03","3":"Bio12_Pecip_Annu","4":"1316","5":"-0.15976102","6":"-1","7":"35","8":"Random Forest with normalized data"},{"1":"iSDA_pH = 59.784","2":"-4.133038e-02","3":"iSDA_pH","4":"59.784","5":"-0.20109140","6":"-1","7":"34","8":"Random Forest with normalized data"},{"1":"Bio08_MT_WetQ = 21.7999992370605","2":"-1.058663e-02","3":"Bio08_MT_WetQ","4":"21.7999992370605","5":"-0.21167803","6":"-1","7":"33","8":"Random Forest with normalized data"},{"1":"Bio02_MDR = 9.71666717529297","2":"-4.655997e-03","3":"Bio02_MDR","4":"9.71666717529297","5":"-0.21633403","6":"-1","7":"32","8":"Random Forest with normalized data"},{"1":"iSDA_Depth_to_bedrock = 199.99","2":"-1.237322e-02","3":"iSDA_Depth_to_bedrock","4":"199.99","5":"-0.22870725","6":"-1","7":"31","8":"Random Forest with normalized data"},{"1":"Bio15_Precip_S = 53.0450210571289","2":"-2.473739e-03","3":"Bio15_Precip_S","4":"53.0450210571289","5":"-0.23118099","6":"-1","7":"30","8":"Random Forest with normalized data"},{"1":"Bio01_MT_Annu = 21.6166667938232","2":"-6.443565e-03","3":"Bio01_MT_Annu","4":"21.6166667938232","5":"-0.23762456","6":"-1","7":"29","8":"Random Forest with normalized data"},{"1":"Bio06_MinTCM = 15.8000001907349","2":"-5.698535e-03","3":"Bio06_MinTCM","4":"15.8000001907349","5":"-0.24332309","6":"-1","7":"28","8":"Random Forest with normalized data"},{"1":"iSDA_log_C_tot = 27.514","2":"-4.784011e-03","3":"iSDA_log_C_tot","4":"27.514","5":"-0.24810710","6":"-1","7":"27","8":"Random Forest with normalized data"},{"1":"Bio17_Precip_DryQ = 168","2":"-2.598387e-03","3":"Bio17_Precip_DryQ","4":"168","5":"-0.25070549","6":"-1","7":"26","8":"Random Forest with normalized data"},{"1":"Bio09_MT_DryQ = 20.9166660308838","2":"-2.049153e-03","3":"Bio09_MT_DryQ","4":"20.9166660308838","5":"-0.25275464","6":"-1","7":"25","8":"Random Forest with normalized data"},{"1":"Bio11_MT_ColQ = 20.9166660308838","2":"-2.431129e-03","3":"Bio11_MT_ColQ","4":"20.9166660308838","5":"-0.25518577","6":"-1","7":"24","8":"Random Forest with normalized data"},{"1":"iSDA_log_N = 60.844","2":"-3.036639e-03","3":"iSDA_log_N","4":"60.844","5":"-0.25822241","6":"-1","7":"23","8":"Random Forest with normalized data"},{"1":"Bio03_Iso = 83.0484390258789","2":"-5.233504e-03","3":"Bio03_Iso","4":"83.0484390258789","5":"-0.26345592","6":"-1","7":"22","8":"Random Forest with normalized data"},{"1":"Bio10_MT_WarQ = 22.283332824707","2":"-6.971457e-03","3":"Bio10_MT_WarQ","4":"22.283332824707","5":"-0.27042737","6":"-1","7":"21","8":"Random Forest with normalized data"},{"1":"iSDA_log_SOC = 22.29","2":"1.669891e-03","3":"iSDA_log_SOC","4":"22.29","5":"-0.26875748","6":"1","7":"20","8":"Random Forest with normalized data"},{"1":"PrName = 5","2":"0.000000e+00","3":"PrName","4":"5","5":"-0.26875748","6":"0","7":"19","8":"Random Forest with normalized data"},{"1":"Out.SubInd = 4","2":"0.000000e+00","3":"Out.SubInd","4":"4","5":"-0.26875748","6":"0","7":"18","8":"Random Forest with normalized data"},{"1":"Product = 2","2":"0.000000e+00","3":"Product","4":"2","5":"-0.26875748","6":"0","7":"17","8":"Random Forest with normalized data"},{"1":"Tree = 30","2":"0.000000e+00","3":"Tree","4":"30","5":"-0.26875748","6":"0","7":"16","8":"Random Forest with normalized data"},{"1":"Out.SubInd.Code = 4","2":"0.000000e+00","3":"Out.SubInd.Code","4":"4","5":"-0.26875748","6":"0","7":"15","8":"Random Forest with normalized data"},{"1":"Longitude = 37.2432","2":"-8.418663e-05","3":"Longitude","4":"37.2432","5":"-0.26884167","6":"-1","7":"14","8":"Random Forest with normalized data"},{"1":"Latitude = -1.5824","2":"1.296051e-03","3":"Latitude","4":"-1.5824","5":"-0.26754562","6":"1","7":"13","8":"Random Forest with normalized data"},{"1":"iSDA_log_Fe = 35.182","2":"2.659191e-03","3":"iSDA_log_Fe","4":"35.182","5":"-0.26488643","6":"1","7":"12","8":"Random Forest with normalized data"},{"1":"iSDA_log_eCEC = 27.786","2":"2.023445e-02","3":"iSDA_log_eCEC","4":"27.786","5":"-0.24465197","6":"1","7":"11","8":"Random Forest with normalized data"},{"1":"Site.Type = 2","2":"2.711688e-03","3":"Site.Type","4":"2","5":"-0.24194028","6":"1","7":"10","8":"Random Forest with normalized data"},{"1":"iSDA_log_S = 17.79","2":"3.407773e-03","3":"iSDA_log_S","4":"17.79","5":"-0.23853251","6":"1","7":"9","8":"Random Forest with normalized data"},{"1":"Bio07_TAR = 11.6999998092651","2":"7.752269e-03","3":"Bio07_TAR","4":"11.6999998092651","5":"-0.23078024","6":"1","7":"8","8":"Random Forest with normalized data"},{"1":"iSDA_log_P = 24.798","2":"4.343723e-04","3":"iSDA_log_P","4":"24.798","5":"-0.23034587","6":"1","7":"7","8":"Random Forest with normalized data"},{"1":"ASTER_Slope = 4.2","2":"-1.211421e-03","3":"ASTER_Slope","4":"4.2","5":"-0.23155729","6":"-1","7":"6","8":"Random Forest with normalized data"},{"1":"iSDA_FE_Bulk_dens = 132.154","2":"4.138087e-03","3":"iSDA_FE_Bulk_dens","4":"132.154","5":"-0.22741920","6":"1","7":"5","8":"Random Forest with normalized data"},{"1":"iSDA_log_Mg = 55.09","2":"1.626076e-03","3":"iSDA_log_Mg","4":"55.09","5":"-0.22579313","6":"1","7":"4","8":"Random Forest with normalized data"},{"1":"Bio04_TS = 52.8863792419434","2":"-2.641817e-02","3":"Bio04_TS","4":"52.8863792419434","5":"-0.25221129","6":"-1","7":"3","8":"Random Forest with normalized data"},{"1":"ASTER_Altitude = 1578.35","2":"-7.829846e-02","3":"ASTER_Altitude","4":"1578.35","5":"-0.33050976","6":"-1","7":"2","8":"Random Forest with normalized data"},{"1":"prediction","2":"-3.305098e-01","3":"","4":"","5":"-0.33050976","6":"X","7":"1","8":"Random Forest with normalized data"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<h3 id="step-12d-visualising-break-down-of-individial-model-parts-for-the-case-of-obs_1-low-rr-value--1.82">STEP 12d: Visualising break-down of individial model parts for the case of obs_1 (low RR value = -1.82)</h3>
<p><strong>Random Forest model</strong></p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>bd_rf_logRR_low</span> <span class='op'>&lt;-</span> 
  <span class='fu'>predict_parts</span><span class='op'>(</span>explainer <span class='op'>=</span> <span class='va'>explainer_rf_continous</span>,
                new_observation <span class='op'>=</span> <span class='va'>obs_1</span>, 
                type <span class='op'>=</span> <span class='st'>"break_down"</span><span class='op'>)</span> 

<span class='co'># SAVING THE BREAK-DOWN PLOT DATA</span>
<span class='co'># saveRDS(bd_rf_logRR_low, here::here("TidyModWflSet_OUTPUT","bd_rf_logRR_low.RDS"))</span>

<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>bd_rf_logRR_low</span>,
     max_features <span class='op'>=</span> <span class='fl'>20</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>ggtitle</span><span class='op'>(</span><span class='st'>"Break Down profile for Agroforestry Pruning-Alleycropping with a low observed logRR value (-1.82)"</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>theme</span><span class='op'>(</span>panel.grid <span class='op'>=</span> <span class='fu'>element_blank</span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-screen-inset shaded">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>ggdraw</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span> 
  <span class='fu'>draw_image</span><span class='op'>(</span><span class='fu'>here</span><span class='fu'>::</span><span class='fu'><a href='https://here.r-lib.org//reference/here.html'>here</a></span><span class='op'>(</span><span class='st'>"TidyModWflSet_OUTPUT"</span>, <span class='st'>"bd_rf_logRR_low.png"</span><span class='op'>)</span><span class='op'>)</span> 
</code></pre>
</div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-4"></span>
<img src="TIDYMODELSWFS_files/figure-html5/unnamed-chunk-4-1.png" alt="Break-down plot of individial model parts for the Random Forest model low RR" width="576" />
<p class="caption">
Figure 4: Break-down plot of individial model parts for the Random Forest model low RR
</p>
</div>
</div>
<p><strong>XGBoost model</strong></p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>bd_xgb_logRR_low</span> <span class='op'>&lt;-</span> 
  <span class='fu'>predict_parts</span><span class='op'>(</span>explainer <span class='op'>=</span> <span class='va'>explainer_xgb_continous</span>,
                new_observation <span class='op'>=</span> <span class='va'>obs_1</span>, 
                type <span class='op'>=</span> <span class='st'>"break_down"</span><span class='op'>)</span> 

<span class='co'># SAVING THE BREAK-DOWN PLOT DATA</span>
<span class='co'># saveRDS(bd_xgb_logRR_low, here::here("TidyModWflSet_OUTPUT","bd_xgb_logRR_low.RDS"))</span>

<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>bd_xgb_logRR_low</span>,
     max_features <span class='op'>=</span> <span class='fl'>20</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>ggtitle</span><span class='op'>(</span><span class='st'>"Break Down profile for Agroforestry Pruning-Alleycropping with a low observed logRR value (-1.82)"</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>theme</span><span class='op'>(</span>panel.grid <span class='op'>=</span> <span class='fu'>element_blank</span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span> 
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-screen-inset shaded">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>ggdraw</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span> 
  <span class='fu'>draw_image</span><span class='op'>(</span><span class='fu'>here</span><span class='fu'>::</span><span class='fu'><a href='https://here.r-lib.org//reference/here.html'>here</a></span><span class='op'>(</span><span class='st'>"TidyModWflSet_OUTPUT"</span>, <span class='st'>"bd_xgb_logRR_low.png"</span><span class='op'>)</span><span class='op'>)</span> 
</code></pre>
</div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-5"></span>
<img src="TIDYMODELSWFS_files/figure-html5/unnamed-chunk-5-1.png" alt="Break-down plot of individial model parts for the XGBoost model low RR" width="576" />
<p class="caption">
Figure 5: Break-down plot of individial model parts for the XGBoost model low RR
</p>
</div>
</div>
<p><strong>cart model</strong></p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>bd_cart_logRR_low</span> <span class='op'>&lt;-</span> 
  <span class='fu'>predict_parts</span><span class='op'>(</span>explainer <span class='op'>=</span> <span class='va'>explainer_cart_continous</span>,
                new_observation <span class='op'>=</span> <span class='va'>obs_1</span>, 
                type <span class='op'>=</span> <span class='st'>"break_down"</span><span class='op'>)</span> 

<span class='co'># SAVING THE BREAK-DOWN PLOT DATA</span>
<span class='co'># saveRDS(bd_cart_logRR_low, here::here("TidyModWflSet_OUTPUT","bd_cart_logRR_low.RDS"))</span>

<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>bd_cart_logRR_low</span>,
     max_features <span class='op'>=</span> <span class='fl'>20</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>ggtitle</span><span class='op'>(</span><span class='st'>"Break Down profile for Agroforestry Pruning-Alleycropping with a low observed logRR value (-1.82)"</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>theme</span><span class='op'>(</span>panel.grid <span class='op'>=</span> <span class='fu'>element_blank</span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span> 
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-screen-inset shaded">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>ggdraw</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span> 
  <span class='fu'>draw_image</span><span class='op'>(</span><span class='fu'>here</span><span class='fu'>::</span><span class='fu'><a href='https://here.r-lib.org//reference/here.html'>here</a></span><span class='op'>(</span><span class='st'>"TidyModWflSet_OUTPUT"</span>, <span class='st'>"bd_cart_logRR_low.png"</span><span class='op'>)</span><span class='op'>)</span> 
</code></pre>
</div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-6"></span>
<img src="TIDYMODELSWFS_files/figure-html5/unnamed-chunk-6-1.png" alt="Break-down plot of individial model parts for the cart model low RR" width="576" />
<p class="caption">
Figure 6: Break-down plot of individial model parts for the cart model low RR
</p>
</div>
</div>
<p><strong>glm model</strong></p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>bd_glm_logRR_low</span> <span class='op'>&lt;-</span> 
  <span class='fu'>predict_parts</span><span class='op'>(</span>explainer <span class='op'>=</span> <span class='va'>explainer_glm_continous</span>,
                new_observation <span class='op'>=</span> <span class='va'>obs_1</span>, 
                type <span class='op'>=</span> <span class='st'>"break_down"</span><span class='op'>)</span> 

<span class='co'># SAVING THE BREAK-DOWN PLOT DATA</span>
<span class='co'># saveRDS(bd_glm_logRR_low, here::here("TidyModWflSet_OUTPUT","bd_glm_logRR_low.RDS"))</span>

<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>bd_glm_logRR_low</span>,
     max_features <span class='op'>=</span> <span class='fl'>20</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>ggtitle</span><span class='op'>(</span><span class='st'>"Break Down profile for Agroforestry Pruning-Alleycropping with a low observed logRR value (-1.82)"</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>theme</span><span class='op'>(</span>panel.grid <span class='op'>=</span> <span class='fu'>element_blank</span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span> 
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-screen-inset shaded">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>ggdraw</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span> 
  <span class='fu'>draw_image</span><span class='op'>(</span><span class='fu'>here</span><span class='fu'>::</span><span class='fu'><a href='https://here.r-lib.org//reference/here.html'>here</a></span><span class='op'>(</span><span class='st'>"TidyModWflSet_OUTPUT"</span>, <span class='st'>"bd_cart_logRR_low.png"</span><span class='op'>)</span><span class='op'>)</span> 
</code></pre>
</div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-7"></span>
<img src="TIDYMODELSWFS_files/figure-html5/unnamed-chunk-7-1.png" alt="Break-down plot of individial model parts for the glm model low RR" width="576" />
<p class="caption">
Figure 7: Break-down plot of individial model parts for the glm model low RR
</p>
</div>
</div>
<h3 id="step-12e-visualising-break-down-of-individial-model-parts-for-the-case-of-obs_2-high-rr-value-3.04">STEP 12e: Visualising break-down of individial model parts for the case of obs_2 (high RR value = 3.04)</h3>
<p><strong>Random Forest model</strong></p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>bd_rf_logRR_high</span> <span class='op'>&lt;-</span> 
  <span class='fu'>predict_parts</span><span class='op'>(</span>explainer <span class='op'>=</span> <span class='va'>explainer_rf_continous</span>,
                new_observation <span class='op'>=</span> <span class='va'>obs_2</span>, 
                type <span class='op'>=</span> <span class='st'>"break_down"</span><span class='op'>)</span> 

<span class='co'># SAVING THE BREAK-DOWN PLOT DATA</span>
<span class='co'># saveRDS(bd_rf_logRR_high, here::here("TidyModWflSet_OUTPUT","bd_rf_logRR_high.RDS"))</span>

<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>bd_rf_logRR_high</span>,
     max_features <span class='op'>=</span> <span class='fl'>20</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>ggtitle</span><span class='op'>(</span><span class='st'>"Break Down profile for Agroforestry Pruning-Alleycropping with a high observed logRR value (-1.82)"</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>theme</span><span class='op'>(</span>panel.grid <span class='op'>=</span> <span class='fu'>element_blank</span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span> 
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-screen-inset shaded">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>ggdraw</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span> 
  <span class='fu'>draw_image</span><span class='op'>(</span><span class='fu'>here</span><span class='fu'>::</span><span class='fu'><a href='https://here.r-lib.org//reference/here.html'>here</a></span><span class='op'>(</span><span class='st'>"TidyModWflSet_OUTPUT"</span>, <span class='st'>"bd_rf_logRR_high.png"</span><span class='op'>)</span><span class='op'>)</span> 
</code></pre>
</div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-8"></span>
<img src="TIDYMODELSWFS_files/figure-html5/unnamed-chunk-8-1.png" alt="Break-down plot of individial model parts for the Random Forest model high RR" width="576" />
<p class="caption">
Figure 8: Break-down plot of individial model parts for the Random Forest model high RR
</p>
</div>
</div>
<p><strong>XGBoost model</strong></p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>bd_xgb_logRR_high</span> <span class='op'>&lt;-</span> 
  <span class='fu'>predict_parts</span><span class='op'>(</span>explainer <span class='op'>=</span> <span class='va'>explainer_xgb_continous</span>,
                new_observation <span class='op'>=</span> <span class='va'>obs_2</span>, 
                type <span class='op'>=</span> <span class='st'>"break_down"</span><span class='op'>)</span> 

<span class='co'># SAVING THE BREAK-DOWN PLOT DATA</span>
<span class='co'># saveRDS(bd_xgb_logRR_high, here::here("TidyModWflSet_OUTPUT","bd_xgb_logRR_high.RDS"))</span>

<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>bd_xgb_logRR_high</span>,
     max_features <span class='op'>=</span> <span class='fl'>20</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>ggtitle</span><span class='op'>(</span><span class='st'>"Break Down profile for Agroforestry Pruning-Alleycropping with a high observed logRR value (-1.82)"</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>theme</span><span class='op'>(</span>panel.grid <span class='op'>=</span> <span class='fu'>element_blank</span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span> 
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-screen-inset shaded">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>ggdraw</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span> 
  <span class='fu'>draw_image</span><span class='op'>(</span><span class='fu'>here</span><span class='fu'>::</span><span class='fu'><a href='https://here.r-lib.org//reference/here.html'>here</a></span><span class='op'>(</span><span class='st'>"TidyModWflSet_OUTPUT"</span>, <span class='st'>"bd_xgb_logRR_high.png"</span><span class='op'>)</span><span class='op'>)</span> 
</code></pre>
</div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-9"></span>
<img src="TIDYMODELSWFS_files/figure-html5/unnamed-chunk-9-1.png" alt="Break-down plot of individial model parts for the XGBoost model high RR" width="576" />
<p class="caption">
Figure 9: Break-down plot of individial model parts for the XGBoost model high RR
</p>
</div>
</div>
<p><strong>cart model</strong></p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>bd_cart_logRR_high</span> <span class='op'>&lt;-</span> 
  <span class='fu'>predict_parts</span><span class='op'>(</span>explainer <span class='op'>=</span> <span class='va'>explainer_cart_continous</span>,
                new_observation <span class='op'>=</span> <span class='va'>obs_2</span>, 
                type <span class='op'>=</span> <span class='st'>"break_down"</span><span class='op'>)</span> 

<span class='co'># SAVING THE BREAK-DOWN PLOT DATA</span>
<span class='co'># saveRDS(bd_cart_logRR_high, here::here("TidyModWflSet_OUTPUT","bd_cart_logRR_high.RDS"))</span>

<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>bd_cart_logRR_high</span>,
     max_features <span class='op'>=</span> <span class='fl'>20</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>ggtitle</span><span class='op'>(</span><span class='st'>"Break Down profile for Agroforestry Pruning-Alleycropping with a high observed logRR value (-1.82)"</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>theme</span><span class='op'>(</span>panel.grid <span class='op'>=</span> <span class='fu'>element_blank</span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span> 
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-screen-inset shaded">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>ggdraw</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span> 
  <span class='fu'>draw_image</span><span class='op'>(</span><span class='fu'>here</span><span class='fu'>::</span><span class='fu'><a href='https://here.r-lib.org//reference/here.html'>here</a></span><span class='op'>(</span><span class='st'>"TidyModWflSet_OUTPUT"</span>, <span class='st'>"bd_cart_logRR_high.png"</span><span class='op'>)</span><span class='op'>)</span> 
</code></pre>
</div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-10"></span>
<img src="TIDYMODELSWFS_files/figure-html5/unnamed-chunk-10-1.png" alt="Break-down plot of individial model parts for the cart model high RR" width="576" />
<p class="caption">
Figure 10: Break-down plot of individial model parts for the cart model high RR
</p>
</div>
</div>
<p><strong>glm model</strong></p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>bd_glm_logRR_high</span> <span class='op'>&lt;-</span> 
  <span class='fu'>predict_parts</span><span class='op'>(</span>explainer <span class='op'>=</span> <span class='va'>explainer_glm_continous</span>,
                new_observation <span class='op'>=</span> <span class='va'>obs_2</span>, 
                type <span class='op'>=</span> <span class='st'>"break_down"</span><span class='op'>)</span> 

<span class='co'># SAVING THE BREAK-DOWN PLOT DATA</span>
<span class='co'># saveRDS(bd_glm_logRR_high, here::here("TidyModWflSet_OUTPUT","bd_glm_logRR_high.RDS"))</span>

<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>bd_glm_logRR_high</span>,
     max_features <span class='op'>=</span> <span class='fl'>20</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>ggtitle</span><span class='op'>(</span><span class='st'>"Break Down profile for Agroforestry Pruning-Alleycropping with a high observed logRR value (-1.82)"</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>theme</span><span class='op'>(</span>panel.grid <span class='op'>=</span> <span class='fu'>element_blank</span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span> 
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-screen-inset shaded">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>ggdraw</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span> 
  <span class='fu'>draw_image</span><span class='op'>(</span><span class='fu'>here</span><span class='fu'>::</span><span class='fu'><a href='https://here.r-lib.org//reference/here.html'>here</a></span><span class='op'>(</span><span class='st'>"TidyModWflSet_OUTPUT"</span>, <span class='st'>"bd_glm_logRR_high.png"</span><span class='op'>)</span><span class='op'>)</span> 
</code></pre>
</div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-11"></span>
<img src="TIDYMODELSWFS_files/figure-html5/unnamed-chunk-11-1.png" alt="Break-down plot of individial model parts for the glm model high RR" width="576" />
<p class="caption">
Figure 11: Break-down plot of individial model parts for the glm model high RR
</p>
</div>
</div>
<h2 id="step-13-explaining-models-and-predictions-model-agnostics-with-shap-plots">STEP 13: Explaining models and predictions (model agnostics) with SHAP plots</h2>
<p>We can use the fact that these break-down explanations change based on order to compute the most important features over all (or many) possible orderings. This is the idea behind Shapley Additive Explanations (Lundberg and Lee 2017), where the average contributions of features are computed under different combinations or “coalitions” of feature orderings. Let’s compute SHAP attributions for our duplex, using B = 20 random orderings. (<a href="https://ema.drwhy.ai/breakDown.html" class="uri">https://ema.drwhy.ai/breakDown.html</a>).</p>
<p>We could use the default plot method from DALEX by calling plot(shap_obs_1), or we can access the underlying data and create a custom plot.</p>
<h3 id="creating-shap-plot-based-on-the-four-different-models-for-the-low-rr--1.82">Creating SHAP plot based on the four different models <strong>for the low RR = -1.82</strong></h3>
<p><strong>Random Forest</strong></p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>shap_obs_1_rf</span> <span class='op'>&lt;-</span> <span class='fu'>predict_parts</span><span class='op'>(</span>explainer <span class='op'>=</span> <span class='va'>explainer_rf</span>, 
                               new_observation <span class='op'>=</span> <span class='va'>obs_1</span>, 
                               type <span class='op'>=</span> <span class='st'>"shap"</span>,
                               B <span class='op'>=</span> <span class='fl'>20</span><span class='op'>)</span>

<span class='co'># SAVING THE SHAP PLOT DATA</span>
<span class='fu'><a href='https://rdrr.io/r/base/readRDS.html'>saveRDS</a></span><span class='op'>(</span><span class='va'>shap_obs_1_rf</span>, <span class='fu'>here</span><span class='fu'>::</span><span class='fu'><a href='https://here.r-lib.org//reference/here.html'>here</a></span><span class='op'>(</span><span class='st'>"TidyModWflSet_OUTPUT"</span>,<span class='st'>"shap_obs_1_rf.RDS"</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
</details>
</div>
<p>Lets access the underlying data and creating a custom plot with ggplot</p>
<p>The box plots display the distribution of contributions across all the orderings we tried, and the bars display the average attribution for each feature.</p>
<div class="layout-chunk" data-layout="l-screen-inset shaded">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>shap_obs_1_rf</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/readRDS.html'>readRDS</a></span><span class='op'>(</span><span class='fu'>here</span><span class='fu'>::</span><span class='fu'><a href='https://here.r-lib.org//reference/here.html'>here</a></span><span class='op'>(</span><span class='st'>"TidyModWflSet_OUTPUT"</span>,<span class='st'>"shap_obs_1_rf.RDS"</span><span class='op'>)</span><span class='op'>)</span>

<span class='va'>shap_obs_1_rf_plot</span> <span class='op'>&lt;-</span> 
  <span class='va'>shap_obs_1_rf</span> <span class='op'>%&gt;%</span>
  <span class='fu'>group_by</span><span class='op'>(</span><span class='va'>variable</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>mutate</span><span class='op'>(</span>mean_val <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>contribution</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>ungroup</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>mutate</span><span class='op'>(</span>variable <span class='op'>=</span> <span class='fu'>fct_reorder</span><span class='op'>(</span><span class='va'>variable</span>, <span class='fu'><a href='https://rdrr.io/r/base/MathFun.html'>abs</a></span><span class='op'>(</span><span class='va'>mean_val</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>ggplot</span><span class='op'>(</span><span class='fu'>aes</span><span class='op'>(</span><span class='va'>contribution</span>, <span class='va'>variable</span>, fill <span class='op'>=</span> <span class='va'>mean_val</span> <span class='op'>&gt;</span> <span class='fl'>0</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>geom_col</span><span class='op'>(</span>data <span class='op'>=</span> <span class='op'>~</span><span class='fu'>distinct</span><span class='op'>(</span><span class='va'>.</span>, <span class='va'>variable</span>, <span class='va'>mean_val</span><span class='op'>)</span>, 
           <span class='fu'>aes</span><span class='op'>(</span><span class='va'>mean_val</span>, <span class='va'>variable</span><span class='op'>)</span>, 
           alpha <span class='op'>=</span> <span class='fl'>0.5</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>geom_boxplot</span><span class='op'>(</span>width <span class='op'>=</span> <span class='fl'>0.5</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>theme</span><span class='op'>(</span>legend.position <span class='op'>=</span> <span class='st'>"none"</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>labs</span><span class='op'>(</span>y <span class='op'>=</span> <span class='cn'>NULL</span><span class='op'>)</span>


<span class='va'>shap_obs_1_rf_plot</span>
</code></pre>
</div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-12"></span>
<img src="TIDYMODELSWFS_files/figure-html5/unnamed-chunk-12-1.png" alt="SHAP plot based on the Random Forest model for the low RR observation" width="576" />
<p class="caption">
Figure 12: SHAP plot based on the Random Forest model for the low RR observation
</p>
</div>
</div>
<p>We see that for this case the, and in general, the most important environmental features are silt content, precipitation of driest month and the potassium concentration. The shaded areas indicate the global contribution of the variables.</p>
<p><strong>XGBoost model</strong></p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>shap_obs_1_xgb</span> <span class='op'>&lt;-</span> <span class='fu'>predict_parts</span><span class='op'>(</span>explainer <span class='op'>=</span> <span class='va'>explainer_xgb</span>, 
                               new_observation <span class='op'>=</span> <span class='va'>obs_1</span>, 
                               type <span class='op'>=</span> <span class='st'>"shap"</span>,
                               B <span class='op'>=</span> <span class='fl'>20</span><span class='op'>)</span>

<span class='co'># SAVING THE SHAP PLOT DATA</span>
<span class='fu'><a href='https://rdrr.io/r/base/readRDS.html'>saveRDS</a></span><span class='op'>(</span><span class='va'>shap_obs_1_xgb</span>, <span class='fu'>here</span><span class='fu'>::</span><span class='fu'><a href='https://here.r-lib.org//reference/here.html'>here</a></span><span class='op'>(</span><span class='st'>"TidyModWflSet_OUTPUT"</span>,<span class='st'>"shap_obs_1_xgb.RDS"</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
</details>
</div>
<div class="layout-chunk" data-layout="l-screen-inset shaded">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>shap_obs_1_xgb</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/readRDS.html'>readRDS</a></span><span class='op'>(</span><span class='fu'>here</span><span class='fu'>::</span><span class='fu'><a href='https://here.r-lib.org//reference/here.html'>here</a></span><span class='op'>(</span><span class='st'>"TidyModWflSet_OUTPUT"</span>,<span class='st'>"shap_obs_1_xgb.RDS"</span><span class='op'>)</span><span class='op'>)</span>

<span class='va'>shap_obs_1_xgb_plot</span> <span class='op'>&lt;-</span> 
  <span class='va'>shap_obs_1_xgb</span> <span class='op'>%&gt;%</span>
  <span class='fu'>group_by</span><span class='op'>(</span><span class='va'>variable</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>mutate</span><span class='op'>(</span>mean_val <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>contribution</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>ungroup</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>mutate</span><span class='op'>(</span>variable <span class='op'>=</span> <span class='fu'>fct_reorder</span><span class='op'>(</span><span class='va'>variable</span>, <span class='fu'><a href='https://rdrr.io/r/base/MathFun.html'>abs</a></span><span class='op'>(</span><span class='va'>mean_val</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>ggplot</span><span class='op'>(</span><span class='fu'>aes</span><span class='op'>(</span><span class='va'>contribution</span>, <span class='va'>variable</span>, fill <span class='op'>=</span> <span class='va'>mean_val</span> <span class='op'>&gt;</span> <span class='fl'>0</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>geom_col</span><span class='op'>(</span>data <span class='op'>=</span> <span class='op'>~</span><span class='fu'>distinct</span><span class='op'>(</span><span class='va'>.</span>, <span class='va'>variable</span>, <span class='va'>mean_val</span><span class='op'>)</span>, 
           <span class='fu'>aes</span><span class='op'>(</span><span class='va'>mean_val</span>, <span class='va'>variable</span><span class='op'>)</span>, 
           alpha <span class='op'>=</span> <span class='fl'>0.5</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>geom_boxplot</span><span class='op'>(</span>width <span class='op'>=</span> <span class='fl'>0.5</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>theme</span><span class='op'>(</span>legend.position <span class='op'>=</span> <span class='st'>"none"</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>labs</span><span class='op'>(</span>y <span class='op'>=</span> <span class='cn'>NULL</span><span class='op'>)</span>


<span class='va'>shap_obs_1_xgb_plot</span>
</code></pre>
</div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-13"></span>
<img src="TIDYMODELSWFS_files/figure-html5/unnamed-chunk-13-1.png" alt="SHAP plot based on the XGB model for the low RR observation" width="576" />
<p class="caption">
Figure 13: SHAP plot based on the XGB model for the low RR observation
</p>
</div>
</div>
<p>The box plots display the distribution of contributions across all the orderings we tried, and the bars display the average attribution for each feature. We see that for the XGBoost model many of the most important features (e.g. sand, silt, total carbon in the soil) are actually contributing negatively to the predicted response ratios. Both for this case (box plots) and for the general observations (shaded area).</p>
<p><strong>Cart model</strong></p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>shap_obs_1_cart</span> <span class='op'>&lt;-</span> <span class='fu'>predict_parts</span><span class='op'>(</span>explainer <span class='op'>=</span> <span class='va'>explainer_cart</span>, 
                               new_observation <span class='op'>=</span> <span class='va'>obs_1</span>, 
                               type <span class='op'>=</span> <span class='st'>"shap"</span>,
                               B <span class='op'>=</span> <span class='fl'>20</span><span class='op'>)</span>

<span class='co'># SAVING THE SHAP PLOT DATA</span>
<span class='fu'><a href='https://rdrr.io/r/base/readRDS.html'>saveRDS</a></span><span class='op'>(</span><span class='va'>shap_obs_1_cart</span>, <span class='fu'>here</span><span class='fu'>::</span><span class='fu'><a href='https://here.r-lib.org//reference/here.html'>here</a></span><span class='op'>(</span><span class='st'>"TidyModWflSet_OUTPUT"</span>,<span class='st'>"shap_obs_1_cart.RDS"</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
</details>
</div>
<div class="layout-chunk" data-layout="l-screen-inset shaded">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>shap_obs_1_cart</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/readRDS.html'>readRDS</a></span><span class='op'>(</span><span class='fu'>here</span><span class='fu'>::</span><span class='fu'><a href='https://here.r-lib.org//reference/here.html'>here</a></span><span class='op'>(</span><span class='st'>"TidyModWflSet_OUTPUT"</span>,<span class='st'>"shap_obs_1_cart.RDS"</span><span class='op'>)</span><span class='op'>)</span>

<span class='va'>shap_obs_1_cart_plot</span> <span class='op'>&lt;-</span> 
  <span class='va'>shap_obs_1_cart</span> <span class='op'>%&gt;%</span>
  <span class='fu'>group_by</span><span class='op'>(</span><span class='va'>variable</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>mutate</span><span class='op'>(</span>mean_val <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>contribution</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>ungroup</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>mutate</span><span class='op'>(</span>variable <span class='op'>=</span> <span class='fu'>fct_reorder</span><span class='op'>(</span><span class='va'>variable</span>, <span class='fu'><a href='https://rdrr.io/r/base/MathFun.html'>abs</a></span><span class='op'>(</span><span class='va'>mean_val</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>ggplot</span><span class='op'>(</span><span class='fu'>aes</span><span class='op'>(</span><span class='va'>contribution</span>, <span class='va'>variable</span>, fill <span class='op'>=</span> <span class='va'>mean_val</span> <span class='op'>&gt;</span> <span class='fl'>0</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>geom_col</span><span class='op'>(</span>data <span class='op'>=</span> <span class='op'>~</span><span class='fu'>distinct</span><span class='op'>(</span><span class='va'>.</span>, <span class='va'>variable</span>, <span class='va'>mean_val</span><span class='op'>)</span>, 
           <span class='fu'>aes</span><span class='op'>(</span><span class='va'>mean_val</span>, <span class='va'>variable</span><span class='op'>)</span>, 
           alpha <span class='op'>=</span> <span class='fl'>0.5</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>geom_boxplot</span><span class='op'>(</span>width <span class='op'>=</span> <span class='fl'>0.5</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>theme</span><span class='op'>(</span>legend.position <span class='op'>=</span> <span class='st'>"none"</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>labs</span><span class='op'>(</span>y <span class='op'>=</span> <span class='cn'>NULL</span><span class='op'>)</span>


<span class='va'>shap_obs_1_cart_plot</span>
</code></pre>
</div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-14"></span>
<img src="TIDYMODELSWFS_files/figure-html5/unnamed-chunk-14-1.png" alt="SHAP plot based on the cart model for the low RR observation" width="576" />
<p class="caption">
Figure 14: SHAP plot based on the cart model for the low RR observation
</p>
</div>
</div>
<p>Again we see, similar to the Random Forest model, how silt and precipitation negatively contribute to the predicted response ratio values.</p>
<p><strong>glm model</strong></p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>shap_obs_1_glm</span> <span class='op'>&lt;-</span> <span class='fu'>predict_parts</span><span class='op'>(</span>explainer <span class='op'>=</span> <span class='va'>explainer_glm</span>, 
                               new_observation <span class='op'>=</span> <span class='va'>obs_1</span>, 
                               type <span class='op'>=</span> <span class='st'>"shap"</span>,
                               B <span class='op'>=</span> <span class='fl'>20</span><span class='op'>)</span>

<span class='co'># SAVING THE SHAP PLOT DATA</span>
<span class='fu'><a href='https://rdrr.io/r/base/readRDS.html'>saveRDS</a></span><span class='op'>(</span><span class='va'>shap_obs_1_glm</span>, <span class='fu'>here</span><span class='fu'>::</span><span class='fu'><a href='https://here.r-lib.org//reference/here.html'>here</a></span><span class='op'>(</span><span class='st'>"TidyModWflSet_OUTPUT"</span>,<span class='st'>"shap_obs_1_glm.RDS"</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
</details>
</div>
<div class="layout-chunk" data-layout="l-screen-inset shaded">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>shap_obs_1_glm</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/readRDS.html'>readRDS</a></span><span class='op'>(</span><span class='fu'>here</span><span class='fu'>::</span><span class='fu'><a href='https://here.r-lib.org//reference/here.html'>here</a></span><span class='op'>(</span><span class='st'>"TidyModWflSet_OUTPUT"</span>,<span class='st'>"shap_obs_1_glm.RDS"</span><span class='op'>)</span><span class='op'>)</span>

<span class='va'>shap_obs_1_glm_plot</span> <span class='op'>&lt;-</span> 
  <span class='va'>shap_obs_1_glm</span> <span class='op'>%&gt;%</span>
  <span class='fu'>group_by</span><span class='op'>(</span><span class='va'>variable</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>mutate</span><span class='op'>(</span>mean_val <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>contribution</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>ungroup</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>mutate</span><span class='op'>(</span>variable <span class='op'>=</span> <span class='fu'>fct_reorder</span><span class='op'>(</span><span class='va'>variable</span>, <span class='fu'><a href='https://rdrr.io/r/base/MathFun.html'>abs</a></span><span class='op'>(</span><span class='va'>mean_val</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>ggplot</span><span class='op'>(</span><span class='fu'>aes</span><span class='op'>(</span><span class='va'>contribution</span>, <span class='va'>variable</span>, fill <span class='op'>=</span> <span class='va'>mean_val</span> <span class='op'>&gt;</span> <span class='fl'>0</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>geom_col</span><span class='op'>(</span>data <span class='op'>=</span> <span class='op'>~</span><span class='fu'>distinct</span><span class='op'>(</span><span class='va'>.</span>, <span class='va'>variable</span>, <span class='va'>mean_val</span><span class='op'>)</span>, 
           <span class='fu'>aes</span><span class='op'>(</span><span class='va'>mean_val</span>, <span class='va'>variable</span><span class='op'>)</span>, 
           alpha <span class='op'>=</span> <span class='fl'>0.5</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>geom_boxplot</span><span class='op'>(</span>width <span class='op'>=</span> <span class='fl'>0.5</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>theme</span><span class='op'>(</span>legend.position <span class='op'>=</span> <span class='st'>"none"</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>labs</span><span class='op'>(</span>y <span class='op'>=</span> <span class='cn'>NULL</span><span class='op'>)</span>


<span class='va'>shap_obs_1_glm_plot</span>
</code></pre>
</div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-15"></span>
<img src="TIDYMODELSWFS_files/figure-html5/unnamed-chunk-15-1.png" alt="SHAP plot based on the glm model for the low RR observation" width="576" />
<p class="caption">
Figure 15: SHAP plot based on the glm model for the low RR observation
</p>
</div>
</div>
<p>With the glm model above we see slightly different patterns emerging compared to the three previous models. Most noticeably is that the precipitation of driest wuarter is now contributing positively to the predicted response ratios.</p>
<p>Lets make similar plots for the other observation with high RR values.</p>
<h3 id="creating-shap-plot-based-on-the-four-different-models-for-the-high-rr-3.05">Creating SHAP plot based on the four different models <strong>for the high RR = 3.05</strong></h3>
<p><strong>Random Forest</strong></p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>shap_obs_2_rf</span> <span class='op'>&lt;-</span> <span class='fu'>predict_parts</span><span class='op'>(</span>explainer <span class='op'>=</span> <span class='va'>explainer_rf</span>, 
                               new_observation <span class='op'>=</span> <span class='va'>obs_2</span>, 
                               type <span class='op'>=</span> <span class='st'>"shap"</span>,
                               B <span class='op'>=</span> <span class='fl'>20</span><span class='op'>)</span>

<span class='co'># SAVING THE SHAP PLOT DATA</span>
<span class='fu'><a href='https://rdrr.io/r/base/readRDS.html'>saveRDS</a></span><span class='op'>(</span><span class='va'>shap_obs_2_rf</span>, <span class='fu'>here</span><span class='fu'>::</span><span class='fu'><a href='https://here.r-lib.org//reference/here.html'>here</a></span><span class='op'>(</span><span class='st'>"TidyModWflSet_OUTPUT"</span>,<span class='st'>"shap_obs_2_rf.RDS"</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
</details>
</div>
<div class="layout-chunk" data-layout="l-screen-inset shaded">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>shap_obs_2_rf</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/readRDS.html'>readRDS</a></span><span class='op'>(</span><span class='fu'>here</span><span class='fu'>::</span><span class='fu'><a href='https://here.r-lib.org//reference/here.html'>here</a></span><span class='op'>(</span><span class='st'>"TidyModWflSet_OUTPUT"</span>,<span class='st'>"shap_obs_2_rf.RDS"</span><span class='op'>)</span><span class='op'>)</span>

<span class='va'>shap_obs_2_rf_plot</span> <span class='op'>&lt;-</span> 
  <span class='va'>shap_obs_2_rf</span> <span class='op'>%&gt;%</span>
  <span class='fu'>group_by</span><span class='op'>(</span><span class='va'>variable</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>mutate</span><span class='op'>(</span>mean_val <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>contribution</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>ungroup</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>mutate</span><span class='op'>(</span>variable <span class='op'>=</span> <span class='fu'>fct_reorder</span><span class='op'>(</span><span class='va'>variable</span>, <span class='fu'><a href='https://rdrr.io/r/base/MathFun.html'>abs</a></span><span class='op'>(</span><span class='va'>mean_val</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>ggplot</span><span class='op'>(</span><span class='fu'>aes</span><span class='op'>(</span><span class='va'>contribution</span>, <span class='va'>variable</span>, fill <span class='op'>=</span> <span class='va'>mean_val</span> <span class='op'>&gt;</span> <span class='fl'>0</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>geom_col</span><span class='op'>(</span>data <span class='op'>=</span> <span class='op'>~</span><span class='fu'>distinct</span><span class='op'>(</span><span class='va'>.</span>, <span class='va'>variable</span>, <span class='va'>mean_val</span><span class='op'>)</span>, 
           <span class='fu'>aes</span><span class='op'>(</span><span class='va'>mean_val</span>, <span class='va'>variable</span><span class='op'>)</span>, 
           alpha <span class='op'>=</span> <span class='fl'>0.5</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>geom_boxplot</span><span class='op'>(</span>width <span class='op'>=</span> <span class='fl'>0.5</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>theme</span><span class='op'>(</span>legend.position <span class='op'>=</span> <span class='st'>"none"</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>labs</span><span class='op'>(</span>y <span class='op'>=</span> <span class='cn'>NULL</span><span class='op'>)</span>


<span class='va'>shap_obs_2_rf_plot</span>
</code></pre>
</div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-16"></span>
<img src="TIDYMODELSWFS_files/figure-html5/unnamed-chunk-16-1.png" alt="SHAP plot based on the Random Forest model for the high RR observation" width="576" />
<p class="caption">
Figure 16: SHAP plot based on the Random Forest model for the high RR observation
</p>
</div>
</div>
<p>We see that the lower silt concentration in this observation (13.49 instead of 16.75) results in a shift from silt being a negative contributor to the response ratios to becoming a positive contributor. This indicates that when soil silt content increase there is a decrease in agroforestry response ratios.</p>
<p><strong>XGBoost model</strong></p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>shap_obs_2_xgb</span> <span class='op'>&lt;-</span> <span class='fu'>predict_parts</span><span class='op'>(</span>explainer <span class='op'>=</span> <span class='va'>explainer_xgb</span>, 
                               new_observation <span class='op'>=</span> <span class='va'>obs_2</span>, 
                               type <span class='op'>=</span> <span class='st'>"shap"</span>,
                               B <span class='op'>=</span> <span class='fl'>20</span><span class='op'>)</span>

<span class='co'># SAVING THE SHAP PLOT DATA</span>
<span class='fu'><a href='https://rdrr.io/r/base/readRDS.html'>saveRDS</a></span><span class='op'>(</span><span class='va'>shap_obs_2_xgb</span>, <span class='fu'>here</span><span class='fu'>::</span><span class='fu'><a href='https://here.r-lib.org//reference/here.html'>here</a></span><span class='op'>(</span><span class='st'>"TidyModWflSet_OUTPUT"</span>,<span class='st'>"shap_obs_2_xgb.RDS"</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
</details>
</div>
<div class="layout-chunk" data-layout="l-screen-inset shaded">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>shap_obs_2_xgb</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/readRDS.html'>readRDS</a></span><span class='op'>(</span><span class='fu'>here</span><span class='fu'>::</span><span class='fu'><a href='https://here.r-lib.org//reference/here.html'>here</a></span><span class='op'>(</span><span class='st'>"TidyModWflSet_OUTPUT"</span>,<span class='st'>"shap_obs_2_xgb.RDS"</span><span class='op'>)</span><span class='op'>)</span>

<span class='va'>shap_obs_2_xgb_plot</span> <span class='op'>&lt;-</span> 
  <span class='va'>shap_obs_2_xgb</span> <span class='op'>%&gt;%</span>
  <span class='fu'>group_by</span><span class='op'>(</span><span class='va'>variable</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>mutate</span><span class='op'>(</span>mean_val <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>contribution</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>ungroup</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>mutate</span><span class='op'>(</span>variable <span class='op'>=</span> <span class='fu'>fct_reorder</span><span class='op'>(</span><span class='va'>variable</span>, <span class='fu'><a href='https://rdrr.io/r/base/MathFun.html'>abs</a></span><span class='op'>(</span><span class='va'>mean_val</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>ggplot</span><span class='op'>(</span><span class='fu'>aes</span><span class='op'>(</span><span class='va'>contribution</span>, <span class='va'>variable</span>, fill <span class='op'>=</span> <span class='va'>mean_val</span> <span class='op'>&gt;</span> <span class='fl'>0</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>geom_col</span><span class='op'>(</span>data <span class='op'>=</span> <span class='op'>~</span><span class='fu'>distinct</span><span class='op'>(</span><span class='va'>.</span>, <span class='va'>variable</span>, <span class='va'>mean_val</span><span class='op'>)</span>, 
           <span class='fu'>aes</span><span class='op'>(</span><span class='va'>mean_val</span>, <span class='va'>variable</span><span class='op'>)</span>, 
           alpha <span class='op'>=</span> <span class='fl'>0.5</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>geom_boxplot</span><span class='op'>(</span>width <span class='op'>=</span> <span class='fl'>0.5</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>theme</span><span class='op'>(</span>legend.position <span class='op'>=</span> <span class='st'>"none"</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>labs</span><span class='op'>(</span>y <span class='op'>=</span> <span class='cn'>NULL</span><span class='op'>)</span>


<span class='va'>shap_obs_2_xgb_plot</span>
</code></pre>
</div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-17"></span>
<img src="TIDYMODELSWFS_files/figure-html5/unnamed-chunk-17-1.png" alt="SHAP plot based on the XGB model for the high RR observation" width="576" />
<p class="caption">
Figure 17: SHAP plot based on the XGB model for the high RR observation
</p>
</div>
</div>
<p>Again the lower clay content and higher sand content contribute positivly to the predicted response ratios</p>
<p><strong>Cart model</strong></p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>shap_obs_2_cart</span> <span class='op'>&lt;-</span> <span class='fu'>predict_parts</span><span class='op'>(</span>explainer <span class='op'>=</span> <span class='va'>explainer_cart</span>, 
                               new_observation <span class='op'>=</span> <span class='va'>obs_2</span>, 
                               type <span class='op'>=</span> <span class='st'>"shap"</span>,
                               B <span class='op'>=</span> <span class='fl'>20</span><span class='op'>)</span>

<span class='co'># SAVING THE SHAP PLOT DATA</span>
<span class='fu'><a href='https://rdrr.io/r/base/readRDS.html'>saveRDS</a></span><span class='op'>(</span><span class='va'>shap_obs_2_cart</span>, <span class='fu'>here</span><span class='fu'>::</span><span class='fu'><a href='https://here.r-lib.org//reference/here.html'>here</a></span><span class='op'>(</span><span class='st'>"TidyModWflSet_OUTPUT"</span>,<span class='st'>"shap_obs_2_cart.RDS"</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
</details>
</div>
<div class="layout-chunk" data-layout="l-screen-inset shaded">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>shap_obs_2_cart</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/readRDS.html'>readRDS</a></span><span class='op'>(</span><span class='fu'>here</span><span class='fu'>::</span><span class='fu'><a href='https://here.r-lib.org//reference/here.html'>here</a></span><span class='op'>(</span><span class='st'>"TidyModWflSet_OUTPUT"</span>,<span class='st'>"shap_obs_2_cart.RDS"</span><span class='op'>)</span><span class='op'>)</span>

<span class='va'>shap_obs_2_cart_plot</span> <span class='op'>&lt;-</span> 
  <span class='va'>shap_obs_2_cart</span> <span class='op'>%&gt;%</span>
  <span class='fu'>group_by</span><span class='op'>(</span><span class='va'>variable</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>mutate</span><span class='op'>(</span>mean_val <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>contribution</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>ungroup</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>mutate</span><span class='op'>(</span>variable <span class='op'>=</span> <span class='fu'>fct_reorder</span><span class='op'>(</span><span class='va'>variable</span>, <span class='fu'><a href='https://rdrr.io/r/base/MathFun.html'>abs</a></span><span class='op'>(</span><span class='va'>mean_val</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>ggplot</span><span class='op'>(</span><span class='fu'>aes</span><span class='op'>(</span><span class='va'>contribution</span>, <span class='va'>variable</span>, fill <span class='op'>=</span> <span class='va'>mean_val</span> <span class='op'>&gt;</span> <span class='fl'>0</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>geom_col</span><span class='op'>(</span>data <span class='op'>=</span> <span class='op'>~</span><span class='fu'>distinct</span><span class='op'>(</span><span class='va'>.</span>, <span class='va'>variable</span>, <span class='va'>mean_val</span><span class='op'>)</span>, 
           <span class='fu'>aes</span><span class='op'>(</span><span class='va'>mean_val</span>, <span class='va'>variable</span><span class='op'>)</span>, 
           alpha <span class='op'>=</span> <span class='fl'>0.5</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>geom_boxplot</span><span class='op'>(</span>width <span class='op'>=</span> <span class='fl'>0.5</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>theme</span><span class='op'>(</span>legend.position <span class='op'>=</span> <span class='st'>"none"</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>labs</span><span class='op'>(</span>y <span class='op'>=</span> <span class='cn'>NULL</span><span class='op'>)</span>


<span class='va'>shap_obs_2_cart_plot</span>
</code></pre>
</div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-18"></span>
<img src="TIDYMODELSWFS_files/figure-html5/unnamed-chunk-18-1.png" alt="SHAP plot based on the cart model for the high RR observation" width="576" />
<p class="caption">
Figure 18: SHAP plot based on the cart model for the high RR observation
</p>
</div>
</div>
<p><strong>Glm model</strong></p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>shap_obs_2_glm</span> <span class='op'>&lt;-</span> <span class='fu'>predict_parts</span><span class='op'>(</span>explainer <span class='op'>=</span> <span class='va'>explainer_glm</span>, 
                               new_observation <span class='op'>=</span> <span class='va'>obs_2</span>, 
                               type <span class='op'>=</span> <span class='st'>"shap"</span>,
                               B <span class='op'>=</span> <span class='fl'>20</span><span class='op'>)</span>

<span class='co'># SAVING THE SHAP PLOT DATA</span>
<span class='fu'><a href='https://rdrr.io/r/base/readRDS.html'>saveRDS</a></span><span class='op'>(</span><span class='va'>shap_obs_2_glm</span>, <span class='fu'>here</span><span class='fu'>::</span><span class='fu'><a href='https://here.r-lib.org//reference/here.html'>here</a></span><span class='op'>(</span><span class='st'>"TidyModWflSet_OUTPUT"</span>,<span class='st'>"shap_obs_2_glm.RDS"</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
</details>
</div>
<div class="layout-chunk" data-layout="l-screen-inset shaded">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>shap_obs_2_glm</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/readRDS.html'>readRDS</a></span><span class='op'>(</span><span class='fu'>here</span><span class='fu'>::</span><span class='fu'><a href='https://here.r-lib.org//reference/here.html'>here</a></span><span class='op'>(</span><span class='st'>"TidyModWflSet_OUTPUT"</span>,<span class='st'>"shap_obs_2_glm.RDS"</span><span class='op'>)</span><span class='op'>)</span>

<span class='va'>shap_obs_2_glm_plot</span> <span class='op'>&lt;-</span> 
  <span class='va'>shap_obs_2_glm</span> <span class='op'>%&gt;%</span>
  <span class='fu'>group_by</span><span class='op'>(</span><span class='va'>variable</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>mutate</span><span class='op'>(</span>mean_val <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>contribution</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>ungroup</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>mutate</span><span class='op'>(</span>variable <span class='op'>=</span> <span class='fu'>fct_reorder</span><span class='op'>(</span><span class='va'>variable</span>, <span class='fu'><a href='https://rdrr.io/r/base/MathFun.html'>abs</a></span><span class='op'>(</span><span class='va'>mean_val</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>ggplot</span><span class='op'>(</span><span class='fu'>aes</span><span class='op'>(</span><span class='va'>contribution</span>, <span class='va'>variable</span>, fill <span class='op'>=</span> <span class='va'>mean_val</span> <span class='op'>&gt;</span> <span class='fl'>0</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>geom_col</span><span class='op'>(</span>data <span class='op'>=</span> <span class='op'>~</span><span class='fu'>distinct</span><span class='op'>(</span><span class='va'>.</span>, <span class='va'>variable</span>, <span class='va'>mean_val</span><span class='op'>)</span>, 
           <span class='fu'>aes</span><span class='op'>(</span><span class='va'>mean_val</span>, <span class='va'>variable</span><span class='op'>)</span>, 
           alpha <span class='op'>=</span> <span class='fl'>0.5</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>geom_boxplot</span><span class='op'>(</span>width <span class='op'>=</span> <span class='fl'>0.5</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>theme</span><span class='op'>(</span>legend.position <span class='op'>=</span> <span class='st'>"none"</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>labs</span><span class='op'>(</span>y <span class='op'>=</span> <span class='cn'>NULL</span><span class='op'>)</span>


<span class='va'>shap_obs_2_glm_plot</span>
</code></pre>
</div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-19"></span>
<img src="TIDYMODELSWFS_files/figure-html5/unnamed-chunk-19-1.png" alt="SHAP plot based on the glm model for the high RR observation" width="576" />
<p class="caption">
Figure 19: SHAP plot based on the glm model for the high RR observation
</p>
</div>
</div>
<h2 id="step-14-global-model-explorations-global-model-agnostics">STEP 14: Global model explorations (global model agnostics)</h2>
<p>Global model explanations, also called global feature importance or variable importance, help us understand which features are most important in driving the predictions of these two models overall, aggregated over the whole training set. While the previous section addressed what variables or features are most important in predicting sale price for an individual home, global feature importance addresses what variables are most important for a model in aggregate. (read more here: <a href="https://www.tmwr.org/explain.html" class="uri">https://www.tmwr.org/explain.html</a>)</p>
<p><strong>Note:</strong> One way to compute variable importance is to permute the features (Breiman 2001a). We can permute or shuffle the values of a feature, predict from the model, and then measure how much worse the model fits the data compared to before shuffling.</p>
<p>If shuffling a column causes a large degradation in model performance, it is important; if shuffling a column’s values doesn’t make much difference to how the model performs, it must not be an important variable. This approach can be applied to any kind of model (it is model-agnostic) and the results are straightforward to understand. Using DALEX, we compute this kind of variable importance via the model_parts() function.</p>
<h3 id="generating-vip-datasets-for-each-of-the-four-models">Generating vip datasets for each of the four models</h3>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>vip_rf</span> <span class='op'>&lt;-</span> <span class='fu'>DALEX</span><span class='fu'>::</span><span class='fu'><a href='https://dalex.drwhy.ai/reference/model_parts.html'>model_parts</a></span><span class='op'>(</span><span class='va'>explainer_rf</span>, loss_function <span class='op'>=</span> <span class='va'>loss_root_mean_square</span><span class='op'>)</span>
<span class='va'>vip_xgb</span> <span class='op'>&lt;-</span> <span class='fu'>DALEX</span><span class='fu'>::</span><span class='fu'><a href='https://dalex.drwhy.ai/reference/model_parts.html'>model_parts</a></span><span class='op'>(</span><span class='va'>explainer_xgb</span>, loss_function <span class='op'>=</span> <span class='va'>loss_root_mean_square</span><span class='op'>)</span> 
<span class='va'>vip_cart</span> <span class='op'>&lt;-</span> <span class='fu'>DALEX</span><span class='fu'>::</span><span class='fu'><a href='https://dalex.drwhy.ai/reference/model_parts.html'>model_parts</a></span><span class='op'>(</span><span class='va'>explainer_cart</span>, loss_function <span class='op'>=</span> <span class='va'>loss_root_mean_square</span><span class='op'>)</span> 
<span class='va'>vip_glm</span> <span class='op'>&lt;-</span> <span class='fu'>DALEX</span><span class='fu'>::</span><span class='fu'><a href='https://dalex.drwhy.ai/reference/model_parts.html'>model_parts</a></span><span class='op'>(</span><span class='va'>explainer_glm</span>, loss_function <span class='op'>=</span> <span class='va'>loss_root_mean_square</span><span class='op'>)</span> 

<span class='co'># SAVING THE VIP DATASET</span>
<span class='fu'><a href='https://rdrr.io/r/base/readRDS.html'>saveRDS</a></span><span class='op'>(</span><span class='va'>vip_rf</span>, <span class='fu'>here</span><span class='fu'>::</span><span class='fu'><a href='https://here.r-lib.org//reference/here.html'>here</a></span><span class='op'>(</span><span class='st'>"TidyModWflSet_OUTPUT"</span>,<span class='st'>"vip_rf.RDS"</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/readRDS.html'>saveRDS</a></span><span class='op'>(</span><span class='va'>vip_xgb</span>, <span class='fu'>here</span><span class='fu'>::</span><span class='fu'><a href='https://here.r-lib.org//reference/here.html'>here</a></span><span class='op'>(</span><span class='st'>"TidyModWflSet_OUTPUT"</span>,<span class='st'>"vip_xgb.RDS"</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/readRDS.html'>saveRDS</a></span><span class='op'>(</span><span class='va'>vip_cart</span>, <span class='fu'>here</span><span class='fu'>::</span><span class='fu'><a href='https://here.r-lib.org//reference/here.html'>here</a></span><span class='op'>(</span><span class='st'>"TidyModWflSet_OUTPUT"</span>,<span class='st'>"vip_cart.RDS"</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/readRDS.html'>saveRDS</a></span><span class='op'>(</span><span class='va'>vip_glm</span>, <span class='fu'>here</span><span class='fu'>::</span><span class='fu'><a href='https://here.r-lib.org//reference/here.html'>here</a></span><span class='op'>(</span><span class='st'>"TidyModWflSet_OUTPUT"</span>,<span class='st'>"vip_glm.RDS"</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
</details>
</div>
<p>Again, we could use the default plot method from DALEX by calling e.g. plot(vip_glm) or plot(vip_rf) but the underlying data is available for exploration, analysis, and plotting.</p>
<div class="layout-chunk" data-layout="l-screen-inset shaded">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># plot(vip_rf)</span>
<span class='co'># library(cowplot)</span>

<span class='fu'>ggdraw</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span> 
  <span class='fu'>draw_image</span><span class='op'>(</span><span class='fu'>here</span><span class='fu'>::</span><span class='fu'><a href='https://here.r-lib.org//reference/here.html'>here</a></span><span class='op'>(</span><span class='st'>"TidyModWflSet_OUTPUT"</span>, <span class='st'>"vip_rf.png"</span><span class='op'>)</span><span class='op'>)</span> 
</code></pre>
</div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-20"></span>
<img src="TIDYMODELSWFS_files/figure-html5/unnamed-chunk-20-1.png" alt="Standadized plot of vip for the RF model" width="576" />
<p class="caption">
Figure 20: Standadized plot of vip for the RF model
</p>
</div>
</div>
<p>Let’s use the underlying data and create a function that automatically plot our vip model dataset in a ggplot:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>ggplot_imp</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>...</span><span class='op'>)</span> <span class='op'>{</span>
  <span class='va'>obj</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='va'>...</span><span class='op'>)</span>
  <span class='va'>metric_name</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/attr.html'>attr</a></span><span class='op'>(</span><span class='va'>obj</span><span class='op'>[[</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>]</span>, <span class='st'>"loss_name"</span><span class='op'>)</span>
  <span class='va'>metric_lab</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span><span class='op'>(</span><span class='va'>metric_name</span>, 
                      <span class='st'>"after permutations\n(higher indicates more important)"</span><span class='op'>)</span>
  
  <span class='va'>full_vip</span> <span class='op'>&lt;-</span> <span class='fu'>bind_rows</span><span class='op'>(</span><span class='va'>obj</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
    <span class='fu'><a href='https://rdrr.io/r/stats/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>variable</span> <span class='op'>!=</span> <span class='st'>"_baseline_"</span><span class='op'>)</span>
  
  <span class='va'>perm_vals</span> <span class='op'>&lt;-</span> <span class='va'>full_vip</span> <span class='op'>%&gt;%</span> 
    <span class='fu'><a href='https://rdrr.io/r/stats/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>variable</span> <span class='op'>==</span> <span class='st'>"_full_model_"</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
    <span class='fu'>group_by</span><span class='op'>(</span><span class='va'>label</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
    <span class='fu'>summarise</span><span class='op'>(</span>dropout_loss <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>dropout_loss</span><span class='op'>)</span><span class='op'>)</span>
  
  <span class='va'>p</span> <span class='op'>&lt;-</span> <span class='va'>full_vip</span> <span class='op'>%&gt;%</span>
    <span class='fu'><a href='https://rdrr.io/r/stats/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>variable</span> <span class='op'>!=</span> <span class='st'>"_full_model_"</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
    <span class='fu'>mutate</span><span class='op'>(</span>variable <span class='op'>=</span> <span class='fu'>fct_reorder</span><span class='op'>(</span><span class='va'>variable</span>, <span class='va'>dropout_loss</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
    <span class='fu'>ggplot</span><span class='op'>(</span><span class='fu'>aes</span><span class='op'>(</span><span class='va'>dropout_loss</span>, <span class='va'>variable</span><span class='op'>)</span><span class='op'>)</span> 
  <span class='kw'>if</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>obj</span><span class='op'>)</span> <span class='op'>&gt;</span> <span class='fl'>1</span><span class='op'>)</span> <span class='op'>{</span>
    <span class='va'>p</span> <span class='op'>&lt;-</span> <span class='va'>p</span> <span class='op'>+</span> 
      <span class='fu'>facet_wrap</span><span class='op'>(</span><span class='fu'>vars</span><span class='op'>(</span><span class='va'>label</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
      <span class='fu'>geom_vline</span><span class='op'>(</span>data <span class='op'>=</span> <span class='va'>perm_vals</span>, <span class='fu'>aes</span><span class='op'>(</span>xintercept <span class='op'>=</span> <span class='va'>dropout_loss</span>, color <span class='op'>=</span> <span class='va'>label</span><span class='op'>)</span>,
                 size <span class='op'>=</span> <span class='fl'>1.2</span>, lty <span class='op'>=</span> <span class='fl'>2</span>, alpha <span class='op'>=</span> <span class='fl'>0.7</span>, col <span class='op'>=</span> <span class='st'>"black"</span><span class='op'>)</span> <span class='op'>+</span>
      <span class='fu'>geom_boxplot</span><span class='op'>(</span><span class='fu'>aes</span><span class='op'>(</span>color <span class='op'>=</span> <span class='va'>label</span>, fill <span class='op'>=</span> <span class='va'>label</span><span class='op'>)</span>, alpha <span class='op'>=</span> <span class='fl'>0.2</span><span class='op'>)</span>
  <span class='op'>}</span> <span class='kw'>else</span> <span class='op'>{</span>
    <span class='va'>p</span> <span class='op'>&lt;-</span> <span class='va'>p</span> <span class='op'>+</span> 
      <span class='fu'>geom_vline</span><span class='op'>(</span>data <span class='op'>=</span> <span class='va'>perm_vals</span>, <span class='fu'>aes</span><span class='op'>(</span>xintercept <span class='op'>=</span> <span class='va'>dropout_loss</span><span class='op'>)</span>,
                 size <span class='op'>=</span> <span class='fl'>1.2</span>, lty <span class='op'>=</span> <span class='fl'>2</span>, alpha <span class='op'>=</span> <span class='fl'>0.7</span>, col <span class='op'>=</span> <span class='st'>"black"</span><span class='op'>)</span> <span class='op'>+</span>
      <span class='fu'>geom_boxplot</span><span class='op'>(</span>fill <span class='op'>=</span> <span class='st'>"#91CBD765"</span>, alpha <span class='op'>=</span> <span class='fl'>0.4</span><span class='op'>)</span>
    
  <span class='op'>}</span>
  
  <span class='va'>p</span> <span class='op'>+</span>
    <span class='fu'>theme</span><span class='op'>(</span>legend.position <span class='op'>=</span> <span class='st'>"none"</span><span class='op'>)</span> <span class='op'>+</span>
    <span class='fu'>labs</span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>metric_lab</span>, 
         y <span class='op'>=</span> <span class='cn'>NULL</span>,  fill <span class='op'>=</span> <span class='cn'>NULL</span>,  color <span class='op'>=</span> <span class='cn'>NULL</span><span class='op'>)</span>
<span class='op'>}</span>
</code></pre>
</div>
</div>
<h3 id="using-function-to-plot-the-vip-datasets-for-each-model">Using function to plot the vip datasets for each model</h3>
<p>Now we can view the vip dataset visually by using the function that was just created. The dashed line in each panel shows the RMSE for the full model, either the linear model or the random forest model. Features further to the right are more important, because permuting them results in higher RMSE. There is quite a lot of interesting information to learn from this plot; for example, neighborhood is quite important in the linear model with interactions/splines but the second least important feature for the random forest model.</p>
<strong>VIP for the tree-based models RF and XGB</strong>
<div class="layout-chunk" data-layout="l-screen-inset shaded">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>vip_rf</span> <span class='op'>&lt;-</span>  <span class='fu'><a href='https://rdrr.io/r/base/readRDS.html'>readRDS</a></span><span class='op'>(</span><span class='fu'>here</span><span class='fu'>::</span><span class='fu'><a href='https://here.r-lib.org//reference/here.html'>here</a></span><span class='op'>(</span><span class='st'>"TidyModWflSet_OUTPUT"</span>,<span class='st'>"vip_rf.RDS"</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>vip_xgb</span> <span class='op'>&lt;-</span>  <span class='fu'><a href='https://rdrr.io/r/base/readRDS.html'>readRDS</a></span><span class='op'>(</span><span class='fu'>here</span><span class='fu'>::</span><span class='fu'><a href='https://here.r-lib.org//reference/here.html'>here</a></span><span class='op'>(</span><span class='st'>"TidyModWflSet_OUTPUT"</span>,<span class='st'>"vip_xgb.RDS"</span><span class='op'>)</span><span class='op'>)</span>

<span class='fu'>ggplot_imp</span><span class='op'>(</span><span class='va'>vip_rf</span>, <span class='va'>vip_xgb</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-21"></span>
<img src="TIDYMODELSWFS_files/figure-html5/unnamed-chunk-21-1.png" alt="Costumn plot of the vip using the special ggplot function for the tree-based models" width="1920" />
<p class="caption">
Figure 21: Costumn plot of the vip using the special ggplot function for the tree-based models
</p>
</div>
</div>
<strong>VIP for the cart and glm models</strong> (even though the cart model is a decision tree model)
<div class="layout-chunk" data-layout="l-screen-inset shaded">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>vip_cart</span> <span class='op'>&lt;-</span>  <span class='fu'><a href='https://rdrr.io/r/base/readRDS.html'>readRDS</a></span><span class='op'>(</span><span class='fu'>here</span><span class='fu'>::</span><span class='fu'><a href='https://here.r-lib.org//reference/here.html'>here</a></span><span class='op'>(</span><span class='st'>"TidyModWflSet_OUTPUT"</span>,<span class='st'>"vip_cart.RDS"</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>vip_glm</span> <span class='op'>&lt;-</span>  <span class='fu'><a href='https://rdrr.io/r/base/readRDS.html'>readRDS</a></span><span class='op'>(</span><span class='fu'>here</span><span class='fu'>::</span><span class='fu'><a href='https://here.r-lib.org//reference/here.html'>here</a></span><span class='op'>(</span><span class='st'>"TidyModWflSet_OUTPUT"</span>,<span class='st'>"vip_glm.RDS"</span><span class='op'>)</span><span class='op'>)</span>

<span class='fu'>ggplot_imp</span><span class='op'>(</span><span class='va'>vip_cart</span>, <span class='va'>vip_glm</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-22"></span>
<img src="TIDYMODELSWFS_files/figure-html5/unnamed-chunk-22-1.png" alt="Costumn plot of the vip using the special ggplot function for the cart and glm models" width="1920" />
<p class="caption">
Figure 22: Costumn plot of the vip using the special ggplot function for the cart and glm models
</p>
</div>
</div>
<p>The differences are quite substantial!</p>
<h2 id="step-15-model-exploration-and-agnosticcs-from-partial-dependencce-plots">STEP 15: Model exploration and agnosticcs from partial dependencce plots</h2>
<p>BUILDING GLOBAL EXPLANATIONS FROM LOCAL EXPLANATIONS. So far we have focused on local model explanations for a single observation (via Shapley additive explanations) and global model explanations for a data set as a whole (via permuting features). It is also possible to build global model explanations up by aggregating local model explanations, as with partial dependence profiles.</p>
<p><strong>Note:</strong> Partial dependence profiles show how the expected value of a model prediction, like the response ratio of agroforestry, changes as a function of a particular feature, like the precipitation of driest quarter or soil sand content.</p>
<p>One way to build such a profile is by aggregating or averaging profiles for individual observations. A profile showing how an individual observation’s prediction changes as a function of a given feature is called an ICE (individual conditional expectation) profile or a CP (ceteris paribus) profile. We can compute such individual profiles (for 500 of the observations in our training set) and then aggregate them using the DALEX function model_profile(). pdp = partial dependency plots</p>
<p>Let’s create another function for plotting the underlying data in this object:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>ggplot_pdp</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>obj</span>, <span class='va'>x</span><span class='op'>)</span> <span class='op'>{</span>
  
  <span class='va'>p</span> <span class='op'>&lt;-</span> 
    <span class='fu'>as_tibble</span><span class='op'>(</span><span class='va'>obj</span><span class='op'>$</span><span class='va'>agr_profiles</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
    <span class='fu'>mutate</span><span class='op'>(</span>`_label_` <span class='op'>=</span> <span class='fu'>stringr</span><span class='fu'>::</span><span class='fu'><a href='https://stringr.tidyverse.org/reference/str_remove.html'>str_remove</a></span><span class='op'>(</span><span class='va'>`_label_`</span>, <span class='st'>"^[^_]*_"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
    <span class='fu'>ggplot</span><span class='op'>(</span><span class='fu'>aes</span><span class='op'>(</span><span class='va'>`_x_`</span>, <span class='va'>`_yhat_`</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
    <span class='fu'>geom_line</span><span class='op'>(</span>data <span class='op'>=</span> <span class='fu'>as_tibble</span><span class='op'>(</span><span class='va'>obj</span><span class='op'>$</span><span class='va'>cp_profiles</span><span class='op'>)</span>,
              <span class='fu'>aes</span><span class='op'>(</span>x <span class='op'>=</span> <span class='op'>{</span><span class='op'>{</span> <span class='va'>x</span> <span class='op'>}</span><span class='op'>}</span>, group <span class='op'>=</span> <span class='va'>`_ids_`</span><span class='op'>)</span>,
              size <span class='op'>=</span> <span class='fl'>0.5</span>, alpha <span class='op'>=</span> <span class='fl'>0.05</span>, color <span class='op'>=</span> <span class='st'>"gray50"</span><span class='op'>)</span>
  
  <span class='va'>num_colors</span> <span class='op'>&lt;-</span> <span class='fu'>n_distinct</span><span class='op'>(</span><span class='va'>obj</span><span class='op'>$</span><span class='va'>agr_profiles</span><span class='op'>$</span><span class='va'>`_label_`</span><span class='op'>)</span>
  
  <span class='kw'>if</span> <span class='op'>(</span><span class='va'>num_colors</span> <span class='op'>&gt;</span> <span class='fl'>1</span><span class='op'>)</span> <span class='op'>{</span>
    <span class='va'>p</span> <span class='op'>&lt;-</span> <span class='va'>p</span> <span class='op'>+</span> <span class='fu'>geom_line</span><span class='op'>(</span><span class='fu'>aes</span><span class='op'>(</span>color <span class='op'>=</span> <span class='va'>`_label_`</span><span class='op'>)</span>, size <span class='op'>=</span> <span class='fl'>1.2</span>, alpha <span class='op'>=</span> <span class='fl'>0.8</span><span class='op'>)</span>
  <span class='op'>}</span> <span class='kw'>else</span> <span class='op'>{</span>
    <span class='va'>p</span> <span class='op'>&lt;-</span> <span class='va'>p</span> <span class='op'>+</span> <span class='fu'>geom_line</span><span class='op'>(</span>color <span class='op'>=</span> <span class='st'>"midnightblue"</span>, size <span class='op'>=</span> <span class='fl'>1.2</span>, alpha <span class='op'>=</span> <span class='fl'>0.8</span><span class='op'>)</span>
  <span class='op'>}</span>
  
  <span class='va'>p</span>
<span class='op'>}</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># LOADING/READING THE EXPLAINERS</span>
<span class='va'>explainer_rf</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/readRDS.html'>readRDS</a></span><span class='op'>(</span><span class='fu'>here</span><span class='fu'>::</span><span class='fu'><a href='https://here.r-lib.org//reference/here.html'>here</a></span><span class='op'>(</span><span class='st'>"TidyModWflSet_OUTPUT"</span>,<span class='st'>"explainer_rf.RDS"</span><span class='op'>)</span><span class='op'>)</span>
<span class='co'># explainer_xgb &lt;- readRDS(here::here("TidyModWflSet_OUTPUT","explainer_rf.RDS"))</span>
<span class='co'># explainer_rf &lt;- readRDS(here::here("TidyModWflSet_OUTPUT","explainer_rf.RDS"))</span>
<span class='co'># explainer_rf &lt;- readRDS(here::here("TidyModWflSet_OUTPUT","explainer_rf.RDS"))</span>

<span class='co'># Random Forest model</span>
<span class='co'># -----------------------------------------------------------------------------------</span>
<span class='co'># Silt content</span>
<span class='va'>pdp_iSDA_SILT</span> <span class='op'>&lt;-</span> <span class='fu'>model_profile</span><span class='op'>(</span><span class='va'>explainer_rf</span>, 
                               N <span class='op'>=</span> <span class='fl'>500</span>, 
                               variables <span class='op'>=</span> <span class='st'>"iSDA_SILT_conc"</span><span class='op'>)</span>

<span class='co'># Sand content</span>
<span class='va'>pdp_iSDA_SAND</span> <span class='op'>&lt;-</span> <span class='fu'>model_profile</span><span class='op'>(</span><span class='va'>explainer_rf</span>, 
                               N <span class='op'>=</span> <span class='fl'>500</span>, 
                               variables <span class='op'>=</span> <span class='st'>"iSDA_SAND_conc"</span><span class='op'>)</span>

<span class='co'># Mean diurnal temperature range</span>
<span class='va'>pdp_Bio02_MDR</span> <span class='op'>&lt;-</span> <span class='fu'>model_profile</span><span class='op'>(</span><span class='va'>explainer_rf</span>, 
                               N <span class='op'>=</span> <span class='fl'>500</span>, 
                               variables <span class='op'>=</span> <span class='st'>"Bio02_MDR"</span><span class='op'>)</span>

<span class='co'># Precipitation of driest quarter</span>
<span class='va'>pdp_Bio09_MT_DryQ</span> <span class='op'>&lt;-</span> <span class='fu'>model_profile</span><span class='op'>(</span><span class='va'>explainer_rf</span>, 
                               N <span class='op'>=</span> <span class='fl'>500</span>, 
                               variables <span class='op'>=</span> <span class='st'>"Bio17_Precip_DryQ"</span><span class='op'>)</span>

<span class='co'># Temperature Sum</span>
<span class='va'>pdp_Bio04_TS</span> <span class='op'>&lt;-</span> <span class='fu'>model_profile</span><span class='op'>(</span><span class='va'>explainer_rf</span>, 
                              N <span class='op'>=</span> <span class='fl'>500</span>, 
                              variables <span class='op'>=</span> <span class='st'>"Bio04_TS"</span><span class='op'>)</span>

<span class='co'>#GROUPINGS</span>

<span class='co'># Sand content with grouping of Site Type (research station / farm)</span>
<span class='va'>pdp_iSDA_SAND_conc_sitetype</span> <span class='op'>&lt;-</span> <span class='fu'>model_profile</span><span class='op'>(</span><span class='va'>explainer_rf</span>, 
                              N <span class='op'>=</span> <span class='fl'>500</span>, 
                              variables <span class='op'>=</span> <span class='st'>"iSDA_SAND_conc"</span>,
                              groups <span class='op'>=</span> <span class='st'>"Site.Type"</span><span class='op'>)</span> 

<span class='co'># Sand content with grouping of Tree speies (what species of tree)</span>
<span class='va'>pdp_iSDA_SAND_conc_tree</span> <span class='op'>&lt;-</span> <span class='fu'>model_profile</span><span class='op'>(</span><span class='va'>explainer_rf</span>, 
                              N <span class='op'>=</span> <span class='fl'>500</span>, 
                              variables <span class='op'>=</span> <span class='st'>"iSDA_SAND_conc"</span>,
                              groups <span class='op'>=</span> <span class='st'>"Tree"</span><span class='op'>)</span> <span class='co'>#%&gt;%</span>
  <span class='co'>#dplyr::filter(Tree == "Faidherbia albida" |</span>
  <span class='co'>#                Tree == "Cassia spectabilis")</span>
</code></pre>
</div>
</details>
</div>
<strong>Partial dependence plot for Silt content</strong>
<div class="layout-chunk" data-layout="l-screen-inset shaded">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>ggplot_pdp</span><span class='op'>(</span><span class='va'>pdp_iSDA_SILT</span>, <span class='va'>iSDA_SILT_conc</span><span class='op'>)</span>  <span class='op'>+</span>
  <span class='fu'>labs</span><span class='op'>(</span>x <span class='op'>=</span> <span class='st'>"Soil SILT content"</span>, 
       y <span class='op'>=</span> <span class='st'>"Predicted response ratio (log scale)"</span>,
       color <span class='op'>=</span> <span class='cn'>NULL</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>ggtitle</span><span class='op'>(</span><span class='st'>"Partial dependence plot based on the Random Forest model, feature: Silt content"</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-23"></span>
<img src="TIDYMODELSWFS_files/figure-html5/unnamed-chunk-23-1.png" alt="Partial dependence plot for silt content" width="960" />
<p class="caption">
Figure 23: Partial dependence plot for silt content
</p>
</div>
</div>
<strong>Partial dependence plot for Sand content</strong>
<div class="layout-chunk" data-layout="l-screen-inset shaded">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>ggplot_pdp</span><span class='op'>(</span><span class='va'>pdp_iSDA_SAND</span>, <span class='va'>iSDA_SAND_conc</span><span class='op'>)</span>  <span class='op'>+</span>
  <span class='fu'>labs</span><span class='op'>(</span>x <span class='op'>=</span> <span class='st'>"Soil SAND content"</span>, 
       y <span class='op'>=</span> <span class='st'>"Predicted response ratio (log scale)"</span>, 
       color <span class='op'>=</span> <span class='cn'>NULL</span><span class='op'>)</span>  <span class='op'>+</span>
  <span class='fu'>ggtitle</span><span class='op'>(</span><span class='st'>"Partial dependence plot based on the Random Forest model, feature: Sand content"</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-24"></span>
<img src="TIDYMODELSWFS_files/figure-html5/unnamed-chunk-24-1.png" alt="Partial dependence plot for sand content" width="960" />
<p class="caption">
Figure 24: Partial dependence plot for sand content
</p>
</div>
</div>
<strong>Partial dependence plot for Mean Diurnal Temperature Range</strong>
<div class="layout-chunk" data-layout="l-screen-inset shaded">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>ggplot_pdp</span><span class='op'>(</span><span class='va'>pdp_Bio02_MDR</span>, <span class='va'>Bio02_MDR</span><span class='op'>)</span>  <span class='op'>+</span>
  <span class='fu'>labs</span><span class='op'>(</span>x <span class='op'>=</span> <span class='st'>"Mean Diurnal Temperature Range"</span>, 
       y <span class='op'>=</span> <span class='st'>"Predicted response ratio (log scale)"</span>, 
       color <span class='op'>=</span> <span class='cn'>NULL</span><span class='op'>)</span>  <span class='op'>+</span>
  <span class='fu'>ggtitle</span><span class='op'>(</span><span class='st'>"Partial dependence plot based on the Random Forest model, feature: Mean Diurnal Temperature Range"</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-25"></span>
<img src="TIDYMODELSWFS_files/figure-html5/unnamed-chunk-25-1.png" alt="Partial dependence plot for Mean Diurnal Temperature Range" width="960" />
<p class="caption">
Figure 25: Partial dependence plot for Mean Diurnal Temperature Range
</p>
</div>
</div>
<strong>Partial dependence plot for Precipitation of Driest Quarter</strong>
<div class="layout-chunk" data-layout="l-screen-inset shaded">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>ggplot_pdp</span><span class='op'>(</span><span class='va'>pdp_Bio09_MT_DryQ</span>, <span class='va'>Bio17_Precip_DryQ</span><span class='op'>)</span>  <span class='op'>+</span>
  <span class='fu'>labs</span><span class='op'>(</span>x <span class='op'>=</span> <span class='st'>"Precipitation of Driest Quarter"</span>, 
       y <span class='op'>=</span> <span class='st'>"Predicted response ratio (log scale)"</span>, 
       color <span class='op'>=</span> <span class='cn'>NULL</span><span class='op'>)</span>  <span class='op'>+</span>
  <span class='fu'>ggtitle</span><span class='op'>(</span><span class='st'>"Partial dependence plot based on the Random Forest model, feature: Precipitation of Driest Quarter"</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-26"></span>
<img src="TIDYMODELSWFS_files/figure-html5/unnamed-chunk-26-1.png" alt="Partial dependence plot for Precipitation of Driest Quarter" width="960" />
<p class="caption">
Figure 26: Partial dependence plot for Precipitation of Driest Quarter
</p>
</div>
</div>
<strong>Partial dependence plot for Temperature Sum</strong>
<div class="layout-chunk" data-layout="l-screen-inset shaded">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>ggplot_pdp</span><span class='op'>(</span><span class='va'>pdp_Bio04_TS</span>, <span class='va'>Bio04_TS</span><span class='op'>)</span>  <span class='op'>+</span>
  <span class='fu'>labs</span><span class='op'>(</span>x <span class='op'>=</span> <span class='st'>"Temperature Sum"</span>, 
       y <span class='op'>=</span> <span class='st'>"Predicted response ratio (log scale)"</span>, 
       color <span class='op'>=</span> <span class='cn'>NULL</span><span class='op'>)</span>  <span class='op'>+</span>
  <span class='fu'>ggtitle</span><span class='op'>(</span><span class='st'>"Partial dependence plot based on the Random Forest model, feature: Temperature Sum"</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-27"></span>
<img src="TIDYMODELSWFS_files/figure-html5/unnamed-chunk-27-1.png" alt="Partial dependence plot for Temperature Sumr" width="960" />
<p class="caption">
Figure 27: Partial dependence plot for Temperature Sumr
</p>
</div>
</div>
<p>Partial dependence profiles can be computed for any other feature in the model, and also for groups in the data. Let’s try making a partial dependence plot of the groups of Site Type. In this way we can identify potential differences between response on researcch stations and/or farms. We will use the environmental predictor feature “Sand content”:</p>
<strong>Partial dependence plot on Sand content with grouping of Tree speccies</strong>
<div class="layout-chunk" data-layout="l-screen-inset shaded">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>ggplot_pdp</span><span class='op'>(</span><span class='va'>pdp_iSDA_SAND_conc_sitetype</span>, <span class='va'>iSDA_SAND_conc</span><span class='op'>)</span>  <span class='op'>+</span>
  <span class='fu'>labs</span><span class='op'>(</span>x <span class='op'>=</span> <span class='st'>"Sand content"</span>, 
       y <span class='op'>=</span> <span class='st'>"Predicted response ratio (log scale)"</span>, 
       color <span class='op'>=</span> <span class='cn'>NULL</span><span class='op'>)</span>  <span class='op'>+</span>
  <span class='fu'>ggtitle</span><span class='op'>(</span><span class='st'>"Partial dependence plot based on the Random Forest model, feature: Sand content with grouping of Site Type"</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-28"></span>
<img src="TIDYMODELSWFS_files/figure-html5/unnamed-chunk-28-1.png" alt="Partial dependence plot for Grouping of Site Type on Sand content" width="960" />
<p class="caption">
Figure 28: Partial dependence plot for Grouping of Site Type on Sand content
</p>
</div>
</div>
<p>We see there is a slight difference with experiments conducted at stations and survey data having generally higher predicted response ratios..? That is interesting!</p>
<p>Let’s see for tree species:</p>
<strong>Partial dependence plot on Sand content with grouping of Tree species</strong>
<div class="layout-chunk" data-layout="l-screen-inset shaded">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>ggplot_pdp</span><span class='op'>(</span><span class='va'>pdp_iSDA_SAND_conc_tree</span>, <span class='va'>iSDA_SAND_conc</span><span class='op'>)</span>  <span class='op'>+</span>
  <span class='fu'>labs</span><span class='op'>(</span>x <span class='op'>=</span> <span class='st'>"Soil SAND content"</span>, 
       y <span class='op'>=</span> <span class='st'>"Predicted response ratio (log scale)"</span>, 
       color <span class='op'>=</span> <span class='cn'>NULL</span><span class='op'>)</span>  <span class='op'>+</span>
  <span class='fu'>ggtitle</span><span class='op'>(</span><span class='st'>"Partial dependence plot based on the Random Forest model, feature: Sand content with grouping of Tree species"</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>theme</span><span class='op'>(</span>legend.position<span class='op'>=</span><span class='st'>"bottom"</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-29"></span>
<img src="TIDYMODELSWFS_files/figure-html5/unnamed-chunk-29-1.png" alt="Partial dependence plot for Sand content with grouping of Tree species" width="1920" />
<p class="caption">
Figure 29: Partial dependence plot for Sand content with grouping of Tree species
</p>
</div>
</div>
<h2 id="step-16-global-model-partial-dependencce-plots">STEP 16: Global model partial dependencce plots</h2>
<p>We can show how each model predicts depending on a selected feature using the “type =”partial"" argument and then add all our models.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># LOADING/READING EXPLAINERS</span>
<span class='va'>explainer_rf_continous</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/readRDS.html'>readRDS</a></span><span class='op'>(</span><span class='fu'>here</span><span class='fu'>::</span><span class='fu'><a href='https://here.r-lib.org//reference/here.html'>here</a></span><span class='op'>(</span><span class='st'>"TidyModWflSet_OUTPUT"</span>,<span class='st'>"explainer_rf_continous.RDS"</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>explainer_xgb_continous</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/readRDS.html'>readRDS</a></span><span class='op'>(</span><span class='fu'>here</span><span class='fu'>::</span><span class='fu'><a href='https://here.r-lib.org//reference/here.html'>here</a></span><span class='op'>(</span><span class='st'>"TidyModWflSet_OUTPUT"</span>,<span class='st'>"explainer_xgb_continous.RDS"</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>explainer_cart_continous</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/readRDS.html'>readRDS</a></span><span class='op'>(</span><span class='fu'>here</span><span class='fu'>::</span><span class='fu'><a href='https://here.r-lib.org//reference/here.html'>here</a></span><span class='op'>(</span><span class='st'>"TidyModWflSet_OUTPUT"</span>,<span class='st'>"explainer_cart_continous.RDS"</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>explainer_glm_continous</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/readRDS.html'>readRDS</a></span><span class='op'>(</span><span class='fu'>here</span><span class='fu'>::</span><span class='fu'><a href='https://here.r-lib.org//reference/here.html'>here</a></span><span class='op'>(</span><span class='st'>"TidyModWflSet_OUTPUT"</span>,<span class='st'>"explainer_glm_continous.RDS"</span><span class='op'>)</span><span class='op'>)</span>

<span class='va'>pdp_rf_grade</span> <span class='op'>&lt;-</span> <span class='fu'>model_profile</span><span class='op'>(</span><span class='va'>explainer_rf_continous</span>, variable <span class='op'>=</span> <span class='st'>"iSDA_SAND_conc"</span>, type <span class='op'>=</span> <span class='st'>"partial"</span><span class='op'>)</span>
<span class='va'>pdp_xgb_grade</span> <span class='op'>&lt;-</span> <span class='fu'>model_profile</span><span class='op'>(</span><span class='va'>explainer_xgb_continous</span>, variable <span class='op'>=</span> <span class='st'>"iSDA_SAND_conc"</span>, type <span class='op'>=</span> <span class='st'>"partial"</span><span class='op'>)</span>
<span class='va'>pdp_cart_grade</span> <span class='op'>&lt;-</span> <span class='fu'>model_profile</span><span class='op'>(</span><span class='va'>explainer_cart_continous</span>, variable <span class='op'>=</span> <span class='st'>"iSDA_SAND_conc"</span>, type <span class='op'>=</span> <span class='st'>"partial"</span><span class='op'>)</span>
<span class='va'>pdp_glm_grade</span> <span class='op'>&lt;-</span> <span class='fu'>model_profile</span><span class='op'>(</span><span class='va'>explainer_glm_continous</span>, variable <span class='op'>=</span> <span class='st'>"iSDA_SAND_conc"</span>, type <span class='op'>=</span> <span class='st'>"partial"</span><span class='op'>)</span>
</code></pre>
</div>
</details>
</div>
<div class="layout-chunk" data-layout="l-screen-inset shaded">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>pdp_rf_grade</span>, <span class='va'>pdp_xgb_grade</span>, <span class='va'>pdp_cart_grade</span>, <span class='va'>pdp_glm_grade</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-30"></span>
<img src="TIDYMODELSWFS_files/figure-html5/unnamed-chunk-30-1.png" alt="Global model partial dependencce plots for feature; Sand content" width="576" />
<p class="caption">
Figure 30: Global model partial dependencce plots for feature; Sand content
</p>
</div>
</div>
<h2 id="step-17-global-model-residual-evaluation">STEP 17: Global model residual evaluation</h2>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>rf_modperf</span> <span class='op'>&lt;-</span> <span class='fu'>DALEX</span><span class='fu'>::</span><span class='fu'><a href='https://dalex.drwhy.ai/reference/model_performance.html'>model_performance</a></span><span class='op'>(</span><span class='va'>explainer_rf_continous</span><span class='op'>)</span>
<span class='va'>xgb_modperf</span> <span class='op'>&lt;-</span> <span class='fu'>DALEX</span><span class='fu'>::</span><span class='fu'><a href='https://dalex.drwhy.ai/reference/model_performance.html'>model_performance</a></span><span class='op'>(</span><span class='va'>explainer_xgb_continous</span><span class='op'>)</span>
<span class='va'>cart_modperf</span> <span class='op'>&lt;-</span> <span class='fu'>DALEX</span><span class='fu'>::</span><span class='fu'><a href='https://dalex.drwhy.ai/reference/model_performance.html'>model_performance</a></span><span class='op'>(</span><span class='va'>explainer_cart_continous</span><span class='op'>)</span>
<span class='va'>glm_modperf</span> <span class='op'>&lt;-</span> <span class='fu'>DALEX</span><span class='fu'>::</span><span class='fu'><a href='https://dalex.drwhy.ai/reference/model_performance.html'>model_performance</a></span><span class='op'>(</span><span class='va'>explainer_glm_continous</span><span class='op'>)</span>
</code></pre>
</div>
</details>
</div>
<div class="layout-chunk" data-layout="l-screen-inset shaded">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>rf_modperf</span>, <span class='va'>xgb_modperf</span>, <span class='va'>cart_modperf</span>, <span class='va'>glm_modperf</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-31"></span>
<img src="TIDYMODELSWFS_files/figure-html5/unnamed-chunk-31-1.png" alt="Global model residual evaluation: Reverse cumulative of the absolute residual plot" width="576" />
<p class="caption">
Figure 31: Global model residual evaluation: Reverse cumulative of the absolute residual plot
</p>
</div>
</div>
<p>From the reverse cumulative of the absolute residual plot, we can see that the models are extremly similar! It shows a higher number of large residuals in the left hand side compared to right for all the models.</p>
<div class="layout-chunk" data-layout="l-screen-inset shaded">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>rf_modperf</span>, <span class='va'>xgb_modperf</span>, <span class='va'>cart_modperf</span>, <span class='va'>glm_modperf</span>, geom <span class='op'>=</span> <span class='st'>"boxplot"</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-32"></span>
<img src="TIDYMODELSWFS_files/figure-html5/unnamed-chunk-32-1.png" alt="Global model residual evaluation: Boxplot of mean residual vavlues" width="576" />
<p class="caption">
Figure 32: Global model residual evaluation: Boxplot of mean residual vavlues
</p>
</div>
</div>
<p>The boxplot figure above shows that all models have very similar median absolute residual values. We can also plot the distribution of residuals with histograms by using geom=“histogram” and the precision recall curve by using geom=“prc.” Let’s use the geom=“histogram” to vvisualise the distribution of residuals of the models:</p>
<div class="layout-chunk" data-layout="l-screen-inset shaded">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>rf_modperf</span>, <span class='va'>xgb_modperf</span>, <span class='va'>cart_modperf</span>, <span class='va'>glm_modperf</span>, geom <span class='op'>=</span> <span class='st'>"histogram"</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-33"></span>
<img src="TIDYMODELSWFS_files/figure-html5/unnamed-chunk-33-1.png" alt="Global model residual evaluation: Residual distribution histogram" width="576" />
<p class="caption">
Figure 33: Global model residual evaluation: Residual distribution histogram
</p>
</div>
</div>
<p>The residuals of the models follow to a great deal the normal distribution, which is a good sign!</p>
<h2 id="step-18-global-and-local-model-explorotive-analysis-agnostics-using-ceteris-paribus-profiles-cpp">STEP 18: Global and local model explorotive analysis (agnostics) using Ceteris Paribus Profiles (CPP)</h2>
<p>In the previous section, we have discussed the partial dependence plots. The Ceteris Paribus Profiles (CPP) is the single observation level version of the PDP plots. To create this plot, we can use predict_profile() function in the DALEX package. In the following example, we select two predictors for the same observation (i.e., student 1) and create a CPP plot for the RF model. In the plot, blue dots represent the original values for the selected observation.</p>
<h3 id="generating-new-observation-for-the-cpp-plot">Generating new observation for the CPP plot</h3>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>new_obs_1</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>PrName <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span><span class='op'>(</span><span class='st'>"Agroforestry Pruning-Alleycropping"</span>, levels <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Parklands"</span>, <span class='st'>"Agroforestry Pruning-Organic Fertilizer"</span>, 
                                                                                          <span class='st'>"Agroforestry Pruning"</span>, <span class='st'>"Agroforestry Pruning-Inorganic Fertilizer"</span>, 
                                                                                          <span class='st'>"Agroforestry Pruning-Alleycropping"</span>, <span class='st'>"Alleycropping"</span>, 
                                                                                          <span class='st'>"Agroforestry Pruning-Alleycropping-Inorganic Fertilizer"</span>, 
                                                                                          <span class='st'>"Alleycropping-Inorganic Fertilizer"</span>, <span class='st'>"Agroforestry Pruning-Alleycropping-Organic Fertilizer"</span>,
                                                                                          <span class='st'>"Agroforestry Pruning-Alleycropping-Reduced Tillage"</span>, <span class='st'>"Agroforestry Pruning-Parklands"</span>,
                                                                                          <span class='st'>"Agroforestry Pruning-Boundary Planting"</span>, 
                                                                                          <span class='st'>"Agroforestry Pruning-Boundary Planting-Inorganic Fertilizer"</span>, 
                                                                                          <span class='st'>"Agroforestry Fallow-Agroforestry Pruning"</span>, 
                                                                                          <span class='st'>"Agroforestry Fallow-Agroforestry Pruning-Alleycropping"</span>, 
                                                                                          <span class='st'>"Agroforestry Pruning-Alleycropping-Intercropping"</span>, 
                                                                                          <span class='st'>"Agroforestry Pruning-Green Manure"</span>, <span class='st'>"Agroforestry Pruning-Green Manure-Inorganic Fertilizer"</span>,
                                                                                          <span class='st'>"Agroforestry Fallow"</span>,  <span class='st'>"Agroforestry Fallow-Water Harvesting"</span>, 
                                                                                          <span class='st'>"Agroforestry Fallow-Agroforestry Pruning-Reduced Tillage"</span>, <span class='st'>"Agroforestry Pruning-Intercropping"</span>,
                                                                                          <span class='st'>"Other Agroforestry"</span>, <span class='st'>"Mulch-Other Agroforestry-Reduced Tillage"</span>, 
                                                                                          <span class='st'>"Agroforestry Pruning-Reduced Tillage-Water Harvesting"</span><span class='op'>)</span><span class='op'>)</span>,
                        Out.SubInd <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span><span class='op'>(</span><span class='st'>"Crop Yield"</span>, levels <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Biomass Yield"</span>, <span class='st'>"Soil Organic Carbon"</span>, <span class='st'>"Soil Nitrogen"</span>, <span class='st'>"Crop Yield"</span>, <span class='st'>"Carbon Dioxide Emissions"</span>, <span class='st'>"Gross Return"</span>,
                                                                      <span class='st'>"Marginal Rate of Return"</span>, <span class='st'>"Beneficial Organisms"</span>, <span class='st'>"Nitrogen Use Efficiency (ARE AGB)"</span>, <span class='st'>"Cation Exchange Capacity"</span>,
                                                                      <span class='st'>"Phosphorus Use Efficiency (ARE AGB)"</span>, <span class='st'>"Potassium Use Efficiency (ARE AGB)"</span>, <span class='st'>"Soil Organic Carbon (Change)"</span>, 
                                                                      <span class='st'>"Water Use Efficiency"</span>, <span class='st'>"Soil Moisture"</span>, <span class='st'>"Labour Person Hours"</span>, <span class='st'>"Labour Cost"</span>, <span class='st'>"Variable Cost"</span>, <span class='st'>"Net Return"</span>,
                                                                      <span class='st'>"Benefit Cost Ratio (NRTC)"</span>, <span class='st'>"Return to Labour"</span>, <span class='st'>"Gross Margin"</span>, <span class='st'>"Benefit Cost Ratio (GRVC)"</span>, <span class='st'>"Net Present Value"</span>,
                                                                      <span class='st'>"Biodiversity"</span>, <span class='st'>"Phosphorus Agronomic Efficiency"</span>, <span class='st'>"Soil Organic Matter"</span>, <span class='st'>"Nitrogen Factor Productivity"</span>, <span class='st'>"Water Use"</span>,
                                                                      <span class='st'>"Infiltration Rate"</span>, <span class='st'>"Runoff"</span>, <span class='st'>"Erosion"</span>, <span class='st'>"Soil Total Nitrogen"</span>, <span class='st'>"Soil Carbon Stocks"</span>, <span class='st'>"Soil Available Nitrogen"</span>,
                                                                      <span class='st'>"Nitrous Oxide Emissions"</span>, <span class='st'>"Methane Emissions"</span>, <span class='st'>"CO2 Equivalent Emissions"</span>, <span class='st'>"Benefit Cost Ratio (GRTC)"</span>, <span class='st'>"Soil NH4"</span>,
                                                                      <span class='st'>"Soil NO3"</span>, <span class='st'>"Land Equivalent Ratio"</span><span class='op'>)</span><span class='op'>)</span>,
                        Product <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span><span class='op'>(</span><span class='st'>"Maize"</span>, levels <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Pearl Millet"</span>, <span class='st'>"Maize"</span>, <span class='st'>"Wheat"</span>, <span class='st'>"Sorghum"</span>, <span class='st'>"Tomato (Total Yield)"</span>, <span class='st'>"Common Bean"</span>, <span class='st'>"Okra"</span>, <span class='st'>"Spinach"</span>, <span class='st'>"Sunflower (Seed)"</span>,
                                                              <span class='st'>"Rice"</span>, <span class='st'>"Sunflower (Oil)"</span>, <span class='st'>"Sesame Seed"</span>, <span class='st'>"Eggplant"</span>, <span class='st'>"Barley"</span>, <span class='st'>"Finger Millet"</span>, <span class='st'>"Soybean"</span><span class='op'>)</span><span class='op'>)</span>,
                        Tree <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span><span class='op'>(</span><span class='st'>"Senna siamea"</span>, levels <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Faidherbia albida"</span>, <span class='st'>"Aristida sieberiana"</span>, <span class='st'>"Guiera senegalensis"</span>, <span class='st'>"Calliandra calothyrsus"</span>, <span class='st'>"Sesbania sesban"</span>, 
                                                                  <span class='st'>"Leucaena leucocephala"</span>, <span class='st'>"Leucaena pallida"</span>, <span class='st'>"Acacia albida"</span>, <span class='st'>"Albizia gummifera"</span>, <span class='st'>"Cordia africana"</span>, 
                                                                  <span class='st'>"Croton macrostachyus"</span>, <span class='st'>"Milletia ferruginea"</span>, <span class='st'>"Gliricidia sepium"</span>, <span class='st'>"Unknown_Tree"</span>, <span class='st'>"Alnus acuminata"</span>, 
                                                                  <span class='st'>"Alnus acuminata.Calliandra calothyrsus.Sesbania sesban"</span>, <span class='st'>"Calliandra calothyrsus.Leucaena leucocephala"</span>, 
                                                                  <span class='st'>"Crotalaria juncea"</span>, <span class='st'>"Cupressus lusitanica"</span>, <span class='st'>"Casuarina equisetifolia"</span>, <span class='st'>"Markhamia lutea"</span>, <span class='st'>"Melia azedarach"</span>, 
                                                                  <span class='st'>"Cordia abyssinica"</span>, <span class='st'>"Maesopsis eminii"</span>, <span class='st'>"Senna spectabilis"</span>, <span class='st'>"Tithonia diversifolia"</span>, <span class='st'>"Acacia tumida"</span>, 
                                                                  <span class='st'>"Eucalyptus saligna"</span>, <span class='st'>"Flemingia macrophylla"</span>, <span class='st'>"Senna siamea"</span>, <span class='st'>"Leucaena leucocephala.Gliricidia Sepium"</span>, 
                                                                  <span class='st'>"Croton megalocarpus"</span>, <span class='st'>"Melia volkensii"</span>, <span class='st'>"Croton megalocarpus.Melia volkensii.Senna spectabilis.Gliricidia sepium"</span>,
                                                                  <span class='st'>"Pinus patula"</span>, <span class='st'>"Acacia saligna"</span>, <span class='st'>"Crotalaria grahamiana"</span>, <span class='st'>"Grevillea robusta"</span>, <span class='st'>"Paulownia fortunei"</span>, 
                                                                  <span class='st'>"Entada abyssinica"</span>, <span class='st'>"Dactyladenia barteri"</span>, <span class='st'>"Gliricidia"</span>, <span class='st'>"Flemingia"</span>, <span class='st'>"Cinnamomum cassia"</span>,<span class='st'>"Flemingia congesta"</span>, 
                                                                  <span class='st'>"Cassia siamea"</span>, <span class='st'>"cassia siamea"</span>, <span class='st'>"Leucaena leucocephala.Acioa barteri"</span>, <span class='st'>"Acioa barteri"</span>, <span class='st'>"Azadirachta indica"</span>,
                                                                  <span class='st'>"Parkia biglobosa"</span>, <span class='st'>"Millettia  thonningii"</span>, <span class='st'>"Pterocarpus santalinoides"</span>, <span class='st'>"Acacia angustissima"</span>,
                                                                  <span class='st'>"Tithonia diversifolia.Acacia angustissima"</span>, <span class='st'>"Tithonia diversifolia.Calliandra calothyrsus"</span>, 
                                                                  <span class='st'>"Tithonia diversifolia.Flemingia macrophylla"</span>, <span class='st'>"Elaeis guineensis"</span>, <span class='st'>"Leucaena leucocephala (Var K28)"</span>, 
                                                                  <span class='st'>"Cajanus cajan"</span>, <span class='st'>"Leucaena.Azadirachta indica.Parkia biglobosa"</span>, 
                                                                  <span class='st'>"Senna siamea.Leucaena leucocephala.Azadirachta indica"</span>, <span class='st'>"Vitellaria paradoxa.Parkia biglobosa"</span>, <span class='st'>"Vitellaria paradoxa"</span>,
                                                                  <span class='st'>"Parkia biglobosa.Vitellaria paradoxa"</span>, <span class='st'>"Parkia biglobosa.Adansonia digitata"</span>, <span class='st'>"Stylosanthes hamata"</span>, 
                                                                  <span class='st'>"Adansonia digitata"</span>, <span class='st'>"Albizia lebbeck"</span>, <span class='st'>"Acacia holosericea"</span>, <span class='st'>"Palm"</span>, <span class='st'>"Acacia senegal"</span>, <span class='st'>"Acacia crassicarpa"</span>, 
                                                                  <span class='st'>"Acacia mangium"</span>, <span class='st'>"Acacia polyacantha"</span>, <span class='st'>"Leucaena diversifolia"</span>, <span class='st'>"Tephrosia vogelii.Sesbania sesban"</span>, 
                                                                  <span class='st'>"Alchornea cordifolia"</span>, <span class='st'>"Uapaca kirkiana.Brachystegia spiciformis.Julbernardia globiflora"</span>, <span class='st'>"Uapaca kirkiana"</span>,
                                                                  <span class='st'>"Sesbania rostrata"</span>, <span class='st'>"Cassia spectabilis"</span>, <span class='st'>"Grevillea robusta.Cajanus cajan"</span>, <span class='st'>"Tephrosia vogelii"</span>, <span class='st'>"Sesbania cinerascens"</span>,
                                                                  <span class='st'>"Senna didymobotrya"</span>, <span class='st'>"Senna occidentalis"</span>, <span class='st'>"Eucalyptus camaldulensis"</span>, <span class='st'>"Pueraria phaseoloides"</span>, <span class='st'>"Acacia leptocarpa"</span>,
                                                                  <span class='st'>"Gliricida sepium"</span>, <span class='st'>"Flemingia macrophylla.Gliricidia sepium"</span>, <span class='st'>"Cedrela serrata"</span>, <span class='st'>"Acrocarpus fraxinifolius"</span>, 
                                                                  <span class='st'>"Cedrela odorata"</span>, <span class='st'>"Erythrina poeppigiana"</span>, <span class='st'>"Albizia chinensis"</span>, <span class='st'>"Piliostigma reticulatum"</span>, 
                                                                  <span class='st'>"Poupartia silvatica-Fernandoa madagascariensis-Tarenna sp"</span>, <span class='st'>"Acacia tortilis"</span>, <span class='st'>"Crotalaria ochrolueca"</span>, 
                                                                  <span class='st'>"Desmodium intortum"</span>, <span class='st'>"Bauhinia reticulata"</span>, <span class='st'>"Bauhinia reticulata-Guiera senegalensis"</span>, <span class='st'>"Acacia sp"</span><span class='op'>)</span><span class='op'>)</span>,
                        Out.SubInd.Code <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span><span class='op'>(</span><span class='st'>"CrY"</span>, levels <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"BiY"</span>, <span class='st'>"SOC"</span>, <span class='st'>"SN"</span>, <span class='st'>"CrY"</span>, <span class='st'>"CO2"</span>, <span class='st'>"GR"</span>, <span class='st'>"MRR"</span>, <span class='st'>"BO"</span>, <span class='st'>"NUE-Aag"</span>, <span class='st'>"CEC"</span>, <span class='st'>"PUE-Aag"</span>, <span class='st'>"KUE-Aag"</span>, <span class='st'>"SOCh"</span>, <span class='st'>"WUE"</span>, <span class='st'>"SM"</span>,
                                                                    <span class='st'>"La-ph"</span>, <span class='st'>"LC"</span>, <span class='st'>"VC"</span>, <span class='st'>"NR"</span>, <span class='st'>"BCR-NRTC"</span>, <span class='st'>"RtL"</span>, <span class='st'>"GM"</span>, <span class='st'>"BCR-GRVC"</span>, <span class='st'>"NOV"</span>, <span class='st'>"Bd"</span>, <span class='st'>"PAEp"</span>, <span class='st'>"SOM"</span>, <span class='st'>"NTFP"</span>, <span class='st'>"WU"</span>, <span class='st'>"In"</span>,
                                                                    <span class='st'>"Ru"</span>, <span class='st'>"Er"</span>, <span class='st'>"STN"</span>, <span class='st'>"SCS"</span>, <span class='st'>"SAN"</span>, <span class='st'>"NOx"</span>, <span class='st'>"CH4"</span>, <span class='st'>"CO2eq"</span>, <span class='st'>"BCR-GRTC"</span>, <span class='st'>"SNH4"</span>, <span class='st'>"SNO3"</span>, <span class='st'>"LER"</span><span class='op'>)</span><span class='op'>)</span>,
                        Site.Type <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span><span class='op'>(</span><span class='st'>"Station"</span>, levels <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Farm"</span>, <span class='st'>"Station"</span>, <span class='st'>"Survey"</span><span class='op'>)</span><span class='op'>)</span>,
                        Latitude <span class='op'>=</span> <span class='op'>-</span><span class='fl'>1.5824</span>,
                        Longitude <span class='op'>=</span> <span class='fl'>37.2432</span>,
                        
                        Bio01_MT_Annu <span class='op'>=</span> <span class='fl'>21.61667</span>, 
                        Bio02_MDR <span class='op'>=</span> <span class='fl'>9.716667</span>, 
                        Bio03_Iso <span class='op'>=</span> <span class='fl'>83.04844</span>, 
                        Bio04_TS <span class='op'>=</span> <span class='fl'>52.88638</span>, 
                        Bio05_TWM <span class='op'>=</span> <span class='fl'>27.5</span>, 
                        Bio06_MinTCM <span class='op'>=</span> <span class='fl'>15.8</span>, 
                        Bio07_TAR <span class='op'>=</span> <span class='fl'>11.7</span>, 
                        Bio08_MT_WetQ <span class='op'>=</span> <span class='fl'>21.8</span>, 
                        Bio09_MT_DryQ <span class='op'>=</span> <span class='fl'>20.91667</span>, 
                        Bio10_MT_WarQ <span class='op'>=</span> <span class='fl'>22.28333</span>, 
                        Bio11_MT_ColQ <span class='op'>=</span> <span class='fl'>20.91667</span>, 
                        Bio12_Pecip_Annu <span class='op'>=</span> <span class='fl'>1316</span>, 
                        Bio13_Precip_WetM <span class='op'>=</span> <span class='fl'>227</span>, 
                        Bio14_Precip_DryM <span class='op'>=</span> <span class='fl'>42</span>, 
                        Bio15_Precip_S <span class='op'>=</span> <span class='fl'>53.04502</span>, 
                        Bio16_Precip_WetQ <span class='op'>=</span> <span class='fl'>585</span>,
                        Bio17_Precip_DryQ <span class='op'>=</span> <span class='fl'>168</span>, 
                        iSDA_Depth_to_bedrock <span class='op'>=</span> <span class='fl'>199.99</span>, 
                        iSDA_SAND_conc <span class='op'>=</span> <span class='fl'>48.582</span>, 
                        iSDA_CLAY_conc <span class='op'>=</span> <span class='fl'>33.402</span>, 
                        iSDA_SILT_conc <span class='op'>=</span> <span class='fl'>16.748</span>, 
                        iSDA_log_C_tot <span class='op'>=</span> <span class='fl'>27.514</span>  , 
                        iSDA_FE_Bulk_dens <span class='op'>=</span> <span class='fl'>132.154</span>, 
                        iSDA_log_Ca <span class='op'>=</span> <span class='fl'>67.774</span>, 
                        iSDA_log_eCEC <span class='op'>=</span> <span class='fl'>27.786</span>, 
                        iSDA_log_Fe <span class='op'>=</span> <span class='fl'>35.182</span>, 
                        iSDA_log_K <span class='op'>=</span> <span class='fl'>53.296</span>, 
                        iSDA_log_Mg <span class='op'>=</span> <span class='fl'>55.09</span>,
                        iSDA_log_N <span class='op'>=</span> <span class='fl'>60.844</span>,
                        iSDA_log_SOC <span class='op'>=</span> <span class='fl'>22.29</span>, 
                        iSDA_log_P <span class='op'>=</span> <span class='fl'>24.798</span>,
                        iSDA_log_S <span class='op'>=</span> <span class='fl'>17.79</span>, 
                        iSDA_pH <span class='op'>=</span> <span class='fl'>59.784</span>,
                        ASTER_Altitude <span class='op'>=</span> <span class='fl'>1578.35</span>,
                        ASTER_Slope <span class='op'>=</span> <span class='fl'>4.2</span><span class='op'>)</span>
</code></pre>
</div>
</details>
</div>
<h3 id="creating-dataset-for-the-cpp-for-all-the-four-models-with-a-relatively-low-rr-observation">Creating dataset for the CPP for all the four models (with a relatively low RR observation)</h3>
<ul>
<li><strong>logRR = -0.3305098</strong></li>
</ul>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># Random Forest  ---------------------------------------------------------</span>

<span class='va'>cpp_newObs_1_rf</span> <span class='op'>&lt;-</span> <span class='fu'>DALEX</span><span class='fu'>::</span><span class='fu'><a href='https://dalex.drwhy.ai/reference/predict_profile.html'>predict_profile</a></span><span class='op'>(</span><span class='va'>explainer_rf_continous</span>, <span class='va'>new_obs_1</span><span class='op'>)</span>

<span class='co'># XGBoost  ---------------------------------------------------------</span>

<span class='va'>cpp_newObs_1_xgb</span> <span class='op'>&lt;-</span> <span class='fu'>DALEX</span><span class='fu'>::</span><span class='fu'><a href='https://dalex.drwhy.ai/reference/predict_profile.html'>predict_profile</a></span><span class='op'>(</span><span class='va'>explainer_xgb_continous</span>, <span class='va'>new_obs_1</span><span class='op'>)</span>

<span class='co'># Cart model  ---------------------------------------------------------</span>

<span class='va'>cpp_newObs_1_caret</span> <span class='op'>&lt;-</span> <span class='fu'>DALEX</span><span class='fu'>::</span><span class='fu'><a href='https://dalex.drwhy.ai/reference/predict_profile.html'>predict_profile</a></span><span class='op'>(</span><span class='va'>explainer_cart_continous</span>, <span class='va'>new_obs_1</span><span class='op'>)</span>

<span class='co'># Glm model ---------------------------------------------------------</span>

<span class='va'>cpp_newObs_1_glm</span> <span class='op'>&lt;-</span> <span class='fu'>DALEX</span><span class='fu'>::</span><span class='fu'><a href='https://dalex.drwhy.ai/reference/predict_profile.html'>predict_profile</a></span><span class='op'>(</span><span class='va'>explainer_glm_continous</span>, <span class='va'>new_obs_1</span><span class='op'>)</span>


<span class='co'># SAVING THE CPP DATA</span>
<span class='fu'><a href='https://rdrr.io/r/base/readRDS.html'>saveRDS</a></span><span class='op'>(</span><span class='va'>cpp_newObs_1_rf</span>, <span class='fu'>here</span><span class='fu'>::</span><span class='fu'><a href='https://here.r-lib.org//reference/here.html'>here</a></span><span class='op'>(</span><span class='st'>"TidyModWflSet_OUTPUT"</span>,<span class='st'>"cpp_newObs_1_rf.RDS"</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/readRDS.html'>saveRDS</a></span><span class='op'>(</span><span class='va'>cpp_newObs_1_xgb</span>, <span class='fu'>here</span><span class='fu'>::</span><span class='fu'><a href='https://here.r-lib.org//reference/here.html'>here</a></span><span class='op'>(</span><span class='st'>"TidyModWflSet_OUTPUT"</span>,<span class='st'>"cpp_newObs_1_xgb.RDS"</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/readRDS.html'>saveRDS</a></span><span class='op'>(</span><span class='va'>cpp_newObs_1_caret</span>, <span class='fu'>here</span><span class='fu'>::</span><span class='fu'><a href='https://here.r-lib.org//reference/here.html'>here</a></span><span class='op'>(</span><span class='st'>"TidyModWflSet_OUTPUT"</span>,<span class='st'>"cpp_newObs_1_caret.RDS"</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/readRDS.html'>saveRDS</a></span><span class='op'>(</span><span class='va'>cpp_newObs_1_glm</span>, <span class='fu'>here</span><span class='fu'>::</span><span class='fu'><a href='https://here.r-lib.org//reference/here.html'>here</a></span><span class='op'>(</span><span class='st'>"TidyModWflSet_OUTPUT"</span>,<span class='st'>"cpp_newObs_1_glm.RDS"</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<h3 id="visualising-the-cpp-for-the-random-forest-model-for-selected-environmental-predictor-features">Visualising the CPP for the Random Forest model for selected environmental predictor features</h3>
<strong>SOIL: CPP for RF with clay content, phosphorus concentration and pH</strong>
<div class="layout-chunk" data-layout="l-screen-inset shaded">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>cpp_newObs_1_rf</span> <span class='op'>&lt;-</span>  <span class='fu'><a href='https://rdrr.io/r/base/readRDS.html'>readRDS</a></span><span class='op'>(</span><span class='fu'>here</span><span class='fu'>::</span><span class='fu'><a href='https://here.r-lib.org//reference/here.html'>here</a></span><span class='op'>(</span><span class='st'>"TidyModWflSet_OUTPUT"</span>,<span class='st'>"cpp_newObs_1_rf.RDS"</span><span class='op'>)</span><span class='op'>)</span>

<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>cpp_newObs_1_rf</span>,
     variables <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"iSDA_CLAY_conc"</span>, <span class='st'>"iSDA_log_P"</span>, <span class='st'>"iSDA_pH"</span><span class='op'>)</span><span class='op'>)</span> 
</code></pre>
</div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-34"></span>
<img src="TIDYMODELSWFS_files/figure-html5/unnamed-chunk-34-1.png" alt="Ceteris paribus profiles for the Random Forest model, features; clay content, phosphorus concentration, pH" width="768" />
<p class="caption">
Figure 34: Ceteris paribus profiles for the Random Forest model, features; clay content, phosphorus concentration, pH
</p>
</div>
</div>
<strong>SOIL: CPP for RF with silt content, sand content and clay</strong>
<div class="layout-chunk" data-layout="l-screen-inset shaded">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"> <span class='co'>#cpp_newObs_1_rf &lt;-  readRDS(here::here("TidyModWflSet_OUTPUT","cpp_newObs_1_rf.RDS"))</span>

<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>cpp_newObs_1_rf</span>,
     variables <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"iSDA_SILT_conc"</span>, <span class='st'>"iSDA_SAND_conc"</span>, <span class='st'>"iSDA_CLAY_conc"</span><span class='op'>)</span><span class='op'>)</span> 
</code></pre>
</div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-35"></span>
<img src="TIDYMODELSWFS_files/figure-html5/unnamed-chunk-35-1.png" alt="Ceteris paribus profiles for the Random Forest model, features; clay content, phosphorus concentration, pH" width="768" />
<p class="caption">
Figure 35: Ceteris paribus profiles for the Random Forest model, features; clay content, phosphorus concentration, pH
</p>
</div>
</div>
<strong>TEMPERATURE: CPP for RF with mean diurnal temperature range, temperature annual range and mean temperature of driest quarter</strong>
<div class="layout-chunk" data-layout="l-screen-inset shaded">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># cpp_newObs_1_rf &lt;-  readRDS(here::here("TidyModWflSet_OUTPUT","cpp_newObs_1_rf.RDS"))</span>

<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>cpp_newObs_1_rf</span>,
     variables <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Bio02_MDR"</span>, <span class='st'>"Bio07_TAR"</span>, <span class='st'>"Bio09_MT_DryQ"</span><span class='op'>)</span><span class='op'>)</span> 
</code></pre>
</div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-36"></span>
<img src="TIDYMODELSWFS_files/figure-html5/unnamed-chunk-36-1.png" alt="Ceteris paribus profiles for the Random Forest model, features; mean diurnal temperature range, temperature annual range and mean temperature of driest quarter" width="768" />
<p class="caption">
Figure 36: Ceteris paribus profiles for the Random Forest model, features; mean diurnal temperature range, temperature annual range and mean temperature of driest quarter
</p>
</div>
</div>
<strong>PRECIPITATION: CPP for RF with precipitation seasonality, precipitation driest month and precipitation wettest quarter</strong>
<div class="layout-chunk" data-layout="l-screen-inset shaded">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># cpp_newObs_1_rf &lt;-  readRDS(here::here("TidyModWflSet_OUTPUT","cpp_newObs_1_rf.RDS"))</span>

<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>cpp_newObs_1_rf</span>,
     variables <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Bio15_Precip_S"</span>, <span class='st'>"Bio14_Precip_DryM"</span>, <span class='st'>"Bio16_Precip_WetQ"</span><span class='op'>)</span><span class='op'>)</span> 
</code></pre>
</div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-37"></span>
<img src="TIDYMODELSWFS_files/figure-html5/unnamed-chunk-37-1.png" alt="Ceteris paribus profiles for the Random Forest model, features; precipitation seasonality, precipitation driest month and precipitation wettest quarter" width="768" />
<p class="caption">
Figure 37: Ceteris paribus profiles for the Random Forest model, features; precipitation seasonality, precipitation driest month and precipitation wettest quarter
</p>
</div>
</div>
<p>There are many intersting functionalities in ther DALEX package. Check out <a href="https://okan.cloud/posts/2021-03-23-visualizing-machine-learning-models/">this website/blog</a> for more inspiration on the DALEX package</p>
<h2 id="step-19-using-the-models-to-predict-on-new-data">STEP 19: Using the models to predict on new data</h2>
<p>Let’s now try to use the models to predict on new data generated artificially from the training dataset. The expand_grid() function from the <a href="https://tidyr.tidyverse.org/reference/expand_grid.html">tidyr package</a> is excellent for this. The function creates a tibble from all combinations of input data, hence it extrapolate the data. We will use this newly generated data to create Marginal Effect plots, therefore it is needed to keep a single feature while keeping all others constant.</p>
<h3 id="first-removing-na-from-the-predictor-feature-columns">First, removing NA from the predictor feature columns</h3>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>af.train.wf</span> <span class='op'>%&gt;%</span>
  <span class='fu'>arrange</span><span class='op'>(</span><span class='op'>)</span>

<span class='va'>old_data</span> <span class='op'>&lt;-</span> <span class='va'>af.train.wf</span> <span class='op'>%&gt;%</span>
  <span class='fu'>rationalize</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>drop_na</span><span class='op'>(</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<h3 id="using-expand_grid-to-generate-new-data-from-the-traning-data">Using expand_grid to generate new data from the traning data</h3>
<p>Seven environmental predictor features are used to generate data for Marginal Effect plots. These predictors are having varied levels, while keeping all other features constant</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># CLAY ------------------------------------------------------------------------</span>
<span class='va'>new_test_data_var_CLAY</span> <span class='op'>&lt;-</span> 
  <span class='fu'>expand_grid</span><span class='op'>(</span>iSDA_CLAY_conc <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>10</span>, <span class='fl'>20</span>, <span class='fl'>30</span>, <span class='fl'>40</span><span class='op'>)</span>, 
            Site.Type <span class='op'>=</span> <span class='st'>"Station"</span>,
            PrName <span class='op'>=</span> <span class='st'>"Agroforestry Pruning"</span>, 
            Out.SubInd <span class='op'>=</span> <span class='st'>"Crop Yield"</span>, 
            Product <span class='op'>=</span> <span class='st'>"Maize"</span>, 
            Tree <span class='op'>=</span> <span class='st'>"Acacia albidam"</span>, 
            Out.SubInd.Code <span class='op'>=</span> <span class='st'>"CrY"</span>, 
            Latitude <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>Latitude</span><span class='op'>)</span>,
            Longitude <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>Longitude</span><span class='op'>)</span>,
            Bio01_MT_Annu <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>Bio01_MT_Annu</span><span class='op'>)</span>, 
            Bio02_MDR <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>Bio02_MDR</span><span class='op'>)</span>,
            Bio03_Iso <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>Bio03_Iso</span><span class='op'>)</span>,
            Bio04_TS <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>Bio04_TS</span><span class='op'>)</span>,
            Bio05_TWM <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>Bio05_TWM</span><span class='op'>)</span>,
            Bio06_MinTCM <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>Bio06_MinTCM</span><span class='op'>)</span>,
            Bio07_TAR <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>Bio07_TAR</span><span class='op'>)</span>,
            Bio08_MT_WetQ <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>Bio08_MT_WetQ</span><span class='op'>)</span>,
            Bio09_MT_DryQ <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>Bio09_MT_DryQ</span><span class='op'>)</span>,
            Bio10_MT_WarQ <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>Bio10_MT_WarQ</span><span class='op'>)</span>,
            Bio11_MT_ColQ <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>Bio11_MT_ColQ</span><span class='op'>)</span>,
            Bio12_Pecip_Annu <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>Bio12_Pecip_Annu</span><span class='op'>)</span>,
            Bio13_Precip_WetM <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>Bio13_Precip_WetM</span><span class='op'>)</span>,
            Bio14_Precip_DryM <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>Bio14_Precip_DryM</span><span class='op'>)</span>,
            Bio15_Precip_S <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>Bio15_Precip_S</span><span class='op'>)</span>,
            Bio16_Precip_WetQ <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>Bio16_Precip_WetQ</span><span class='op'>)</span>,
            Bio17_Precip_DryQ <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>Bio17_Precip_DryQ</span><span class='op'>)</span>,
            iSDA_Depth_to_bedrock <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>iSDA_Depth_to_bedrock</span><span class='op'>)</span>,
            iSDA_SAND_conc <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>iSDA_SAND_conc</span><span class='op'>)</span>,
            iSDA_SILT_conc <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>iSDA_SILT_conc</span><span class='op'>)</span>,
            iSDA_FE_Bulk_dens <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>iSDA_FE_Bulk_dens</span><span class='op'>)</span>,
            iSDA_log_C_tot <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>iSDA_log_C_tot</span><span class='op'>)</span>,
            iSDA_log_Ca <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>iSDA_log_Ca</span><span class='op'>)</span>,
            iSDA_log_eCEC <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>iSDA_log_eCEC</span><span class='op'>)</span>,
            iSDA_log_Fe <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>iSDA_log_Fe</span><span class='op'>)</span>,
            iSDA_log_K <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>iSDA_log_K</span><span class='op'>)</span>,
            iSDA_log_Mg <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>iSDA_log_Mg</span><span class='op'>)</span>,
            iSDA_log_N <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>iSDA_log_N</span><span class='op'>)</span>,
            iSDA_log_SOC <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>iSDA_log_SOC</span><span class='op'>)</span>,
            iSDA_log_P <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>iSDA_log_P</span><span class='op'>)</span>,
            iSDA_log_S <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>iSDA_log_S</span><span class='op'>)</span>,
            iSDA_pH <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>iSDA_pH</span><span class='op'>)</span>,
            ASTER_Altitude <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>ASTER_Altitude</span><span class='op'>)</span>,
            ASTER_Slope <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>ASTER_Slope</span><span class='op'>)</span><span class='op'>)</span>

<span class='co'># SAND ------------------------------------------------------------------------</span>
<span class='va'>new_test_data_var_SAND</span> <span class='op'>&lt;-</span> 
  <span class='fu'>expand_grid</span><span class='op'>(</span>iSDA_SAND_conc <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>50</span>, <span class='fl'>60</span>, <span class='fl'>70</span>, <span class='fl'>80</span><span class='op'>)</span>, 
            Site.Type <span class='op'>=</span> <span class='st'>"Station"</span>,
            PrName <span class='op'>=</span> <span class='st'>"Agroforestry Pruning"</span>, 
            Out.SubInd <span class='op'>=</span> <span class='st'>"Crop Yield"</span>, 
            Product <span class='op'>=</span> <span class='st'>"Maize"</span>, 
            Tree <span class='op'>=</span> <span class='st'>"Acacia albidam"</span>, 
            Out.SubInd.Code <span class='op'>=</span> <span class='st'>"CrY"</span>, 
            Latitude <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>Latitude</span><span class='op'>)</span>,
            Longitude <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>Longitude</span><span class='op'>)</span>,
            Bio01_MT_Annu <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>Bio01_MT_Annu</span><span class='op'>)</span>, 
            Bio02_MDR <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>Bio02_MDR</span><span class='op'>)</span>,
            Bio03_Iso <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>Bio03_Iso</span><span class='op'>)</span>,
            Bio04_TS <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>Bio04_TS</span><span class='op'>)</span>,
            Bio05_TWM <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>Bio05_TWM</span><span class='op'>)</span>,
            Bio06_MinTCM <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>Bio06_MinTCM</span><span class='op'>)</span>,
            Bio07_TAR <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>Bio07_TAR</span><span class='op'>)</span>,
            Bio08_MT_WetQ <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>Bio08_MT_WetQ</span><span class='op'>)</span>,
            Bio09_MT_DryQ <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>Bio09_MT_DryQ</span><span class='op'>)</span>,
            Bio10_MT_WarQ <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>Bio10_MT_WarQ</span><span class='op'>)</span>,
            Bio11_MT_ColQ <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>Bio11_MT_ColQ</span><span class='op'>)</span>,
            Bio12_Pecip_Annu <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>Bio12_Pecip_Annu</span><span class='op'>)</span>,
            Bio13_Precip_WetM <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>Bio13_Precip_WetM</span><span class='op'>)</span>,
            Bio14_Precip_DryM <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>Bio14_Precip_DryM</span><span class='op'>)</span>,
            Bio15_Precip_S <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>Bio15_Precip_S</span><span class='op'>)</span>,
            Bio16_Precip_WetQ <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>Bio16_Precip_WetQ</span><span class='op'>)</span>,
            Bio17_Precip_DryQ <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>Bio17_Precip_DryQ</span><span class='op'>)</span>,
            iSDA_Depth_to_bedrock <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>iSDA_Depth_to_bedrock</span><span class='op'>)</span>,
            iSDA_CLAY_conc <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>iSDA_CLAY_conc</span><span class='op'>)</span>,
            iSDA_SILT_conc <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>iSDA_SILT_conc</span><span class='op'>)</span>,
            iSDA_FE_Bulk_dens <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>iSDA_FE_Bulk_dens</span><span class='op'>)</span>,
            iSDA_log_C_tot <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>iSDA_log_C_tot</span><span class='op'>)</span>,
            iSDA_log_Ca <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>iSDA_log_Ca</span><span class='op'>)</span>,
            iSDA_log_eCEC <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>iSDA_log_eCEC</span><span class='op'>)</span>,
            iSDA_log_Fe <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>iSDA_log_Fe</span><span class='op'>)</span>,
            iSDA_log_K <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>iSDA_log_K</span><span class='op'>)</span>,
            iSDA_log_Mg <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>iSDA_log_Mg</span><span class='op'>)</span>,
            iSDA_log_N <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>iSDA_log_N</span><span class='op'>)</span>,
            iSDA_log_SOC <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>iSDA_log_SOC</span><span class='op'>)</span>,
            iSDA_log_P <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>iSDA_log_P</span><span class='op'>)</span>,
            iSDA_log_S <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>iSDA_log_S</span><span class='op'>)</span>,
            iSDA_pH <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>iSDA_pH</span><span class='op'>)</span>,
            ASTER_Altitude <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>ASTER_Altitude</span><span class='op'>)</span>,
            ASTER_Slope <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>ASTER_Slope</span><span class='op'>)</span><span class='op'>)</span>


<span class='co'># SOIL pH  --------------------------------------------------------------------</span>
<span class='va'>new_test_data_iSDA_pH</span> <span class='op'>&lt;-</span> 
  <span class='fu'>expand_grid</span><span class='op'>(</span>iSDA_pH <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>50</span>, <span class='fl'>60</span>, <span class='fl'>70</span>, <span class='fl'>80</span><span class='op'>)</span>, 
            Site.Type <span class='op'>=</span> <span class='st'>"Station"</span>,
            PrName <span class='op'>=</span> <span class='st'>"Agroforestry Pruning"</span>, 
            Out.SubInd <span class='op'>=</span> <span class='st'>"Crop Yield"</span>, 
            Product <span class='op'>=</span> <span class='st'>"Maize"</span>, 
            Tree <span class='op'>=</span> <span class='st'>"Acacia albida"</span>, 
            Out.SubInd.Code <span class='op'>=</span> <span class='st'>"CrY"</span>, 
            Latitude <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>Latitude</span><span class='op'>)</span>,
            Longitude <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>Longitude</span><span class='op'>)</span>,
            Bio01_MT_Annu <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>Bio01_MT_Annu</span><span class='op'>)</span>, 
            Bio02_MDR <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>Bio02_MDR</span><span class='op'>)</span>,
            Bio03_Iso <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>Bio03_Iso</span><span class='op'>)</span>,
            Bio04_TS <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>Bio04_TS</span><span class='op'>)</span>,
            Bio05_TWM <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>Bio05_TWM</span><span class='op'>)</span>,
            Bio06_MinTCM <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>Bio06_MinTCM</span><span class='op'>)</span>,
            Bio07_TAR <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>Bio07_TAR</span><span class='op'>)</span>,
            Bio08_MT_WetQ <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>Bio08_MT_WetQ</span><span class='op'>)</span>,
            Bio09_MT_DryQ <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>Bio09_MT_DryQ</span><span class='op'>)</span>,
            Bio10_MT_WarQ <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>Bio10_MT_WarQ</span><span class='op'>)</span>,
            Bio11_MT_ColQ <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>Bio11_MT_ColQ</span><span class='op'>)</span>,
            Bio12_Pecip_Annu <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>Bio12_Pecip_Annu</span><span class='op'>)</span>,
            Bio13_Precip_WetM <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>Bio13_Precip_WetM</span><span class='op'>)</span>,
            Bio14_Precip_DryM <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>Bio14_Precip_DryM</span><span class='op'>)</span>,
            Bio15_Precip_S <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>Bio15_Precip_S</span><span class='op'>)</span>,
            Bio17_Precip_DryQ <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>Bio17_Precip_DryQ</span><span class='op'>)</span>,
            Bio16_Precip_WetQ <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>Bio16_Precip_WetQ</span><span class='op'>)</span>,
            iSDA_Depth_to_bedrock <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>iSDA_Depth_to_bedrock</span><span class='op'>)</span>,
            iSDA_SAND_conc <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>iSDA_SAND_conc</span><span class='op'>)</span>,
            iSDA_CLAY_conc <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>iSDA_CLAY_conc</span><span class='op'>)</span>,
            iSDA_SILT_conc <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>iSDA_SILT_conc</span><span class='op'>)</span>,
            iSDA_FE_Bulk_dens <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>iSDA_FE_Bulk_dens</span><span class='op'>)</span>,
            iSDA_log_C_tot <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>iSDA_log_C_tot</span><span class='op'>)</span>,
            iSDA_log_Ca <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>iSDA_log_Ca</span><span class='op'>)</span>,
            iSDA_log_eCEC <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>iSDA_log_eCEC</span><span class='op'>)</span>,
            iSDA_log_Fe <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>iSDA_log_Fe</span><span class='op'>)</span>,
            iSDA_log_K <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>iSDA_log_K</span><span class='op'>)</span>,
            iSDA_log_Mg <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>iSDA_log_Mg</span><span class='op'>)</span>,
            iSDA_log_N <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>iSDA_log_N</span><span class='op'>)</span>,
            iSDA_log_SOC <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>iSDA_log_SOC</span><span class='op'>)</span>,
            iSDA_log_P <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>iSDA_log_P</span><span class='op'>)</span>,
            iSDA_log_S <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>iSDA_log_S</span><span class='op'>)</span>,
            ASTER_Altitude <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>ASTER_Altitude</span><span class='op'>)</span>,
            ASTER_Slope <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>ASTER_Slope</span><span class='op'>)</span><span class='op'>)</span>


<span class='co'># PRECIPITATION SESONALITY --------------------------------------------------------------------</span>
<span class='va'>new_test_data_var_Precip_S</span> <span class='op'>&lt;-</span> 
  <span class='fu'>expand_grid</span><span class='op'>(</span>Bio15_Precip_S <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>40</span>, <span class='fl'>50</span>, <span class='fl'>60</span>, <span class='fl'>70</span><span class='op'>)</span>, 
            Site.Type <span class='op'>=</span> <span class='st'>"Station"</span>,
            PrName <span class='op'>=</span> <span class='st'>"Agroforestry Pruning"</span>, 
            Out.SubInd <span class='op'>=</span> <span class='st'>"Crop Yield"</span>, 
            Product <span class='op'>=</span> <span class='st'>"Maize"</span>, 
            Tree <span class='op'>=</span> <span class='st'>"Acacia albida"</span>, 
            Out.SubInd.Code <span class='op'>=</span> <span class='st'>"CrY"</span>, 
            Latitude <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>Latitude</span><span class='op'>)</span>,
            Longitude <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>Longitude</span><span class='op'>)</span>,
            Bio01_MT_Annu <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>Bio01_MT_Annu</span><span class='op'>)</span>, 
            Bio02_MDR <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>Bio02_MDR</span><span class='op'>)</span>,
            Bio03_Iso <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>Bio03_Iso</span><span class='op'>)</span>,
            Bio04_TS <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>Bio04_TS</span><span class='op'>)</span>,
            Bio05_TWM <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>Bio05_TWM</span><span class='op'>)</span>,
            Bio06_MinTCM <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>Bio06_MinTCM</span><span class='op'>)</span>,
            Bio07_TAR <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>Bio07_TAR</span><span class='op'>)</span>,
            Bio08_MT_WetQ <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>Bio08_MT_WetQ</span><span class='op'>)</span>,
            Bio09_MT_DryQ <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>Bio09_MT_DryQ</span><span class='op'>)</span>,
            Bio10_MT_WarQ <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>Bio10_MT_WarQ</span><span class='op'>)</span>,
            Bio11_MT_ColQ <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>Bio11_MT_ColQ</span><span class='op'>)</span>,
            Bio12_Pecip_Annu <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>Bio12_Pecip_Annu</span><span class='op'>)</span>,
            Bio13_Precip_WetM <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>Bio13_Precip_WetM</span><span class='op'>)</span>,
            Bio14_Precip_DryM <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>Bio14_Precip_DryM</span><span class='op'>)</span>,
            Bio17_Precip_DryQ <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>Bio17_Precip_DryQ</span><span class='op'>)</span>,
            Bio16_Precip_WetQ <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>Bio16_Precip_WetQ</span><span class='op'>)</span>,
            iSDA_Depth_to_bedrock <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>iSDA_Depth_to_bedrock</span><span class='op'>)</span>,
            iSDA_SAND_conc <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>iSDA_SAND_conc</span><span class='op'>)</span>,
            iSDA_CLAY_conc <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>iSDA_CLAY_conc</span><span class='op'>)</span>,
            iSDA_SILT_conc <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>iSDA_SILT_conc</span><span class='op'>)</span>,
            iSDA_FE_Bulk_dens <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>iSDA_FE_Bulk_dens</span><span class='op'>)</span>,
            iSDA_log_C_tot <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>iSDA_log_C_tot</span><span class='op'>)</span>,
            iSDA_log_Ca <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>iSDA_log_Ca</span><span class='op'>)</span>,
            iSDA_log_eCEC <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>iSDA_log_eCEC</span><span class='op'>)</span>,
            iSDA_log_Fe <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>iSDA_log_Fe</span><span class='op'>)</span>,
            iSDA_log_K <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>iSDA_log_K</span><span class='op'>)</span>,
            iSDA_log_Mg <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>iSDA_log_Mg</span><span class='op'>)</span>,
            iSDA_log_N <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>iSDA_log_N</span><span class='op'>)</span>,
            iSDA_log_SOC <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>iSDA_log_SOC</span><span class='op'>)</span>,
            iSDA_log_P <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>iSDA_log_P</span><span class='op'>)</span>,
            iSDA_log_S <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>iSDA_log_S</span><span class='op'>)</span>,
            iSDA_pH <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>iSDA_pH</span><span class='op'>)</span>,
            ASTER_Altitude <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>ASTER_Altitude</span><span class='op'>)</span>,
            ASTER_Slope <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>ASTER_Slope</span><span class='op'>)</span><span class='op'>)</span>

<span class='co'># PRECIPITATION DRIEST QUARTER --------------------------------------------------------------------</span>
<span class='va'>new_test_data_var_Precip_DryQ</span> <span class='op'>&lt;-</span> 
  <span class='fu'>expand_grid</span><span class='op'>(</span>Bio17_Precip_DryQ <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>150</span>, <span class='fl'>180</span>, <span class='fl'>200</span>, <span class='fl'>220</span><span class='op'>)</span>, 
            Site.Type <span class='op'>=</span> <span class='st'>"Station"</span>,
            PrName <span class='op'>=</span> <span class='st'>"Agroforestry Pruning"</span>, 
            Out.SubInd <span class='op'>=</span> <span class='st'>"Crop Yield"</span>, 
            Product <span class='op'>=</span> <span class='st'>"Maize"</span>, 
            Tree <span class='op'>=</span> <span class='st'>"Acacia albida"</span>, 
            Out.SubInd.Code <span class='op'>=</span> <span class='st'>"CrY"</span>, 
            Latitude <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>Latitude</span><span class='op'>)</span>,
            Longitude <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>Longitude</span><span class='op'>)</span>,
            Bio01_MT_Annu <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>Bio01_MT_Annu</span><span class='op'>)</span>, 
            Bio02_MDR <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>Bio02_MDR</span><span class='op'>)</span>,
            Bio03_Iso <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>Bio03_Iso</span><span class='op'>)</span>,
            Bio04_TS <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>Bio04_TS</span><span class='op'>)</span>,
            Bio05_TWM <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>Bio05_TWM</span><span class='op'>)</span>,
            Bio06_MinTCM <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>Bio06_MinTCM</span><span class='op'>)</span>,
            Bio07_TAR <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>Bio07_TAR</span><span class='op'>)</span>,
            Bio08_MT_WetQ <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>Bio08_MT_WetQ</span><span class='op'>)</span>,
            Bio09_MT_DryQ <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>Bio09_MT_DryQ</span><span class='op'>)</span>,
            Bio10_MT_WarQ <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>Bio10_MT_WarQ</span><span class='op'>)</span>,
            Bio11_MT_ColQ <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>Bio11_MT_ColQ</span><span class='op'>)</span>,
            Bio12_Pecip_Annu <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>Bio12_Pecip_Annu</span><span class='op'>)</span>,
            Bio13_Precip_WetM <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>Bio13_Precip_WetM</span><span class='op'>)</span>,
            Bio14_Precip_DryM <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>Bio14_Precip_DryM</span><span class='op'>)</span>,
            Bio15_Precip_S <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>Bio15_Precip_S</span><span class='op'>)</span>,
            Bio16_Precip_WetQ <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>Bio16_Precip_WetQ</span><span class='op'>)</span>,
            iSDA_Depth_to_bedrock <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>iSDA_Depth_to_bedrock</span><span class='op'>)</span>,
            iSDA_SAND_conc <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>iSDA_SAND_conc</span><span class='op'>)</span>,
            iSDA_CLAY_conc <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>iSDA_CLAY_conc</span><span class='op'>)</span>,
            iSDA_SILT_conc <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>iSDA_SILT_conc</span><span class='op'>)</span>,
            iSDA_FE_Bulk_dens <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>iSDA_FE_Bulk_dens</span><span class='op'>)</span>,
            iSDA_log_C_tot <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>iSDA_log_C_tot</span><span class='op'>)</span>,
            iSDA_log_Ca <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>iSDA_log_Ca</span><span class='op'>)</span>,
            iSDA_log_eCEC <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>iSDA_log_eCEC</span><span class='op'>)</span>,
            iSDA_log_Fe <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>iSDA_log_Fe</span><span class='op'>)</span>,
            iSDA_log_K <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>iSDA_log_K</span><span class='op'>)</span>,
            iSDA_log_Mg <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>iSDA_log_Mg</span><span class='op'>)</span>,
            iSDA_log_N <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>iSDA_log_N</span><span class='op'>)</span>,
            iSDA_log_SOC <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>iSDA_log_SOC</span><span class='op'>)</span>,
            iSDA_log_P <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>iSDA_log_P</span><span class='op'>)</span>,
            iSDA_log_S <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>iSDA_log_S</span><span class='op'>)</span>,
            iSDA_pH <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>iSDA_pH</span><span class='op'>)</span>,
            ASTER_Altitude <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>ASTER_Altitude</span><span class='op'>)</span>,
            ASTER_Slope <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>ASTER_Slope</span><span class='op'>)</span><span class='op'>)</span>

<span class='co'># TEMPERATURE MEAN DIURNAL RANGE  --------------------------------------------------------------------</span>
<span class='va'>new_test_data_var_MDR</span><span class='op'>&lt;-</span> 
  <span class='fu'>expand_grid</span><span class='op'>(</span>Bio02_MDR <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>12</span>, <span class='fl'>14</span>, <span class='fl'>16</span>, <span class='fl'>18</span><span class='op'>)</span>, 
            Site.Type <span class='op'>=</span> <span class='st'>"Station"</span>,
            PrName <span class='op'>=</span> <span class='st'>"Agroforestry Pruning"</span>, 
            Out.SubInd <span class='op'>=</span> <span class='st'>"Crop Yield"</span>, 
            Product <span class='op'>=</span> <span class='st'>"Maize"</span>, 
            Tree <span class='op'>=</span> <span class='st'>"Acacia albida"</span>, 
            Out.SubInd.Code <span class='op'>=</span> <span class='st'>"CrY"</span>, 
            Latitude <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>Latitude</span><span class='op'>)</span>,
            Longitude <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>Longitude</span><span class='op'>)</span>,
            Bio01_MT_Annu <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>Bio01_MT_Annu</span><span class='op'>)</span>, 
            Bio03_Iso <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>Bio03_Iso</span><span class='op'>)</span>,
            Bio04_TS <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>Bio04_TS</span><span class='op'>)</span>,
            Bio05_TWM <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>Bio05_TWM</span><span class='op'>)</span>,
            Bio06_MinTCM <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>Bio06_MinTCM</span><span class='op'>)</span>,
            Bio07_TAR <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>Bio07_TAR</span><span class='op'>)</span>,
            Bio08_MT_WetQ <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>Bio08_MT_WetQ</span><span class='op'>)</span>,
            Bio09_MT_DryQ <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>Bio09_MT_DryQ</span><span class='op'>)</span>,
            Bio10_MT_WarQ <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>Bio10_MT_WarQ</span><span class='op'>)</span>,
            Bio11_MT_ColQ <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>Bio11_MT_ColQ</span><span class='op'>)</span>,
            Bio12_Pecip_Annu <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>Bio12_Pecip_Annu</span><span class='op'>)</span>,
            Bio13_Precip_WetM <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>Bio13_Precip_WetM</span><span class='op'>)</span>,
            Bio14_Precip_DryM <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>Bio14_Precip_DryM</span><span class='op'>)</span>,
            Bio15_Precip_S <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>Bio15_Precip_S</span><span class='op'>)</span>,
            Bio17_Precip_DryQ <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>Bio17_Precip_DryQ</span><span class='op'>)</span>,
            Bio16_Precip_WetQ <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>Bio16_Precip_WetQ</span><span class='op'>)</span>,
            iSDA_Depth_to_bedrock <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>iSDA_Depth_to_bedrock</span><span class='op'>)</span>,
            iSDA_SAND_conc <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>iSDA_SAND_conc</span><span class='op'>)</span>,
            iSDA_CLAY_conc <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>iSDA_CLAY_conc</span><span class='op'>)</span>,
            iSDA_SILT_conc <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>iSDA_SILT_conc</span><span class='op'>)</span>,
            iSDA_FE_Bulk_dens <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>iSDA_FE_Bulk_dens</span><span class='op'>)</span>,
            iSDA_log_C_tot <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>iSDA_log_C_tot</span><span class='op'>)</span>,
            iSDA_log_Ca <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>iSDA_log_Ca</span><span class='op'>)</span>,
            iSDA_log_eCEC <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>iSDA_log_eCEC</span><span class='op'>)</span>,
            iSDA_log_Fe <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>iSDA_log_Fe</span><span class='op'>)</span>,
            iSDA_log_K <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>iSDA_log_K</span><span class='op'>)</span>,
            iSDA_log_Mg <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>iSDA_log_Mg</span><span class='op'>)</span>,
            iSDA_log_N <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>iSDA_log_N</span><span class='op'>)</span>,
            iSDA_log_SOC <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>iSDA_log_SOC</span><span class='op'>)</span>,
            iSDA_log_P <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>iSDA_log_P</span><span class='op'>)</span>,
            iSDA_log_S <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>iSDA_log_S</span><span class='op'>)</span>,
            iSDA_pH <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>iSDA_pH</span><span class='op'>)</span>,
            ASTER_Altitude <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>ASTER_Altitude</span><span class='op'>)</span>,
            ASTER_Slope <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>ASTER_Slope</span><span class='op'>)</span><span class='op'>)</span>


<span class='co'># TEMPERATURE OF WETTEST MONTH --------------------------------------------------------------------</span>
<span class='va'>new_test_data_var_TWM</span> <span class='op'>&lt;-</span> 
  <span class='fu'>expand_grid</span><span class='op'>(</span>Bio05_TWM <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>20</span>, <span class='fl'>25</span>, <span class='fl'>30</span>, <span class='fl'>35</span><span class='op'>)</span>, 
            Site.Type <span class='op'>=</span> <span class='st'>"Station"</span>,
            PrName <span class='op'>=</span> <span class='st'>"Agroforestry Pruning"</span>, 
            Out.SubInd <span class='op'>=</span> <span class='st'>"Crop Yield"</span>, 
            Product <span class='op'>=</span> <span class='st'>"Maize"</span>, 
            Tree <span class='op'>=</span> <span class='st'>"Acacia albida"</span>, 
            Out.SubInd.Code <span class='op'>=</span> <span class='st'>"CrY"</span>, 
            Latitude <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>Latitude</span><span class='op'>)</span>,
            Longitude <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>Longitude</span><span class='op'>)</span>,
            Bio01_MT_Annu <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>Bio01_MT_Annu</span><span class='op'>)</span>, 
            Bio02_MDR <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>Bio02_MDR</span><span class='op'>)</span>,
            Bio03_Iso <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>Bio03_Iso</span><span class='op'>)</span>,
            Bio04_TS <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>Bio04_TS</span><span class='op'>)</span>,
            Bio06_MinTCM <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>Bio06_MinTCM</span><span class='op'>)</span>,
            Bio07_TAR <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>Bio07_TAR</span><span class='op'>)</span>,
            Bio08_MT_WetQ <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>Bio08_MT_WetQ</span><span class='op'>)</span>,
            Bio09_MT_DryQ <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>Bio09_MT_DryQ</span><span class='op'>)</span>,
            Bio10_MT_WarQ <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>Bio10_MT_WarQ</span><span class='op'>)</span>,
            Bio11_MT_ColQ <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>Bio11_MT_ColQ</span><span class='op'>)</span>,
            Bio12_Pecip_Annu <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>Bio12_Pecip_Annu</span><span class='op'>)</span>,
            Bio13_Precip_WetM <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>Bio13_Precip_WetM</span><span class='op'>)</span>,
            Bio14_Precip_DryM <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>Bio14_Precip_DryM</span><span class='op'>)</span>,
            Bio15_Precip_S <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>Bio15_Precip_S</span><span class='op'>)</span>,
            Bio17_Precip_DryQ <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>Bio17_Precip_DryQ</span><span class='op'>)</span>,
            Bio16_Precip_WetQ <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>Bio16_Precip_WetQ</span><span class='op'>)</span>,
            iSDA_Depth_to_bedrock <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>iSDA_Depth_to_bedrock</span><span class='op'>)</span>,
            iSDA_SAND_conc <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>iSDA_SAND_conc</span><span class='op'>)</span>,
            iSDA_CLAY_conc <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>iSDA_CLAY_conc</span><span class='op'>)</span>,
            iSDA_SILT_conc <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>iSDA_SILT_conc</span><span class='op'>)</span>,
            iSDA_FE_Bulk_dens <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>iSDA_FE_Bulk_dens</span><span class='op'>)</span>,
            iSDA_log_C_tot <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>iSDA_log_C_tot</span><span class='op'>)</span>,
            iSDA_log_Ca <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>iSDA_log_Ca</span><span class='op'>)</span>,
            iSDA_log_eCEC <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>iSDA_log_eCEC</span><span class='op'>)</span>,
            iSDA_log_Fe <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>iSDA_log_Fe</span><span class='op'>)</span>,
            iSDA_log_K <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>iSDA_log_K</span><span class='op'>)</span>,
            iSDA_log_Mg <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>iSDA_log_Mg</span><span class='op'>)</span>,
            iSDA_log_N <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>iSDA_log_N</span><span class='op'>)</span>,
            iSDA_log_SOC <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>iSDA_log_SOC</span><span class='op'>)</span>,
            iSDA_log_P <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>iSDA_log_P</span><span class='op'>)</span>,
            iSDA_log_S <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>iSDA_log_S</span><span class='op'>)</span>,
            iSDA_pH <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>iSDA_pH</span><span class='op'>)</span>,
            ASTER_Altitude <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>ASTER_Altitude</span><span class='op'>)</span>,
            ASTER_Slope <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>old_data</span><span class='op'>$</span><span class='va'>ASTER_Slope</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
</details>
</div>
<h3 id="predicting-with-the-random-forest-model-on-the-new-data">Predicting with the Random Forest model on the new data</h3>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>pred_new_data_CLAY</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/predict.html'>predict</a></span><span class='op'>(</span><span class='va'>rf_best_race_trained_wf</span>,
                      new_data <span class='op'>=</span> <span class='va'>new_test_data_var_CLAY</span><span class='op'>)</span>

<span class='va'>pred_new_data_SAND</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/predict.html'>predict</a></span><span class='op'>(</span><span class='va'>rf_best_race_trained_wf</span>,
                      new_data <span class='op'>=</span> <span class='va'>new_test_data_var_SAND</span><span class='op'>)</span>

<span class='va'>pred_new_data_pH</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/predict.html'>predict</a></span><span class='op'>(</span><span class='va'>rf_best_race_trained_wf</span>,
                      new_data <span class='op'>=</span> <span class='va'>new_test_data_iSDA_pH</span><span class='op'>)</span>

<span class='va'>pred_new_data_Precip_S</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/predict.html'>predict</a></span><span class='op'>(</span><span class='va'>rf_best_race_trained_wf</span>,
                      new_data <span class='op'>=</span> <span class='va'>new_test_data_var_Precip_S</span><span class='op'>)</span>

<span class='va'>pred_new_data_Precip_DryQ</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/predict.html'>predict</a></span><span class='op'>(</span><span class='va'>rf_best_race_trained_wf</span>,
                      new_data <span class='op'>=</span> <span class='va'>new_test_data_var_Precip_DryQ</span><span class='op'>)</span>

<span class='va'>pred_new_data_MDR</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/predict.html'>predict</a></span><span class='op'>(</span><span class='va'>rf_best_race_trained_wf</span>,
                      new_data <span class='op'>=</span> <span class='va'>new_test_data_var_MDR</span><span class='op'>)</span>

<span class='va'>pred_new_data_TWM</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/predict.html'>predict</a></span><span class='op'>(</span><span class='va'>rf_best_race_trained_wf</span>,
                      new_data <span class='op'>=</span> <span class='va'>new_test_data_var_TWM</span><span class='op'>)</span>

<span class='co'># We get a few warnings we can ignore</span>
<span class='co'># Warning: Novel levels found in column 'Tree': 'Acacia albidam'. The levels have been removed, and values have been coerced to 'NA'.</span>
<span class='co'># Warning: Novel levels found in column 'Tree': 'Acacia albidam'. The levels have been removed, and values have been coerced to 'NA'.</span>
</code></pre>
</div>
</div>
<h3 id="creating-the-dataset-of-predicted-response-ratio-values-for-each-of-the-predictors">Creating the dataset of predicted response ratio values for each of the predictors</h3>
<p>These dataframes/tibbles will be used to generate ggplots of marginal effects for each of the variables.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>pred_new_data_CLAY</span> <span class='op'>&lt;-</span> <span class='fu'>tibble</span><span class='op'>(</span>iSDA_CLAY_conc <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>10</span>, <span class='fl'>20</span>, <span class='fl'>30</span>, <span class='fl'>40</span><span class='op'>)</span>,
                          .pred <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.5355357</span>, <span class='fl'>0.5281725</span>, <span class='fl'>0.4982191</span>, <span class='fl'>0.5128507</span><span class='op'>)</span><span class='op'>)</span>

<span class='va'>pred_new_data_SAND</span> <span class='op'>&lt;-</span> <span class='fu'>tibble</span><span class='op'>(</span>iSDA_SAND_conc <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>50</span>, <span class='fl'>60</span>, <span class='fl'>70</span>, <span class='fl'>80</span><span class='op'>)</span>,
                          .pred <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.4994193</span>, <span class='fl'>0.4955434</span>, <span class='fl'>0.5159416</span>, <span class='fl'>0.5159416</span><span class='op'>)</span><span class='op'>)</span>

<span class='va'>pred_new_data_pH</span> <span class='op'>&lt;-</span> <span class='fu'>tibble</span><span class='op'>(</span>iSDA_pH <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>50</span>, <span class='fl'>60</span>, <span class='fl'>70</span>, <span class='fl'>80</span><span class='op'>)</span>,
                          .pred <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.5760564</span>  , <span class='fl'>0.4931747</span>, <span class='fl'>0.4762354</span>, <span class='fl'>0.4695003</span><span class='op'>)</span><span class='op'>)</span>

<span class='va'>pred_new_data_Precip_S</span> <span class='op'>&lt;-</span> <span class='fu'>tibble</span><span class='op'>(</span>Bio15_Precip_S <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>40</span>, <span class='fl'>50</span>, <span class='fl'>60</span>, <span class='fl'>70</span><span class='op'>)</span>,
                          .pred <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.5320894</span>  , <span class='fl'>0.5322152</span>, <span class='fl'>0.5507409</span>, <span class='fl'>0.4489401</span><span class='op'>)</span><span class='op'>)</span>

<span class='va'>pred_new_data_Precip_DryQ</span> <span class='op'>&lt;-</span> <span class='fu'>tibble</span><span class='op'>(</span>Bio17_Precip_DryQ <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>150</span>, <span class='fl'>180</span>, <span class='fl'>200</span>, <span class='fl'>220</span><span class='op'>)</span>,
                          .pred <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.5352552</span>  , <span class='fl'>0.5333205</span>, <span class='fl'>0.5294350</span>, <span class='fl'>0.5294350</span><span class='op'>)</span><span class='op'>)</span>

<span class='va'>pred_new_data_MDR</span> <span class='op'>&lt;-</span> <span class='fu'>tibble</span><span class='op'>(</span>Bio02_MDR <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>12</span>, <span class='fl'>14</span>, <span class='fl'>16</span>, <span class='fl'>18</span><span class='op'>)</span>,
                          .pred <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.4648982</span>  , <span class='fl'>0.4637734</span>, <span class='fl'>0.4791219</span>, <span class='fl'>0.4791219</span><span class='op'>)</span><span class='op'>)</span>

<span class='va'>pred_new_data_TWM</span> <span class='op'>&lt;-</span> <span class='fu'>tibble</span><span class='op'>(</span>Bio05_TWM <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>20</span>, <span class='fl'>25</span>, <span class='fl'>30</span>, <span class='fl'>35</span><span class='op'>)</span>,
                          .pred <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.4372342</span>  , <span class='fl'>0.4372342</span>, <span class='fl'>0.4981338</span>, <span class='fl'>0.3629274</span><span class='op'>)</span><span class='op'>)</span>


<span class='co'># SAVING THE PREDICTED DATASETS FOR EACH OF THE PREDICTOR FEATURES</span>

<span class='fu'><a href='https://rdrr.io/r/base/readRDS.html'>saveRDS</a></span><span class='op'>(</span><span class='va'>pred_new_data_CLAY</span>, <span class='fu'>here</span><span class='fu'>::</span><span class='fu'><a href='https://here.r-lib.org//reference/here.html'>here</a></span><span class='op'>(</span><span class='st'>"TidyModWflSet_OUTPUT"</span>,<span class='st'>"pred_new_data_CLAY.RDS"</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/readRDS.html'>saveRDS</a></span><span class='op'>(</span><span class='va'>pred_new_data_SAND</span>, <span class='fu'>here</span><span class='fu'>::</span><span class='fu'><a href='https://here.r-lib.org//reference/here.html'>here</a></span><span class='op'>(</span><span class='st'>"TidyModWflSet_OUTPUT"</span>,<span class='st'>"pred_new_data_SAND.RDS"</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/readRDS.html'>saveRDS</a></span><span class='op'>(</span><span class='va'>pred_new_data_pH</span>, <span class='fu'>here</span><span class='fu'>::</span><span class='fu'><a href='https://here.r-lib.org//reference/here.html'>here</a></span><span class='op'>(</span><span class='st'>"TidyModWflSet_OUTPUT"</span>,<span class='st'>"pred_new_data_pH.RDS"</span><span class='op'>)</span><span class='op'>)</span>

<span class='fu'><a href='https://rdrr.io/r/base/readRDS.html'>saveRDS</a></span><span class='op'>(</span><span class='va'>pred_new_data_Precip_S</span>, <span class='fu'>here</span><span class='fu'>::</span><span class='fu'><a href='https://here.r-lib.org//reference/here.html'>here</a></span><span class='op'>(</span><span class='st'>"TidyModWflSet_OUTPUT"</span>,<span class='st'>"pred_new_data_Precip_S.RDS"</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/readRDS.html'>saveRDS</a></span><span class='op'>(</span><span class='va'>pred_new_data_Precip_DryQ</span>, <span class='fu'>here</span><span class='fu'>::</span><span class='fu'><a href='https://here.r-lib.org//reference/here.html'>here</a></span><span class='op'>(</span><span class='st'>"TidyModWflSet_OUTPUT"</span>,<span class='st'>"pred_new_data_Precip_DryQ.RDS"</span><span class='op'>)</span><span class='op'>)</span>

<span class='fu'><a href='https://rdrr.io/r/base/readRDS.html'>saveRDS</a></span><span class='op'>(</span><span class='va'>pred_new_data_MDR</span>, <span class='fu'>here</span><span class='fu'>::</span><span class='fu'><a href='https://here.r-lib.org//reference/here.html'>here</a></span><span class='op'>(</span><span class='st'>"TidyModWflSet_OUTPUT"</span>,<span class='st'>"pred_new_data_MDR.RDS"</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/readRDS.html'>saveRDS</a></span><span class='op'>(</span><span class='va'>pred_new_data_TWM</span>, <span class='fu'>here</span><span class='fu'>::</span><span class='fu'><a href='https://here.r-lib.org//reference/here.html'>here</a></span><span class='op'>(</span><span class='st'>"TidyModWflSet_OUTPUT"</span>,<span class='st'>"pred_new_data_TWM.RDS"</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
</details>
</div>
<strong>CLAY: Marginal effects plot for the RF model</strong>
<div class="layout-chunk" data-layout="l-screen-inset shaded">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>pred_new_data_CLAY</span> <span class='op'>&lt;-</span> <span class='va'>cpp_newObs_1_rf</span> <span class='op'>&lt;-</span>  <span class='fu'><a href='https://rdrr.io/r/base/readRDS.html'>readRDS</a></span><span class='op'>(</span><span class='fu'>here</span><span class='fu'>::</span><span class='fu'><a href='https://here.r-lib.org//reference/here.html'>here</a></span><span class='op'>(</span><span class='st'>"TidyModWflSet_OUTPUT"</span>,<span class='st'>"pred_new_data_CLAY.RDS"</span><span class='op'>)</span><span class='op'>)</span>


<span class='fu'>ggplot</span><span class='op'>(</span><span class='va'>pred_new_data_CLAY</span>, <span class='fu'>aes</span><span class='op'>(</span>x <span class='op'>=</span><span class='va'>iSDA_CLAY_conc</span>, y <span class='op'>=</span> <span class='va'>.pred</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>geom_line</span><span class='op'>(</span>alpha <span class='op'>=</span> <span class='fl'>.5</span>, lty <span class='op'>=</span> <span class='fl'>2</span>, size <span class='op'>=</span> <span class='fl'>2</span>, col <span class='op'>=</span> <span class='st'>"darkorange"</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>geom_point</span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>4</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>theme_bw</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>ggtitle</span><span class='op'>(</span><span class='st'>"CLAY: Marginal effect plot"</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>ylab</span><span class='op'>(</span><span class='st'>"Predicted response ratio"</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>xlab</span><span class='op'>(</span><span class='st'>"Clay content"</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-38"></span>
<img src="TIDYMODELSWFS_files/figure-html5/unnamed-chunk-38-1.png" alt="Marginal effects plot for clay content based on the RF model" width="768" />
<p class="caption">
Figure 38: Marginal effects plot for clay content based on the RF model
</p>
</div>
</div>
<strong>SAND: Marginal effects plot for the RF model</strong>
<div class="layout-chunk" data-layout="l-screen-inset shaded">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>pred_new_data_SAND</span> <span class='op'>&lt;-</span> <span class='va'>cpp_newObs_1_rf</span> <span class='op'>&lt;-</span>  <span class='fu'><a href='https://rdrr.io/r/base/readRDS.html'>readRDS</a></span><span class='op'>(</span><span class='fu'>here</span><span class='fu'>::</span><span class='fu'><a href='https://here.r-lib.org//reference/here.html'>here</a></span><span class='op'>(</span><span class='st'>"TidyModWflSet_OUTPUT"</span>,<span class='st'>"pred_new_data_SAND.RDS"</span><span class='op'>)</span><span class='op'>)</span>

<span class='fu'>ggplot</span><span class='op'>(</span><span class='va'>pred_new_data_SAND</span>, <span class='fu'>aes</span><span class='op'>(</span>x <span class='op'>=</span><span class='va'>iSDA_SAND_conc</span>, y <span class='op'>=</span> <span class='va'>.pred</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>geom_line</span><span class='op'>(</span>alpha <span class='op'>=</span> <span class='fl'>.5</span>, lty <span class='op'>=</span> <span class='fl'>2</span>, size <span class='op'>=</span> <span class='fl'>2</span>, col <span class='op'>=</span> <span class='st'>"darkorange"</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>geom_point</span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>4</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>theme_bw</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>ggtitle</span><span class='op'>(</span><span class='st'>"SAND: Marginal effect plot"</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>ylab</span><span class='op'>(</span><span class='st'>"Predicted response ratio"</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>xlab</span><span class='op'>(</span><span class='st'>"Sand content"</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-39"></span>
<img src="TIDYMODELSWFS_files/figure-html5/unnamed-chunk-39-1.png" alt="Marginal effects plot for sand content based on the RF model" width="768" />
<p class="caption">
Figure 39: Marginal effects plot for sand content based on the RF model
</p>
</div>
</div>
<strong>pH: Marginal effects plot for the RF model</strong>
<div class="layout-chunk" data-layout="l-screen-inset shaded">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>pred_new_data_pH</span> <span class='op'>&lt;-</span> <span class='va'>cpp_newObs_1_rf</span> <span class='op'>&lt;-</span>  <span class='fu'><a href='https://rdrr.io/r/base/readRDS.html'>readRDS</a></span><span class='op'>(</span><span class='fu'>here</span><span class='fu'>::</span><span class='fu'><a href='https://here.r-lib.org//reference/here.html'>here</a></span><span class='op'>(</span><span class='st'>"TidyModWflSet_OUTPUT"</span>,<span class='st'>"pred_new_data_pH.RDS"</span><span class='op'>)</span><span class='op'>)</span>

<span class='fu'>ggplot</span><span class='op'>(</span><span class='va'>pred_new_data_pH</span>, <span class='fu'>aes</span><span class='op'>(</span>x <span class='op'>=</span><span class='va'>iSDA_pH</span>, y <span class='op'>=</span> <span class='va'>.pred</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>geom_line</span><span class='op'>(</span>alpha <span class='op'>=</span> <span class='fl'>.5</span>, lty <span class='op'>=</span> <span class='fl'>2</span>, size <span class='op'>=</span> <span class='fl'>2</span>, col <span class='op'>=</span> <span class='st'>"darkorange"</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>geom_point</span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>4</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>theme_bw</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>ggtitle</span><span class='op'>(</span><span class='st'>"Soil pH: Marginal effect plot"</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>ylab</span><span class='op'>(</span><span class='st'>"Predicted response ratio"</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>xlab</span><span class='op'>(</span><span class='st'>"pH"</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-40"></span>
<img src="TIDYMODELSWFS_files/figure-html5/unnamed-chunk-40-1.png" alt="Marginal effects plot for pH based on the RF model" width="768" />
<p class="caption">
Figure 40: Marginal effects plot for pH based on the RF model
</p>
</div>
</div>
<strong>PRECIPITATION SEASONALITY: Marginal effects plot for the RF model</strong>
<div class="layout-chunk" data-layout="l-screen-inset shaded">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>pred_new_data_Precip_S</span> <span class='op'>&lt;-</span> <span class='va'>cpp_newObs_1_rf</span> <span class='op'>&lt;-</span>  <span class='fu'><a href='https://rdrr.io/r/base/readRDS.html'>readRDS</a></span><span class='op'>(</span><span class='fu'>here</span><span class='fu'>::</span><span class='fu'><a href='https://here.r-lib.org//reference/here.html'>here</a></span><span class='op'>(</span><span class='st'>"TidyModWflSet_OUTPUT"</span>,<span class='st'>"pred_new_data_Precip_S.RDS"</span><span class='op'>)</span><span class='op'>)</span>

<span class='fu'>ggplot</span><span class='op'>(</span><span class='va'>pred_new_data_Precip_S</span>, <span class='fu'>aes</span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>Bio15_Precip_S</span>, y <span class='op'>=</span> <span class='va'>.pred</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>geom_line</span><span class='op'>(</span>alpha <span class='op'>=</span> <span class='fl'>.5</span>, lty <span class='op'>=</span> <span class='fl'>2</span>, size <span class='op'>=</span> <span class='fl'>2</span>, col <span class='op'>=</span> <span class='st'>"midnightblue"</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>geom_point</span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>4</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>theme_bw</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>ggtitle</span><span class='op'>(</span><span class='st'>"Precipitation (Seasonal): Marginal effect plot"</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>ylab</span><span class='op'>(</span><span class='st'>"Predicted response ratio"</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>xlab</span><span class='op'>(</span><span class='st'>"Precipitation (Seasonal)"</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-41"></span>
<img src="TIDYMODELSWFS_files/figure-html5/unnamed-chunk-41-1.png" alt="Marginal effects plot for precipitation seasonality based on the RF model" width="768" />
<p class="caption">
Figure 41: Marginal effects plot for precipitation seasonality based on the RF model
</p>
</div>
</div>
<strong>PRECIPITATION OF DRIEST QUATER: Marginal effects plot for the RF model</strong>
<div class="layout-chunk" data-layout="l-screen-inset shaded">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>pred_new_data_Precip_DryQ</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/readRDS.html'>readRDS</a></span><span class='op'>(</span><span class='fu'>here</span><span class='fu'>::</span><span class='fu'><a href='https://here.r-lib.org//reference/here.html'>here</a></span><span class='op'>(</span><span class='st'>"TidyModWflSet_OUTPUT"</span>,<span class='st'>"pred_new_data_Precip_DryQ.RDS"</span><span class='op'>)</span><span class='op'>)</span>

<span class='fu'>ggplot</span><span class='op'>(</span><span class='va'>pred_new_data_Precip_DryQ</span>, <span class='fu'>aes</span><span class='op'>(</span>x <span class='op'>=</span><span class='va'>Bio17_Precip_DryQ</span>, y <span class='op'>=</span> <span class='va'>.pred</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>geom_line</span><span class='op'>(</span>alpha <span class='op'>=</span> <span class='fl'>.5</span>, lty <span class='op'>=</span> <span class='fl'>2</span>, size <span class='op'>=</span> <span class='fl'>2</span>, col <span class='op'>=</span> <span class='st'>"midnightblue"</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>geom_point</span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>4</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>theme_bw</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>ggtitle</span><span class='op'>(</span><span class='st'>"Precipitation (Driest Quarter): Marginal effect plot"</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>ylab</span><span class='op'>(</span><span class='st'>"Predicted response ratio"</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>xlab</span><span class='op'>(</span><span class='st'>"Precipitation (Driest Quarter)"</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-42"></span>
<img src="TIDYMODELSWFS_files/figure-html5/unnamed-chunk-42-1.png" alt="Marginal effects plot for precipitation of driest quarter based on the RF model" width="768" />
<p class="caption">
Figure 42: Marginal effects plot for precipitation of driest quarter based on the RF model
</p>
</div>
</div>
<strong>TEMPERATURE MEAN DIURNAL RANGE: Marginal effects plot for the RF model</strong>
<div class="layout-chunk" data-layout="l-screen-inset shaded">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>pred_new_data_MDR</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/readRDS.html'>readRDS</a></span><span class='op'>(</span><span class='fu'>here</span><span class='fu'>::</span><span class='fu'><a href='https://here.r-lib.org//reference/here.html'>here</a></span><span class='op'>(</span><span class='st'>"TidyModWflSet_OUTPUT"</span>,<span class='st'>"pred_new_data_MDR.RDS"</span><span class='op'>)</span><span class='op'>)</span>

<span class='fu'>ggplot</span><span class='op'>(</span><span class='va'>pred_new_data_MDR</span>, <span class='fu'>aes</span><span class='op'>(</span>x <span class='op'>=</span><span class='va'>Bio02_MDR</span>, y <span class='op'>=</span> <span class='va'>.pred</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>geom_line</span><span class='op'>(</span>alpha <span class='op'>=</span> <span class='fl'>.5</span>, lty <span class='op'>=</span> <span class='fl'>2</span>, size <span class='op'>=</span> <span class='fl'>2</span>, col <span class='op'>=</span> <span class='st'>"darkgreen"</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>geom_point</span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>4</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>theme_bw</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>ggtitle</span><span class='op'>(</span><span class='st'>"Temperature (Mean Diurnal Range): Marginal effect plot"</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>ylab</span><span class='op'>(</span><span class='st'>"Predicted response ratio"</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>xlab</span><span class='op'>(</span><span class='st'>"Temperature (Mean Diurnal Range)"</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-43"></span>
<img src="TIDYMODELSWFS_files/figure-html5/unnamed-chunk-43-1.png" alt="Marginal effects plot for temperature mean diurnal range based on the RF model" width="768" />
<p class="caption">
Figure 43: Marginal effects plot for temperature mean diurnal range based on the RF model
</p>
</div>
</div>
<strong>TEMPERATURE OF WARMEST MONTH: Marginal effects plot for the RF model</strong>
<div class="layout-chunk" data-layout="l-screen-inset shaded">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>pred_new_data_TWM</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/readRDS.html'>readRDS</a></span><span class='op'>(</span><span class='fu'>here</span><span class='fu'>::</span><span class='fu'><a href='https://here.r-lib.org//reference/here.html'>here</a></span><span class='op'>(</span><span class='st'>"TidyModWflSet_OUTPUT"</span>,<span class='st'>"pred_new_data_TWM.RDS"</span><span class='op'>)</span><span class='op'>)</span>


<span class='fu'>ggplot</span><span class='op'>(</span><span class='va'>pred_new_data_TWM</span>, <span class='fu'>aes</span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>Bio05_TWM</span>, y <span class='op'>=</span> <span class='va'>.pred</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>geom_line</span><span class='op'>(</span>alpha <span class='op'>=</span> <span class='fl'>.5</span>, lty <span class='op'>=</span> <span class='fl'>2</span>, size <span class='op'>=</span> <span class='fl'>2</span>, col <span class='op'>=</span> <span class='st'>"darkgreen"</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>geom_point</span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>4</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>theme_bw</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>ggtitle</span><span class='op'>(</span><span class='st'>"Temperature (Max of Warmest Month): Marginal effect plot"</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>ylab</span><span class='op'>(</span><span class='st'>"Predicted response ratio"</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>xlab</span><span class='op'>(</span><span class='st'>"Temperature (Max of Warmest Month)"</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-44"></span>
<img src="TIDYMODELSWFS_files/figure-html5/unnamed-chunk-44-1.png" alt="Marginal effects plot for temperature of warmest month based on the RF model" width="768" />
<p class="caption">
Figure 44: Marginal effects plot for temperature of warmest month based on the RF model
</p>
</div>
</div>
<div class="sourceCode" id="cb5"><pre class="sourceCode r distill-force-highlighting-css"><code class="sourceCode r"></code></pre></div>
<!--radix_placeholder_article_footer-->
<!--/radix_placeholder_article_footer-->
</div>

<div class="d-appendix">
</div>


<!--radix_placeholder_site_after_body-->
<!--/radix_placeholder_site_after_body-->
<!--radix_placeholder_appendices-->
<div class="appendix-bottom">
<h3 id="references">References</h3>
<div id="references-listing"></div>
</div>
<!--/radix_placeholder_appendices-->
<!--radix_placeholder_navigation_after_body-->
<!--/radix_placeholder_navigation_after_body-->

</body>

</html>
